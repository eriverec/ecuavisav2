import{M as A,r as d,v as F,as as M,o as p,c as $,w as l,a as t,aR as K,b as c,c7 as q,h as D,ao as G,V as L,e as S,l as O,m as P,n as H,b1 as J,p as x,u as Q,q as v,x as m,F as W,C as X,N as U,t as y,ap as Y,f as Z,g as ee,bb as E,bd as ae,be as te}from"./index.88d3c7f5.js";const le=f=>(ae("data-v-c7294d8c"),f=f(),te(),f),se={class:"d-flex justify-space-between align-center"},oe=le(()=>c("div",null,[c("div",{class:"text-h6 pb-1"},"Activa publicidad en ecuavisa.com"),c("div",{class:"text-caption text-grey-darken-1"}," En todo el sitio o administra las URLs donde aparecer\xE1 la publicidad. ")],-1)),re={class:"d-flex align-items-center gap-2"},ie={key:0,class:"mt-4"},ce={class:"d-flex align-center gap-2 text-truncate"},ne={class:"text-body-1 text-truncate pe-2"},de={class:"d-flex align-center gap-2"},ue={key:1,class:"text-center text-grey-darken-1 pa-4"},pe={__name:"index",setup(f){const w="https://estadisticas.ecuavisa.com/sites/gestor/Tools/publicidadBO",r=d([]),u=d(""),a=d(!1),b=d(!1),V=d(""),k=d("success"),_=d(null),n=d(!1),T=e=>{try{return new URL(e),!0}catch{return"URL inv\xE1lida"}},R=F(()=>{try{return new URL(u.value),!0}catch{return!1}}),i=(e,s="success")=>{V.value=e,k.value=s==="delete"?"warning":s==="copy"?"info":"success",b.value=!0},B=async e=>{try{await navigator.clipboard.writeText(e),_.value=e,i("URL copiada al portapapeles","copy"),setTimeout(()=>{_.value===e&&(_.value=null)},2e3)}catch{i("Error al copiar URL","error")}},N=async()=>{a.value=!0;try{const e=await E.get(`${w}/config_publicidad.php`,{params:{api:"web",key:"publicidad_urls"}});e.data&&(r.value=e.data.data||[],n.value=e.data.adsglobal==="true")}catch(e){console.error("Error al cargar URLs:",e),i("Error al cargar los datos","error")}finally{a.value=!1}},g=async()=>{const e={key:"publicidad_urls",estructura:{adsglobal:n.value.toString(),data:r.value}};return(await E({method:"post",url:`${w}/config_publicidad.php`,params:{api:"update"},data:e,headers:{"Content-Type":"application/json"}})).data},I=async()=>{a.value=!0;try{await g(),i(n.value?"Publicidad activada en todo el sitio":"Publicidad desactivada globalmente","success")}catch{n.value=!n.value,i("Error al actualizar el estado global","error")}finally{a.value=!1}},h=async()=>{if(!(!R.value||a.value)){a.value=!0;try{const e={https:u.value};r.value.push(e),await g(),u.value="",i("URL agregada con \xE9xito","success")}catch{r.value.pop(),i("Error al agregar URL","error")}finally{a.value=!1}}},j=async e=>{if(a.value)return;a.value=!0;const s=r.value[e];try{r.value.splice(e,1),await g(),i("URL eliminada correctamente","delete")}catch{r.value.splice(e,0,s),i("Error al eliminar URL","error")}finally{a.value=!1}};return M(()=>{N()}),(e,s)=>(p(),$(ee,null,{default:l(()=>[t(K,{class:"pa-4"},{default:l(()=>[c("div",se,[oe,t(q,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=o=>n.value=o),color:"primary",label:"Activar en todo el sitio","hide-details":"",onChange:I,loading:a.value},null,8,["modelValue","loading"])])]),_:1}),t(D,null,{default:l(()=>[G(c("div",null,[t(L,null,{default:l(()=>[t(S,{cols:"12"},{default:l(()=>[t(O,{onSubmit:P(h,["prevent"])},{default:l(()=>[c("div",re,[t(H,{modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=o=>u.value=o),placeholder:"https://...",rules:[o=>!!o||"URL es requerida",T],onKeyup:J(h,["enter"]),disabled:a.value,variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","rules","onKeyup","disabled"]),t(x,{color:"primary",onClick:h,disabled:!Q(R)||a.value,loading:a.value},{default:l(()=>[v(" Agregar ")]),_:1},8,["disabled","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),t(L,null,{default:l(()=>[t(S,{cols:"12"},{default:l(()=>[r.value.length>0?(p(),m("div",ie,[(p(!0),m(W,null,X(r.value,(o,C)=>(p(),m("div",{key:C,class:"url-item d-flex justify-space-between align-center py-3"},[c("div",ce,[t(U,{size:"small",color:"primary"},{default:l(()=>[v(" mdi-link-variant ")]),_:1}),c("span",ne,y(o.https),1)]),c("div",de,[t(x,{icon:"",color:"primary",variant:"text",onClick:z=>B(o.https),disabled:a.value,class:"copy-btn"},{default:l(()=>[t(U,{size:"small"},{default:l(()=>[v(y(_.value===o.https?"mdi-check":"mdi-content-copy"),1)]),_:2},1024)]),_:2},1032,["onClick","disabled"]),t(x,{icon:"",color:"error",variant:"text",onClick:z=>j(C),disabled:a.value,class:"delete-btn"},{default:l(()=>[t(U,{size:"small"},{default:l(()=>[v("mdi-delete")]),_:1})]),_:2},1032,["onClick","disabled"])])]))),128))])):(p(),m("div",ue,y(a.value?"Cargando URLs...":"No hay URLs registradas"),1))]),_:1})]),_:1})],512),[[Y,!n.value]])]),_:1}),t(Z,{modelValue:b.value,"onUpdate:modelValue":s[2]||(s[2]=o=>b.value=o),color:k.value,timeout:3e3,location:"top right",class:"text-center"},{default:l(()=>[v(y(V.value),1)]),_:1},8,["modelValue","color"])]),_:1}))}},fe=A(pe,[["__scopeId","data-v-c7294d8c"]]);export{fe as default};
