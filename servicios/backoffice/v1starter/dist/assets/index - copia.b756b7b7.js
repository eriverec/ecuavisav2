import{M as Re,R as Se,S as Fe,U as ze,r as t,as as je,v as $e,Q as E,o as v,x as M,a,w as s,q as r,t as p,u as n,f as qe,g as R,b2 as ce,h as S,n as Ae,c as A,aM as G,a3 as N,aW as Ne,b as i,F as W,C as fe,p as m,i as F,b0 as O,e as Oe,b9 as Pe,ba as Be,aR as Ge,N as h,Z as ve,$ as me,a0 as _e,a2 as We,V as Je,bc as He,bd as Qe,be as Ze}from"./index.88d3c7f5.js";import{m as Ke}from"./moduloTemplate.976c75f0.js";import{p as _}from"./parseISO.d0bde0b5.js";import"./moduloTemplate.7adf9c65.js";import"./VBadge.0df54a63.js";const b=z=>(Qe("data-v-3fabc178"),z=z(),Ze(),z),Xe=b(()=>i("br",null,null,-1)),ea=b(()=>i("thead",null,[i("tr",null,[i("th",{scope:"col"},"Usuario"),i("th",{scope:"col"},"Correo"),i("th",{scope:"col"},"Agregar")])],-1)),aa={class:"text-medium-emphasis"},ta={class:"text-medium-emphasis"},la={key:1},oa=b(()=>i("td",{colspan:"3"},"No hay datos",-1)),sa=[oa],ia=["title","src"],na={class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},ua={class:"px-4"},da=b(()=>i("div",{class:"loading"},null,-1)),ra={class:"nombre-desafio d-flex flex-column"},ca={class:"d-flex"},fa=b(()=>i("small",null,"Curso",-1)),va={class:"text-disabled"},ma={class:"p-0"},_a=b(()=>i("b",null,"_id:",-1)),pa={class:"content-items d-flex"},ha={class:"content-curso"},ga=["href"],ba={class:"content-time pl-3"},Va=b(()=>i("b",null,"Duraci\xF3n: ",-1)),Ca={class:"content-time pl-3"},Ma=b(()=>i("b",null,"Categor\xEDa: ",-1)),ya={class:"d-flex flex-nowrap pl-3"},wa=b(()=>i("b",null,"Estado: ",-1)),Da={key:0,class:"ml-2"},xa={key:1,class:"ml-2"},ka={class:"espacio-right-2"},Ya={class:"d-flex align-center justify-space-between botonescurrentPage"},La={__name:"index - copia",setup(z){const Y=Se.exports.extendMoment(Fe);Y.locale("es",[ze]);const y=t(!1),L=t(!1),P=t("tab-lista");t(1);const k=t([]);t(1),t(1),t(""),t(!1);const pe=t(!1);t(!1);const w=t(!1),j=t(null),c=Y().format("YYYY-MM-DD"),I=t({fechasModel:[_(c),_(c)],fechasVModel:[_(c)],fechasVConfig:{position:"auto right",mode:"single",minDate:_(c),altFormat:"d F j, Y",dateFormat:"l, j \\d\\e F \\d\\e Y",valueFormat:"d-m-Y",reactive:!0},fechai:c,fechaV:c,fechaf:c}),J=t(!1),H=t("");t("");const D=t([]),$=t([]),g=t([]),he=t(null);t(!1);const T=t(null),Q=t([]),Z=t([]),K=t([]),ge=t(null);t(!1);const U=t(null),X=t([]),ee=t(""),B=t("");t(""),t(!0),t(""),t("");const ae=t(""),te=t(""),le=t(null),oe=t(null),se=t(null),ie=t(!0),ne=t(""),x=t({message:"Datos guardados",type:"success",model:!1}),be=t([]);t([]),je(async()=>{await Ve()});async function Ve(l=1,o=10){try{var u=new Headers;u.append("Content-Type","application/json");var e={method:"GET",headers:u,redirect:"follow"},d=await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/elearning/etiqueta/listar.php",e);const f=await d.json();be.value=f}catch(f){return console.error(f.message)}}const q=8,V=t(1),Ce=$e(()=>{const l=(V.value-1)*q,o=l+q;return k.value.slice(l,o)}),Me=()=>{V.value*q<k.value.length&&V.value++},ye=()=>{V.value>1&&V.value--};function ue(){ne.value="",le.value="",ee.value="",B.value="",oe.value="",se.value="",B.value="",te.value="",ae.value="",g.value=[],D.value=[],Z.value=null,ie.value=!0,I.value={fechasModel:[_(c),_(c)],fechasVModel:[_(c)],fechasVConfig:I.value.fechasVConfig,fechai:c,fechaV:c,fechaf:c}}async function we(){ue(),H.value="add",J.value=!0}function De(l,o){o.sort((e,d)=>e.posicion-d.posicion);let u=[];for(let e=0;e<o.length;e++){let d=l.find(f=>f===o[e]._id);d&&u.push({title:o[e].titulo,value:d})}return u}function xe(l,o){return l.filter(e=>o.includes(e.value)).map(e=>e.value)}async function ke(l){ue(),H.value="edit";const e=(await(await fetch("https://servicio-elearning.vercel.app/curso/get/"+l)).json()).data;if(ne.value=e._id,le.value=e.titulo,ee.value=e.idRudo,B.value=e.duracion,oe.value=e.descripcion,se.value=e.thumbnail,te.value=e.etiquetas,ae.value=e.categoria,ie.value=e.estado,e.cuestionario&&(Z.value=e.cuestionario._id),D.value=xe($.value,e.modulos.reduce((d,f)=>(d.push(f._id),d),[])),e.fechai){const d={fechai:Y(e.fechai,"DD-MM-YYYY").format("YYYY-MM-DD"),fechaf:Y(e.fechaf,"DD-MM-YYYY").format("YYYY-MM-DD"),fechav:Y(e.fechaVencimiento,"DD-MM-YYYY").format("YYYY-MM-DD")};I.value={fechasModel:[_(d.fechai),_(d.fechaf)],fechasVModel:[_(d.fechav)],fechasVConfig:I.value.fechasVConfig,fechai:e.fechai,fechaV:e.fechaVencimiento,fechaf:e.fechaf},I.value.fechasVConfig.minDate=_(d.fechav)}J.value=!0,g.value=De(D.value,e.modulos)}const C=t(!1),de=t("");function Ye(l){C.value=!0,de.value=l}function Le(l){j.value={_id:l._id,idRudoModel:l.idRudo,urlContent:l.urlRudo},w.value=!0}function re(){const l=$.value,o=D.value;if(o){if(g.value.length<o.length)for(var u in l)o[o.length-1]==l[u].value&&g.value.push(l[u]);if(g.value.length>o.length){const d=g.value.filter(f=>!o.includes(f.value));for(var e in d)for(var u in g.value)if(d[e].value==g.value[u].value){g.value.splice(u,1);break}}}}E(async()=>D.value,async()=>{D.value&&re()});async function Ie(){var l={method:"DELETE",redirect:"follow"};const u=await(await fetch("https://servicio-elearning.vercel.app/curso/delete/"+de.value,l)).json();u.resp?x.value={message:"Desaf\xEDo eliminado correctamente",type:"success",model:!0}:x.value={message:u.mensaje,type:"error",model:!0},await getGestionCursos(),C.value=!1}const Te=async l=>{l.action=="modal"&&(y.value=l.modalShow),l.action=="add"&&(await getModulos(),y.value=l.modalShow,D.value.push(l.id),re())};E(async()=>U.value,async()=>{U.value?K.value=X.value.filter(l=>l.title.toLowerCase().indexOf(U.value.toLowerCase())>-1||l.value.indexOf(U.value)>-1):K.value=X.value}),E(ge,l=>{l||setTimeout(()=>{U.value=""},1e3)}),E(async()=>T.value,async()=>{T.value?$.value=Q.value.filter(l=>l.title.toLowerCase().indexOf(T.value.toLowerCase())>-1||l.value.indexOf(T.value)>-1):$.value=Q.value}),E(he,l=>{l||setTimeout(()=>{T.value=""},1e3)});async function Ue(){this.isDialogSearchUser=!0,this.isLoadingDialogUser=!0,this.isLoadingDialogUser=!1}function Ee(l){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.filtrarUsuariosUser(l.target.value)},1e3)}return(l,o)=>{const u=He;return v(),M("section",null,[a(qe,{modelValue:n(x).model,"onUpdate:modelValue":o[0]||(o[0]=e=>n(x).model=e),location:"top end",variant:"flat",timeout:n(x).timeout||2e3,color:n(x).type},{default:s(()=>[r(p(n(x).message),1)]),_:1},8,["modelValue","timeout","color"]),a(O,{modelValue:n(L),"onUpdate:modelValue":o[2]||(o[2]=e=>F(L)?L.value=e:null),persistent:"",class:"v-dialog-lg"},{default:s(()=>[a(u,{onClick:o[1]||(o[1]=e=>L.value=!n(L))}),a(R,{title:"Lista de usuarios"},{default:s(()=>[a(ce,{class:"pl-6 mb-3"},{default:s(()=>[r(" Solo se obtendr\xE1 los 20 primeros registros de acuerdo a la b\xFAsqueda. ")]),_:1}),a(S,null,{default:s(()=>[a(Ae,{disabled:l.isLoadingDialogUser,"append-inner-icon":"tabler-user-search",type:"text",onInput:Ee,label:"Buscar por correo, tel\xE9fono o nombre",placeholder:"Buscar usuarios"},null,8,["disabled"]),l.labelError.visible?(v(),A(G,{key:0,color:"error",class:"mt-2"},{default:s(()=>[r(" Error: "+p(l.labelError.mensaje),1)]),_:1})):N("",!0),Xe,a(Ne,{style:{width:"100%"},class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:s(()=>[ea,i("tbody",null,[l.dataUsers.length>0?(v(!0),M(W,{key:0},fe(l.filteredDataUsers,e=>(v(),M("tr",{key:e.userId,class:""},[i("td",null,p((e.last_name+" "+e.first_name).length>25?(e.last_name+" "+e.first_name).substring(0,25)+"...":e.last_name+" "+e.first_name),1),i("td",aa,p(e.email),1),i("td",ta,[a(m,{disabled:l.isLoadingDialogUser,class:"mt-4",color:"success",onClick:d=>l.resolveUsuario(e),icon:"mdi-plus-circle-outline",variant:"text"},null,8,["disabled","onClick"])])]))),128)):(v(),M("tr",la,sa))])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(O,{modelValue:n(y),"onUpdate:modelValue":o[4]||(o[4]=e=>F(y)?y.value=e:null),width:"600"},{default:s(()=>[a(u,{onClick:o[3]||(o[3]=e=>y.value=!n(y))}),a(R,null,{default:s(()=>[a(Ke,{"onGet:eventModalCR":Te})]),_:1})]),_:1},8,["modelValue"]),a(O,{modelValue:n(w),"onUpdate:modelValue":o[7]||(o[7]=e=>F(w)?w.value=e:null),width:"500"},{activator:s(({props:e})=>[]),default:s(()=>[a(u,{onClick:o[5]||(o[5]=e=>w.value=!n(w))}),a(R,{title:n(j).idRudoModel},{default:s(()=>[i("iframe",{class:"mt-3",title:"Video "+n(j).idRudoModel,width:"100%",height:"300",src:n(j).urlContent},null,8,ia),a(S,{class:"d-flex justify-end"},{default:s(()=>[a(m,{onClick:o[6]||(o[6]=e=>w.value=!1)},{default:s(()=>[r(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),a(O,{modelValue:n(C),"onUpdate:modelValue":o[10]||(o[10]=e=>F(C)?C.value=e:null),persistent:"",class:"v-dialog-sm"},{default:s(()=>[a(u,{onClick:o[8]||(o[8]=e=>C.value=!n(C))}),a(R,{title:"Eliminar registro"},{default:s(()=>[a(S,null,{default:s(()=>[r(" \xBFDesea eliminar el registro? ")]),_:1}),a(S,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[a(m,{color:"secondary",variant:"tonal",onClick:o[9]||(o[9]=e=>C.value=!1)},{default:s(()=>[r(" No, cerrar ")]),_:1}),a(m,{onClick:Ie},{default:s(()=>[r(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Je,null,{default:s(()=>[a(Oe,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:s(()=>[a(R,{class:"mt-5"},{default:s(()=>[a(S,null,{default:s(()=>[a(Pe,{modelValue:n(P),"onUpdate:modelValue":o[11]||(o[11]=e=>F(P)?P.value=e:null)},{default:s(()=>[a(Be,{value:"tab-lista"},{default:s(()=>[i("div",na,[i("div",null,[a(Ge,null,{default:s(()=>[r(" Listado de cursos E-Learning ")]),_:1}),a(ce,null,{default:s(()=>[r(" Mantenimiento de cursos E-Learning ")]),_:1})])]),i("div",ua,[a(m,{color:"primary",class:"mb-4",onClick:we},{default:s(()=>[r(" Crear registro "),a(h,{size:22,icon:"tabler-plus"})]),_:1}),a(m,{color:"success",class:"mb-4",onClick:Ue},{default:s(()=>[r(" A\xF1adir usuarios "),a(h,{end:"",icon:"mdi-account-plus"})]),_:1}),n(k).length<1?(v(),A(ve,{key:0,lines:"two",border:""},{default:s(()=>[a(me,null,{default:s(()=>[a(_e,null,{default:s(()=>[da]),_:1})]),_:1})]),_:1})):N("",!0),n(k).length>0?(v(),A(ve,{key:1,lines:"two",border:""},{default:s(()=>[(v(!0),M(W,null,fe(n(Ce),(e,d)=>(v(),M(W,{key:d},[a(me,{disabled:n(pe)},{append:s(()=>[i("div",ka,[a(m,{title:"Ver vista previa del curso",icon:"",size:"x-small",color:"warning",variant:"text",onClick:f=>Le(e)},{default:s(()=>[a(h,{size:"22",icon:"tabler-movie"})]),_:2},1032,["onClick"]),a(m,{title:"Editar registro",color:"success",variant:"text",icon:"",onClick:f=>ke(e._id)},{default:s(()=>[a(h,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),a(m,{title:"Eliminar el registro",icon:"",size:"x-small",color:"error",variant:"text",onClick:f=>Ye(e._id)},{default:s(()=>[a(h,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),a(m,{icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-elearning-gestion-cursos-view-id",params:{id:e._id}}},{default:s(()=>[a(h,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])])]),default:s(()=>[a(_e,null,{default:s(()=>[i("div",ra,[i("div",ca,[fa,i("small",va,[i("code",ma,[_a,r(p(e._id),1)])])]),i("label",null,p(e.titulo),1),i("div",pa,[i("div",ha,[a(h,{size:"20",icon:"tabler-video"}),i("a",{class:"pl-2",target:"_blank",href:e.urlRudo},p(e.idRudo),9,ga)]),i("div",ba,[a(h,{size:"20",icon:"tabler-clock"}),Va,r(" "+p(e.duracion)+" min ",1)]),i("div",Ca,[a(h,{size:"20",icon:"mdi-animation"}),Ma,r(" "+p(e.categoria),1)]),i("div",ya,[a(h,{size:"20",icon:"tabler-power"}),wa,e.estado?(v(),M("div",Da,[a(G,{color:"success"},{default:s(()=>[r(" Activo ")]),_:1})])):(v(),M("div",xa,[a(G,{color:"error"},{default:s(()=>[r(" Inactivo ")]),_:1})]))])])])]),_:2},1024)]),_:2},1032,["disabled"]),d!==n(k).length-1?(v(),A(We,{key:0})):N("",!0)],64))),128))]),_:1})):N("",!0),i("div",Ya,[a(m,{icon:"tabler-arrow-big-left-lines",onClick:ye,disabled:n(V)===1},null,8,["disabled"]),r(" P\xE1gina "+p(n(V))+" ",1),a(m,{icon:"tabler-arrow-big-right-lines",onClick:Me,disabled:n(V)*q>=n(k).length},null,8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})])}}},Sa=Re(La,[["__scopeId","data-v-3fabc178"]]);export{Sa as default};
