import{R as ce,S as de,U as ue,r as _,Q as Y,ak as _e,v as pe,as as me,z as fe,o as N,x as A,a as n,w as u,q as k,t as V,u as r,f as ve,e as ge,g as be,aQ as ye,b as x,p as he,N as xe,a3 as we,aR as $e,b2 as ke,h as Ve,bC as Ce,i as E,aT as ne,$ as Z,n as De,a2 as Te,aU as Se,aV as qe,a1 as Me,bx as Pe,V as Ye,bP as L}from"./index.88d3c7f5.js";const Ne={class:"p-0 d-flex flex-column align-items-start"},Ae=x("br",null,null,-1),Le=x("br",null,null,-1),ze={class:"d-flex align-top justify-content-flex-end flex-wrap flex-column gap-0"},je={key:0,class:"px-0 py-1 text-disabled"},Be={class:"p-0 mt-0 mb-3 d-flex align-items-center flex-wrap gap-3"},Ie={key:0},Re={key:1},Ke={__name:"r_analitica_grafico_1",setup(Ee){const C=ce.exports.extendMoment(de);C.locale("es",[ue]);const z="https://ecuavisa-suscripciones.vercel.app",v=_({message:"Datos guardados",type:"success",model:!1}),O=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],U=_({_id:"_id",wylexId:"wylexId",site:"site",site_id:"site_id",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created_at",logged_at:"logged_at",logged_at_site:"logged_at_site",updated_at:"updated_at",validated_at:"validated_at",banned_at:"banned_at",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider",platform:"platform",created_in_os:"created_in_os",ciudad:"ciudad",telefono:"telefono",birthDate:"birthDate",reembolso_created_at:"reembolso_created_at",reembolso_estado:"reembolso_estado",transaction_id:"transaction_id",package_details_fechaInicio:"package_details_fechaInicio",package_details_fechaBaja:"package_details_fechaBaja",package_details_prox_pago:"package_details_prox_pago",package_details_valorPagar:"package_details_valorPagar",package_details_precio_promocion:"package_details_precio_promocion",package_details_ciclos_promocion:"package_details_ciclos_promocion",package_details_ciclo_promocion_actual:"package_details_ciclo_promocion_actual",billing_details_nombres:"billing_details_nombres",billing_details_email:"billing_details_email",billing_details_apellidos:"billing_details_apellidos",billing_details_cedula:"billing_details_cedula",billing_details_telefono:"billing_details_telefono",billing_details_pais:"billing_details_pais",billing_details_ciudad:"billing_details_ciudad",billing_details_direccion:"billing_details_direccion",billing_details_ndireccion_opcional:"billing_details_ndireccion_opcional",transaction_status:"transaction_status",transaction_current_status:"transaction_current_status",transaction_status_detail:"transaction_status_detail",transaction_payment_date:"transaction_payment_date",transaction_amount:"transaction_amount",transaction_carrier_code:"transaction_carrier_code",transaction_message:"transaction_message",transaction_authorization_code:"transaction_authorization_code",transaction_dev_reference:"transaction_dev_reference",transaction_carrier:"transaction_carrier",transaction_product_description:"transaction_product_description",transaction_payment_method_type:"transaction_payment_method_type",transaction_trace_number:"transaction_trace_number",transaction_lot_number:"transaction_lot_number",mes:"mes"}),y=_(!1),D=_(2024),ee=[2025,2024,2023,2022],w=_(null),g=_([]),b=_([]),T=_(null),j=_(!1),$=_(null),S=_(!1),q=_(!1),M=_([]);Y(async()=>$.value,async()=>{$.value?g.value=b.value.filter(d=>d.title.toLowerCase().indexOf($.value.toLowerCase())>-1):g.value=b.value}),Y(T,d=>{d||setTimeout(()=>{$.value=""},1e3)});async function J(d=1,s=10){try{j.value=!0;var a=new Headers;a.append("Content-Type","application/json");var e={method:"GET",headers:a,redirect:"follow"},o=await fetch(`${z}/paquete/backoffice/display-all`,e);const t=await o.json();g.value=t.data.reduce((l,c)=>(l.push({title:`${c.nombre}`,value:c._id}),l),[]),b.value=g.value,w.value="651c9d012ff9fa09a75e6c16",j.value=!1}catch(t){return v.value={message:"No se pudo recuperar los paquetes, recargue de nuevo.",type:"error",model:!0},console.error(t.message)}}async function G(d={}){try{const{anio:o=null,idPaquete:t=null}=d;q.value=!0;var s=new Headers;s.append("Content-Type","application/json");var a={method:"GET",headers:s,redirect:"follow"},e=await fetch(`${z}/backoffice-grafico/reembolsos-realizados-agrupados-por-mes?anio=${o}&idPaquete=${t}`,a);const l=await e.json();M.value=l.data,q.value=!1}catch(o){return v.value={message:"No se pudo recuperar los datos, recargue de nuevo.",type:"error",model:!0},console.error(o.message)}}const W=d=>{const s=`rgba(${L(d.colors["on-surface"])},${d.variables["medium-emphasis-opacity"]})`,a=`rgba(${L(d.colors["on-surface"])},${d.variables["disabled-opacity"]})`,e=`rgba(${L(String(d.variables["border-color"]))},${d.variables["border-opacity"]})`,o=`rgba(${L(d.colors["on-surface"])},${d.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:s,themeDisabledTextColor:a,themeBorderColor:e,themePrimaryTextColor:o}},Q=_e(),ae=d=>{const s={series3:"#b992fe",series2:"#e0cffe",series1:"#ab7efd"},{themeSecondaryTextColor:a,themeBorderColor:e,themeDisabledTextColor:o}=W(d),t=[];for(var l in O){const c=O[l],i=M.value.find(m=>m.mes_text.toLowerCase()==c.toLowerCase());i?t.push(i.reembolsos):t.push(0)}return{config:{chart:{parentHeightOffset:0,toolbar:{show:!1}},tooltip:{y:{formatter:function(c){return c+" reembolsos"}},theme:!1,custom:function({series:c,seriesIndex:i,dataPointIndex:m,w:f}){return`<div class="tooltip-content">
              <div class="tooltip-body">
                <div class="tooltip-title">
                  ${f.globals.categoryLabels[m]}
                </div>
                <!--<div class="tooltip-subtitle">
                  Campa\xF1a
                </div>-->
                <div class="tooltip-data-flex">
                  <div class="tooltip-data-title">
                    ${f.config.series[i].name}
                  </div>
                  <div class="tooltip-data-value">
                    ${c[i][m]} 
                  </div>
                </div>
              </div>
            </div>`}},dataLabels:{enabled:!1,formatter(c){return`${c} $`}},stroke:{show:!1,curve:"straight"},legend:{position:"top",horizontalAlign:"left",labels:{colors:a},markers:{offsetY:1,offsetX:-3},itemMargin:{vertical:3,horizontal:10}},colors:[s.series3,s.series2,s.series1],fill:{opacity:1,type:"solid"},grid:{show:!0,borderColor:e,xaxis:{lines:{show:!0}}},yaxis:{title:{text:"Num. Reembolsos",style:{fontSize:"11px",fontFamily:"Public Sans",color:o}},labels:{style:{colors:o}}},xaxis:{tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{color:e},crosshairs:{stroke:{color:e}},labels:{style:{colors:o}},categories:O}},series:[{name:"Reembolsos",data:t}]}},X=pe(()=>ae(Q.current.value));me(async()=>{y.value=!0,await J(),y.value=!1}),Y(async()=>D.value,async()=>{D.value&&w.value&&await G({anio:D.value,idPaquete:w.value})}),Y(async()=>w.value,async()=>{w.value&&D.value&&await G({anio:D.value,idPaquete:w.value})});const B=_([]),K=_(z+"/backoffice-grafico/descargar/reembolsos-realizados-agrupados-por-mes"),I=_("reembolsos_realizados"),R=_({tamanioActual:0,tamanioTotal:0});function te(d){for(var s=typeof d!="object"?JSON.parse(d):d,a="",e=0;e<s.length;e++){var o="";for(var t in s[e]){o!=""&&(o+=",");var l=s[e][t];typeof l=="string"&&l.includes(",")&&(l=`"${l}"`),o+=l}a+=o+`\r
`}return a}function F(d,s,a){s.unshift(d),console.log("items",s);var e=JSON.stringify(s),o=te(e),t=a+".csv"||"export.csv",l=new Blob([o],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,t);else{var c=document.createElement("a");if(c.download!==void 0){var i=URL.createObjectURL(l);c.setAttribute("href",i),c.setAttribute("download",t),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}}function oe(d){const s={\u00E1:"a",\u00E9:"e",\u00ED:"i",\u00F3:"o",\u00FA:"u",\u00C1:"A",\u00C9:"E",\u00CD:"I",\u00D3:"O",\u00DA:"U",\u00F1:"n",\u00D1:"N"};return d.split("").map(e=>s[e]||e).join("").toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")+"-"+C().format("YYYY-MM-DD-HH-mm-ss")}async function le(d=1,s=10,a=1,e=null,o=2024){try{if(!e)return!1;var t=new Headers;t.append("Content-Type","application/json");var l={method:"GET",headers:t,redirect:"follow"},c=await fetch(`${K.value}?page=${d}&limit=${s}&anio=${o}&idPaquete=${e}&estado=${a}`,l);const i=await c.json();return i.resp?i:(v.value={message:"No se pudo recuperar los usuarios, recargue de nuevo.",type:"error",model:!0},S.value=!1,null)}catch(i){return v.value={message:"No se pudo recuperar los usuarios, recargue de nuevo.",type:"error",model:!0},console.error(i.message),S.value=!1,null}}function se(d){const s=new Set;return d.filter(a=>s.has(a.wylexId)?!1:(s.add(a.wylexId),!0))}async function re(){R.value={tamanioActual:0,tamanioTotal:0},B.value=[];for(var d=1,s=2024,a=w.value,e=1;;){const l=(await le(e,500,d,a,s)).data,c="-";for(var o in l){const i=l[o],m=i.user||{};let f={};for(let p in U.value)m.hasOwnProperty(p)?f[p]=m[p]:f[p]="";for(let p in i)p!="user"&&(p=="created_at"?f.reembolso_created_at=i[p]:p=="estado"?f.reembolso_estado=i[p]:f[p]=i[p],p=="billing_details_direccion"&&(f.billing_details_direccion=i[p]));B.value.push(f)}if(R.value.tamanioActual=B.value.length,R.value.tamanioTotal=c,B.value.sort((i,m)=>C(m.created_at_reembolso,"DD/MM/YYYY-HH:mm:ss").diff(C(i.created_at_reembolso,"DD/MM/YYYY-HH:mm:ss"))),e++,l.length<1)break}return!0}async function ie(){try{S.value=!0,await re(),S.value=!1;let s=[];s=B.value;var d=`${I.value}-`+oe(g.value.find(a=>w.value==a.value).title);F(U.value,se(s),d)}catch(s){return console.log(s),v.value={message:"No se pudo recuperar los datos de registros para exportar, recargue de nuevo.",type:"error",model:!0},!1}}return(d,s)=>{const a=fe("v-list-item-content");return N(),A("section",null,[n(ve,{modelValue:r(v).model,"onUpdate:modelValue":s[0]||(s[0]=e=>r(v).model=e),location:"top end",variant:"flat",timeout:r(v).timeout||2e3,color:r(v).type},{default:u(()=>[k(V(r(v).message),1)]),_:1},8,["modelValue","timeout","color"]),n(Ye,null,{default:u(()=>[n(ge,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:u(()=>[n(be,null,{default:u(()=>[n(ye,null,{append:u(()=>[x("div",ze,[n(he,{loading:r(S),disabled:r(S),color:"primary",onClick:ie},{default:u(()=>[k(" Descargar "),n(xe,{end:"",icon:"tabler-cloud-download"})]),_:1},8,["loading","disabled"]),r(S)?(N(),A("small",je," Exportando "+V(r(R).tamanioActual)+" / "+V(r(R).tamanioTotal)+" registros ",1)):we("",!0)])]),default:u(()=>[x("div",Ne,[n($e,null,{default:u(()=>[k(" A\xF1o "+V(r(D))+".",1),Ae,k("Reembolsos realizados agrupados por meses. ")]),_:1}),n(ke,null,{default:u(()=>[k(" Debes seleccionar el paquete para ver los resultados"),Le,k(" de reembolsos. ")]),_:1})])]),_:1}),n(Ve,null,{default:u(()=>[x("div",Be,[n(Ce,{modelValue:r(D),"onUpdate:modelValue":s[1]||(s[1]=e=>E(D)?D.value=e:null),items:ee,label:"Filtro de a\xF1o","menu-props":{maxHeight:"300"}},null,8,["modelValue"]),n(ne,{style:{width:"285px"},menu:r(T),"onUpdate:menu":s[3]||(s[3]=e=>E(T)?T.value=e:null),"no-data-text":"No existen paquetes que mostrar","append-icon":"mdi-refresh","onClick:append":J,disabled:r(j),"item-text":"title","item-value":"value",modelValue:r(w),"onUpdate:modelValue":s[4]||(s[4]=e=>E(w)?w.value=e:null),items:r(g),label:"Filtro paquetes","menu-props":{maxHeight:"400"}},{"prepend-item":u(()=>[n(Z,null,{default:u(()=>[n(a,null,{default:u(()=>[n(De,{modelValue:r($),"onUpdate:modelValue":s[2]||(s[2]=e=>E($)?$.value=e:null),clearable:"",placeholder:"Buscar paquetes"},null,8,["modelValue"])]),_:1})]),_:1}),n(Te,{class:"mt-2"})]),selection:u(({item:e})=>[x("div",null,V(e.title),1)]),item:u(({item:e,props:o})=>[n(Z,Se(qe(o)),{default:u(()=>[n(a,null,{default:u(()=>[n(Me,null,{default:u(()=>[x("p",null,"_id: "+V(e.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["menu","disabled","modelValue","items"])]),r(y)?(N(),A("div",Ie,"Cargando datos...")):(N(),A("div",Re,[n(r(Pe),{type:"area",height:"300",options:r(X).config,series:r(X).series},null,8,["options","series"])]))]),_:1})]),_:1})]),_:1})]),_:1})])}}},Fe={class:"p-0 d-flex flex-column align-items-start"},He=x("br",null,null,-1),Oe=x("br",null,null,-1),Ue={class:"d-flex align-top justify-content-flex-end flex-wrap flex-column gap-0"},Ge={key:0,class:"px-0 py-1 text-disabled"},Je={class:"p-0 mt-0 mb-3 d-flex align-items-center flex-nowarp gap-3"},Qe={key:0},We={key:1},Ze={__name:"r_analitica_grafico_2_dia",setup(Ee){const C=ce.exports.extendMoment(de);C.locale("es",[ue]);const z="https://ecuavisa-suscripciones.vercel.app",v=_({message:"Datos guardados",type:"success",model:!1}),O=_({_id:"_id",wylexId:"wylexId",site:"site",site_id:"site_id",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created_at",logged_at:"logged_at",logged_at_site:"logged_at_site",updated_at:"updated_at",validated_at:"validated_at",banned_at:"banned_at",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider",platform:"platform",created_in_os:"created_in_os",ciudad:"ciudad",telefono:"telefono",birthDate:"birthDate",reembolso_created_at:"reembolso_created_at",reembolso_estado:"reembolso_estado",transaction_id:"transaction_id",package_details_fechaInicio:"package_details_fechaInicio",package_details_fechaBaja:"package_details_fechaBaja",package_details_prox_pago:"package_details_prox_pago",package_details_valorPagar:"package_details_valorPagar",package_details_precio_promocion:"package_details_precio_promocion",package_details_ciclos_promocion:"package_details_ciclos_promocion",package_details_ciclo_promocion_actual:"package_details_ciclo_promocion_actual",billing_details_nombres:"billing_details_nombres",billing_details_email:"billing_details_email",billing_details_apellidos:"billing_details_apellidos",billing_details_cedula:"billing_details_cedula",billing_details_telefono:"billing_details_telefono",billing_details_pais:"billing_details_pais",billing_details_ciudad:"billing_details_ciudad",billing_details_direccion:"billing_details_direccion",billing_details_ndireccion_opcional:"billing_details_ndireccion_opcional",transaction_status:"transaction_status",transaction_current_status:"transaction_current_status",transaction_status_detail:"transaction_status_detail",transaction_payment_date:"transaction_payment_date",transaction_amount:"transaction_amount",transaction_carrier_code:"transaction_carrier_code",transaction_message:"transaction_message",transaction_authorization_code:"transaction_authorization_code",transaction_dev_reference:"transaction_dev_reference",transaction_carrier:"transaction_carrier",transaction_product_description:"transaction_product_description",transaction_payment_method_type:"transaction_payment_method_type",transaction_trace_number:"transaction_trace_number",transaction_lot_number:"transaction_lot_number",mes:"mes"}),U=_(!1),y=_(2024),D=[2025,2024,2023,2022],ee=[{title:"Enero",value:"01"},{title:"Febrero",value:"02"},{title:"Marzo",value:"03"},{title:"Abril",value:"04"},{title:"Mayo",value:"05"},{title:"Junio",value:"06"},{title:"Julio",value:"07"},{title:"Agosto",value:"08"},{title:"Septiembre",value:"09"},{title:"Octubre",value:"10"},{title:"Noviembre",value:"11"},{title:"Diciembre",value:"12"}],w=C().format("MM"),g=_(w),b=_(null),T=_([]),j=_([]),$=_(null),S=_(!1),q=_(null),M=_(!1),J=_(!1),G=_([]);Y(async()=>q.value,async()=>{q.value?T.value=j.value.filter(a=>a.title.toLowerCase().indexOf(q.value.toLowerCase())>-1):T.value=j.value}),Y($,a=>{a||setTimeout(()=>{q.value=""},1e3)});async function W(a=1,e=10){try{S.value=!0;var o=new Headers;o.append("Content-Type","application/json");var t={method:"GET",headers:o,redirect:"follow"},l=await fetch(`${z}/paquete/backoffice/display-all`,t);const c=await l.json();T.value=c.data.reduce((i,m)=>(i.push({title:`${m.nombre}`,value:m._id}),i),[]),j.value=T.value,b.value="651c9d012ff9fa09a75e6c16",S.value=!1}catch(c){return v.value={message:"No se pudo recuperar los paquetes, recargue de nuevo.",type:"error",model:!0},console.error(c.message)}}async function Q(a={}){try{const{anio:l=null,idPaquete:c=null,mes:i=null,estado:m=1}=a;J.value=!0;var e=new Headers;e.append("Content-Type","application/json");var o={method:"GET",headers:e,redirect:"follow"},t=await fetch(`${z}/backoffice-grafico/reembolsos-realizados-agrupados-por-dia?estado=${m}&mes=${i}&anio=${l}&idPaquete=${c}`,o);const f=await t.json();G.value=f.data,J.value=!1}catch(l){return v.value={message:"No se pudo recuperar los datos, recargue de nuevo.",type:"error",model:!0},console.error(l.message)}}const ae=a=>{const e=`rgba(${L(a.colors["on-surface"])},${a.variables["medium-emphasis-opacity"]})`,o=`rgba(${L(a.colors["on-surface"])},${a.variables["disabled-opacity"]})`,t=`rgba(${L(String(a.variables["border-color"]))},${a.variables["border-opacity"]})`,l=`rgba(${L(a.colors["on-surface"])},${a.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:e,themeDisabledTextColor:o,themeBorderColor:t,themePrimaryTextColor:l}},X=_e(),B=a=>{const e={series3:"#b992fe",series2:"#e0cffe",series1:"#ab7efd"},{themeSecondaryTextColor:o,themeBorderColor:t,themeDisabledTextColor:l}=ae(a),c=[],i=[];for(var m in G.value){const f=G.value[m];c.push(f.reembolsos),i.push(f.fecha)}return{config:{chart:{parentHeightOffset:0,toolbar:{show:!1},type:"bar"},plotOptions:{bar:{borderRadius:10,dataLabels:{position:"top"}}},dataLabels:{enabled:!1,formatter(f){return`${f} $`},offsetY:-20},xaxis:{axisBorder:{show:!1},axisTicks:{color:t,show:!1},crosshairs:{stroke:{color:t},fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!1},labels:{style:{colors:l}},categories:i,position:"top"},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},title:{text:"Num. Reembolsos",style:{fontSize:"11px",fontFamily:"Public Sans",color:l}},labels:{style:{colors:l}}},tooltip:{y:{formatter:function(f){return f+" reembolsos"}},theme:!1,custom:function({series:f,seriesIndex:p,dataPointIndex:H,w:P}){return`<div class="tooltip-content">
              <div class="tooltip-body">
                <div class="tooltip-title">
                  ${C(P.globals.labels[H],"YYYY-MM-DD").format("MMM Do dddd YYYY")}
                </div>
                <!--<div class="tooltip-subtitle">
                  Campa\xF1a
                </div>-->
                <div class="tooltip-data-flex">
                  <div class="tooltip-data-title">
                    ${P.config.series[p].name}
                  </div>
                  <div class="tooltip-data-value">
                    ${f[p][H]} 
                  </div>
                </div>
              </div>
            </div>`}},stroke:{show:!1,curve:"straight"},legend:{position:"top",horizontalAlign:"left",labels:{colors:o},markers:{offsetY:1,offsetX:-3},itemMargin:{vertical:3,horizontal:10}},colors:[e.series3,e.series2,e.series1],fill:{opacity:1,type:"solid"},grid:{show:!0,borderColor:t,xaxis:{lines:{show:!0}}}},series:[{name:"Reembolsos realizados",data:c}]}},K=pe(()=>B(X.current.value));me(async()=>{U.value=!0,await W(),U.value=!1}),Y(async()=>y.value,async()=>{y.value&&b.value&&g.value&&await Q({anio:y.value,mes:g.value,idPaquete:b.value})}),Y(async()=>b.value,async()=>{b.value&&y.value&&g.value&&await Q({anio:y.value,mes:g.value,idPaquete:b.value})}),Y(async()=>g.value,async()=>{y.value&&b.value&&g.value&&await Q({anio:y.value,mes:g.value,idPaquete:b.value})});const I=_([]),R=_(z+"/backoffice-grafico/descargar/reembolsos-realizados-agrupados-por-dia"),te=_("reembolsos_realizados_dia"),F=_({tamanioActual:0,tamanioTotal:0});function oe(a){for(var e=typeof a!="object"?JSON.parse(a):a,o="",t=0;t<e.length;t++){var l="";for(var c in e[t]){l!=""&&(l+=",");var i=e[t][c];typeof i=="string"&&i.includes(",")&&(i=`"${i}"`),l+=i}o+=l+`\r
`}return o}function le(a,e,o){e.unshift(a),console.log("items",e);var t=JSON.stringify(e),l=oe(t),c=o+".csv"||"export.csv",i=new Blob([l],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(i,c);else{var m=document.createElement("a");if(m.download!==void 0){var f=URL.createObjectURL(i);m.setAttribute("href",f),m.setAttribute("download",c),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)}}}function se(a){const e={\u00E1:"a",\u00E9:"e",\u00ED:"i",\u00F3:"o",\u00FA:"u",\u00C1:"A",\u00C9:"E",\u00CD:"I",\u00D3:"O",\u00DA:"U",\u00F1:"n",\u00D1:"N"};return a.split("").map(t=>e[t]||t).join("").toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")+"-"+C().format("YYYY-MM-DD-HH-mm-ss")}async function re(a=1,e=10,o=1,t=null,l=2024,c=null){try{if(!t)return!1;var i=new Headers;i.append("Content-Type","application/json");var m={method:"GET",headers:i,redirect:"follow"},f=await fetch(`${R.value}?page=${a}&limit=${e}&anio=${l}&mes=${c}&idPaquete=${t}&estado=${o}`,m);const p=await f.json();return p.resp?p:(v.value={message:"No se pudo recuperar los usuarios, recargue de nuevo.",type:"error",model:!0},M.value=!1,null)}catch(p){return v.value={message:"No se pudo recuperar los usuarios, recargue de nuevo.",type:"error",model:!0},console.error(p.message),M.value=!1,null}}function ie(a){const e=new Set;return a.filter(o=>e.has(o.wylexId)?!1:(e.add(o.wylexId),!0))}async function d(){F.value={tamanioActual:0,tamanioTotal:0},I.value=[];for(var a=1,e=2024,o=b.value,t=g.value,l=1;;){const m=(await re(l,500,a,t,o,e)).data,f="-";for(var c in m){const p=m[c],H=p.user||{};let P={};for(let h in O.value)H.hasOwnProperty(h)?P[h]=H[h]:P[h]="";for(let h in p)h!="user"&&(h=="created_at"?P.reembolso_created_at=p[h]:h=="estado"?P.reembolso_estado=p[h]:P[h]=p[h],h=="billing_details_direccion"&&(P.billing_details_direccion=p[h]));I.value.push(P)}if(F.value.tamanioActual=I.value.length,F.value.tamanioTotal=f,I.value.sort((p,H)=>C(H.created_at_reembolso,"DD/MM/YYYY-HH:mm:ss").diff(C(p.created_at_reembolso,"DD/MM/YYYY-HH:mm:ss"))),l++,m.length<1)break}return!0}async function s(){try{M.value=!0,await d(),M.value=!1;let e=[];e=I.value;var a=`${te.value}-`+se(T.value.find(o=>b.value==o.value).title);le(O.value,ie(e),a)}catch(e){return console.log(e),v.value={message:"No se pudo recuperar los datos de registros para exportar, recargue de nuevo.",type:"error",model:!0},!1}}return(a,e)=>{const o=fe("v-list-item-content");return N(),A("section",null,[n(ve,{modelValue:r(v).model,"onUpdate:modelValue":e[0]||(e[0]=t=>r(v).model=t),location:"top end",variant:"flat",timeout:r(v).timeout||2e3,color:r(v).type},{default:u(()=>[k(V(r(v).message),1)]),_:1},8,["modelValue","timeout","color"]),n(Ye,null,{default:u(()=>[n(ge,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:u(()=>[n(be,null,{default:u(()=>[n(ye,null,{append:u(()=>[x("div",Ue,[n(he,{loading:r(M),disabled:r(M),color:"primary",onClick:s},{default:u(()=>[k(" Descargar "),n(xe,{end:"",icon:"tabler-cloud-download"})]),_:1},8,["loading","disabled"]),r(M)?(N(),A("small",Ge," Exportando "+V(r(F).tamanioActual)+" / "+V(r(F).tamanioTotal)+" registros ",1)):we("",!0)])]),default:u(()=>[x("div",Fe,[n($e,null,{default:u(()=>[k(" A\xF1o "+V(r(y))+".",1),He,k("Reembolsos realizados por d\xEDa. ")]),_:1}),n(ke,null,{default:u(()=>[k(" Debes seleccionar el paquete para ver los resultados"),Oe,k(" de reembolsos. ")]),_:1})])]),_:1}),n(Ve,null,{default:u(()=>[n(Ce,{class:"mb-4",modelValue:r(y),"onUpdate:modelValue":e[1]||(e[1]=t=>E(y)?y.value=t:null),items:D,label:"Filtro de a\xF1o","menu-props":{maxHeight:"300"}},null,8,["modelValue"]),x("div",Je,[n(ne,{style:{width:"45px"},modelValue:r(g),"onUpdate:modelValue":e[2]||(e[2]=t=>E(g)?g.value=t:null),items:ee,label:"Filtro de mes","item-text":"title","item-value":"value","menu-props":{maxHeight:"300"}},null,8,["modelValue"]),n(ne,{style:{width:"275px"},menu:r($),"onUpdate:menu":e[4]||(e[4]=t=>E($)?$.value=t:null),"no-data-text":"No existen paquetes que mostrar","append-icon":"mdi-refresh","onClick:append":W,disabled:r(S),"item-text":"title","item-value":"value",modelValue:r(b),"onUpdate:modelValue":e[5]||(e[5]=t=>E(b)?b.value=t:null),items:r(T),label:"Filtro paquetes","menu-props":{maxHeight:"400"}},{"prepend-item":u(()=>[n(Z,null,{default:u(()=>[n(o,null,{default:u(()=>[n(De,{modelValue:r(q),"onUpdate:modelValue":e[3]||(e[3]=t=>E(q)?q.value=t:null),clearable:"",placeholder:"Buscar paquetes"},null,8,["modelValue"])]),_:1})]),_:1}),n(Te,{class:"mt-2"})]),selection:u(({item:t})=>[x("div",null,V(t.title),1)]),item:u(({item:t,props:l})=>[n(Z,Se(qe(l)),{default:u(()=>[n(o,null,{default:u(()=>[n(Me,null,{default:u(()=>[x("p",null,"_id: "+V(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["menu","disabled","modelValue","items"])]),r(U)?(N(),A("div",Qe,"Cargando datos...")):(N(),A("div",We,[n(r(Pe),{type:"bar",height:"300",options:r(K).config,series:r(K).series},null,8,["options","series"])]))]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{Ke as _,Ze as a};
