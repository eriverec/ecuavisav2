import{M as ke,y as Ve,bv as Se,u as f,r as I,R as Te,S as Le,U as ze,ak as Me,v as F,Q as L,as as Ee,o as u,c as y,w as a,a as t,e as p,g as b,aQ as N,aR as k,q as d,b2 as Y,h as g,V as z,aT as Ie,b as c,bw as Ne,x as w,t as v,a3 as $,N as D,p as C,bx as H,F as S,C as M,Z as J,$ as ee,aM as j,a0 as ae,a1 as te,b7 as Ye,b8 as ne,b9 as je,ba as ce,a$ as Oe,b0 as Pe,bb as U,aX as Ae,bd as Be,be as Ge}from"./index.88d3c7f5.js";import{V as G}from"./VAlert.3e8ed100.js";import{V as Ke,a as We}from"./VTimelineItem.36b36f8a.js";const x=O=>(Be("data-v-eed9242e"),O=O(),Ge(),O),qe=x(()=>c("label",{class:"mb-2 d-block"},"Escoge una regla:",-1)),Qe=x(()=>c("label",{class:"mb-2 d-block"},"Escoge rango de fechas:",-1)),Xe={class:"date-picker-wrapper",style:{width:"100%"}},Ze={class:"d-block text-center"},He=x(()=>c("div",{class:"text-h5 mb-2",style:{color:"#7367f0"}}," Cargando informaci\xF3n .... ",-1)),Je={class:"descripcion"},ea=x(()=>c("b",{class:"mr-1"},"Regla seleccionada: ",-1)),aa={key:0,style:{color:"#7367f0"}},ta={class:"d-flex"},sa={class:"user-type-left"},la={class:"d-flex flex-column align-center"},oa=x(()=>c("span",{class:"text-subtitle-1"},"An\xF3nimos",-1)),ia={class:"user-type-right"},na={class:"d-flex flex-column align-center text-center"},ca={class:"text-subtitle-1 font-weight-medium mb-2"},ra={class:"d-flex"},da={class:"user-type-left"},ua={class:"d-flex flex-column align-center"},va=x(()=>c("span",{class:"text-subtitle-1"},"Registrados",-1)),fa={class:"user-type-right"},ma={class:"d-flex flex-column align-center text-center"},_a={class:"text-subtitle-1 font-weight-medium mb-2"},pa={class:"d-flex"},ba={class:"user-type-left"},ga={class:"d-flex flex-column align-center"},ha=x(()=>c("span",{class:"text-subtitle-1"},"Suscritos",-1)),ya={class:"user-type-right"},xa={class:"d-flex flex-column align-center text-center"},Da={class:"text-subtitle-1 font-weight-medium mb-2"},Ra={col:"12",md:"6"},wa={class:"descripcion"},Fa=x(()=>c("b",{class:"mr-1"},"Regla seleccionada: ",-1)),Ca={key:0,style:{color:"#7367f0"}},Ua={class:"d-flex justify-space-between align-center w-100"},$a={class:"descripcion"},ka=x(()=>c("b",{class:"mr-1"},"Regla seleccionada: ",-1)),Va={key:0,style:{color:"#7367f0"}},Sa=x(()=>c("div",{class:"text-h5 mt-8 mb-4 text-center text-primary"}," Filtro de navegaci\xF3n por tipo de usuario ",-1)),Ta={class:"d-flex justify-center mb-4 gap-4"},La={class:"d-flex align-center"},za={class:"flex-grow-1"},Ma={class:"font-weight-bold primary--text"},Ea={key:0,class:"text-subtitle-1 mt-2"},Ia={class:"font-weight-bold text-uppercase"},Na={class:"flex-grow-1"},Ya={key:0,class:"d-flex justify-center pa-4"},ja={key:1},Oa={class:"text-truncate flex-grow-1"},Pa={class:"descripcion"},Aa=x(()=>c("b",{class:"mr-1"},"Regla seleccionada: ",-1)),Ba={key:0,style:{color:"#7367f0"}},Ga={class:"d-flex justify-center mb-4 gap-4"},Ka={class:"text-h6 font-weight-bold mb-1"},Wa=x(()=>c("div",{class:"text-subtitle-2"},"Ciudades totales",-1)),qa={class:"text-h6 font-weight-bold mb-1"},Qa=x(()=>c("div",{class:"text-subtitle-2"},"Usuarios \xFAnicos",-1)),Xa={class:"text-h6 font-weight-bold mb-1"},Za=x(()=>c("div",{class:"text-subtitle-2"},"Total accesos",-1)),Ha={class:"d-flex flex-column"},Ja=x(()=>c("span",null,"Visitantes de URL",-1)),et={class:"text-caption text-medium-emphasis mt-1"},at={class:"d-flex gap-4 mb-4"},tt={class:"d-flex flex-column gap-1"},st={class:"text-subtitle-1"},lt={class:"text-body-2"},ot=x(()=>c("strong",null,"Visitas:",-1)),it={class:"text-body-2"},nt=x(()=>c("strong",null,"\xDAltima visita:",-1)),ct=Ve({name:"EstadisticasContenido"}),rt=Object.assign(ct,{setup(O){Se(s=>({"0881334f":f(h)?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)","1f5662a9":f(h)?"#1E1E1E":"#F8F8F8","6f96329d":f(h)?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)","78ba15d2":f(h)?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",d5e5d0f2:f(h)?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}));const E=I(!1),V=Te.exports.extendMoment(Le);V.locale("es",[ze]);const re=Me(),h=F(()=>re.current.value.dark),se=I({urls:!1,ciudades:!1,stats:!1}),R=I({navigation:{anonimo:null,registrado:null,suscrito:null},cities:{anonimo:null,registrado:null,suscrito:null}}),e=I({userData:{anonimos:0,registrados:0,suscritos:0,totalUsuariosUnicos:0},statsData:{secciones:[],subsecciones:[],estadisticasGenerales:{totalVisitas:0}},dateRange:{start:V().startOf("month").format("YYYY-MM-DD"),end:V().format("YYYY-MM-DD")},rules:[],selectedRule:null,selectedSection:null,selectedSubsection:null,selectedUrl:null,activeNavigationTab:"registrado",activeCiudadesTab:"registrado",activeInnerTab:"secciones",urlsData:{totalUrls:0,urls:[]},visitantesData:[],isLoadingUrls:!1,showVisitantesModal:!1,chartKey:0,initialLoadComplete:!1,selectedSectionSet:!1,loadingVisitantes:null,ciudadesData:{estadisticasGenerales:{totalCiudades:0,totalUsuariosUnicos:0,totalAccesos:0},ciudades:[]}}),P=async(s,o=!1)=>{var n,l;if(!!((n=e.value.selectedRule)!=null&&n.id)){if(!o&&R.value.navigation[s]){e.value.urlsData=R.value.navigation[s],B();return}E.value=!0;try{const i="https://restriccion-contenido.vercel.app/content-access/config",[r,_]=await Promise.all([U.get(`${i}/${e.value.selectedRule.id}/secciones-stats?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=json`),U.get(`${i}/${e.value.selectedRule.id}/urls/tipo-usuario/${s}?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=json`)]);if(r.data&&(e.value.statsData=r.data,B(),e.value.chartKey++),_.data){const m={..._.data,urls:((l=_.data.urls)==null?void 0:l.map(T=>({...T,visitas:1})))||[]};R.value.navigation[s]=m,e.value.urlsData=m}}catch(i){console.error("Error cargando datos de navegaci\xF3n:",i)}finally{E.value=!1}}},A=async(s,o=!1)=>{var n;if(!!((n=e.value.selectedRule)!=null&&n.id)){if(!o&&R.value.cities[s]){e.value.ciudadesData=R.value.cities[s];return}try{const l="https://restriccion-contenido.vercel.app/content-access/config",i=await U.get(`${l}/${e.value.selectedRule.id}/ciudades/${s}/?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}`);if(i.data){const r={estadisticasGenerales:i.data.estadisticasGenerales,ciudades:i.data.ciudades.sort((_,m)=>m.totalUsuarios-_.totalUsuarios)};R.value.cities[s]=r,e.value.ciudadesData=r,e.value.chartKey++}}catch(l){console.error("Error cargando datos de ciudades:",l)}}};L(()=>e.value.activeNavigationTab,async(s,o)=>{s!==o&&(e.value.selectedSubsection=null,e.value.activeInnerTab="secciones",await P(s))},{flush:"post"}),L(()=>e.value.activeCiudadesTab,async(s,o)=>{s!==o&&await A(s)});const K=async(s,o=!1)=>{var n;if(!!((n=e.value.selectedRule)!=null&&n.id)){if(!o&&R.value[s]){e.value.urlsData=R.value[s];return}se.value={urls:!0,ciudades:!0,stats:!0};try{await Promise.all([_e(),ie(),me()]),e.value.activeCiudadesTab=s}catch(l){console.error("Error cargando datos:",l)}finally{se.value={urls:!1,ciudades:!1,stats:!1}}}},le=F(()=>e.value.statsData.secciones.length>1),de=F(()=>{var o;if(!e.value.statsData.secciones.length)return[];const s={};return(o=e.value.urlsData.urls)==null||o.forEach(n=>{n.seccion&&(s[n.seccion]=(s[n.seccion]||0)+1)}),[...e.value.statsData.secciones].map(n=>({...n,totalVisitas:s[n.seccion]||0})).sort((n,l)=>l.totalVisitas-n.totalVisitas)}),W=F(()=>{var l;if(!e.value.statsData.subsecciones.length)return[];const s=e.value.selectedSection||(e.value.statsData.secciones.length===1?e.value.statsData.secciones[0].seccion:null);if(!s)return[];let o=e.value.statsData.subsecciones.filter(i=>i.seccion===s).map(i=>{var _;const r=((_=e.value.urlsData.urls)==null?void 0:_.filter(m=>m.seccion===s&&m.subseccion===i.subseccion).length)||0;return{...i,totalVisitas:r}}).sort((i,r)=>r.totalVisitas-i.totalVisitas);const n=((l=e.value.urlsData.urls)==null?void 0:l.filter(i=>i.seccion===s&&(!i.subseccion||i.subseccion.trim()==="")))||[];return n.length>0&&o.push({seccion:s,subseccion:"notas-sin-subseccion",totalVisitas:n.length}),o}),ue=()=>{const s=V();return{start:V().subtract(14,"days").format("YYYY-MM-DD"),end:s.format("YYYY-MM-DD")}};e.value.dateRange=ue();const ve=async(s,o,n)=>{var l;if(s.length>1){const i=V(s[0]).format("YYYY-MM-DD"),r=V(s[1]).format("YYYY-MM-DD");e.value.dateRange={start:i,end:r},(l=e.value.selectedRule)!=null&&l.id&&(e.value.initialLoadComplete=!1,R.value={navigation:{anonimo:null,registrado:null,suscrito:null},cities:{anonimo:null,registrado:null,suscrito:null}},await Promise.all([P(e.value.activeNavigationTab,!0),A(e.value.activeCiudadesTab,!0)]))}},q=F(()=>{var n;if(!((n=e.value.urlsData.urls)!=null&&n.length))return[];const s=e.value.selectedSection||(e.value.statsData.secciones.length===1?e.value.statsData.secciones[0].seccion:null);if(!s)return[];const o=new Map;return e.value.urlsData.urls.filter(l=>l.seccion!==s?!1:e.value.selectedSubsection==="notas-sin-subseccion"?!l.subseccion||l.subseccion.trim()==="":e.value.selectedSubsection?l.subseccion===e.value.selectedSubsection:!0).forEach(l=>{const i=l.url;if(o.has(i)){const r=o.get(i);r.visitas++,o.set(i,r)}else o.set(i,{...l,visitas:1})}),Array.from(o.values()).sort((l,i)=>i.visitas-l.visitas)}),fe=F(()=>!e.value.isLoadingUrls&&e.value.hasLoadedInitialData&&e.value.selectedSection&&(e.value.activeInnerTab==="secciones"&&!W.value.length||e.value.activeInnerTab==="urls"&&!q.value.length)),oe=F(()=>e.value.statsData.secciones.length>1&&!e.value.selectedSection?"Selecciona una secci\xF3n":e.value.activeInnerTab==="secciones"?"No hay subsecciones disponibles":"No hay URLs disponibles"),me=async()=>{var s,o,n,l,i;if(!!((s=e.value.selectedRule)!=null&&s.id))try{E.value=!0;const r="https://restriccion-contenido.vercel.app/content-access/config",[_,m]=await Promise.all([U.get(`${r}/${e.value.selectedRule.id}?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}`),U.get(`${r}/${e.value.selectedRule.id}/secciones-stats?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=json`)]);if(_.data.resp&&((o=_.data.data)==null?void 0:o.metricasPorTipoUsuario)){const T=_.data.data.metricasPorTipoUsuario;e.value.userData={anonimos:((n=T.anonimo)==null?void 0:n.usuariosUnicos)||0,registrados:((l=T.registrado)==null?void 0:l.usuariosUnicos)||0,suscritos:((i=T.suscrito)==null?void 0:i.usuariosUnicos)||0,totalUsuariosUnicos:Object.values(T).reduce(($e,Z)=>$e+((Z==null?void 0:Z.usuariosUnicos)||0),0)}}m.data&&(e.value.statsData=m.data,B(),e.value.chartKey++),E.value=!1}catch(r){console.error("Error al obtener datos:",r)}},B=()=>{var o;const s=[...e.value.statsData.secciones].sort((n,l)=>{const i=n.porTipoUsuario[e.value.activeTab]||0;return(l.porTipoUsuario[e.value.activeTab]||0)-i});e.value.selectedSection=((o=s[0])==null?void 0:o.seccion)||null},_e=async()=>{var s,o;if(!!((s=e.value.selectedRule)!=null&&s.id)){if(R.value[e.value.activeTab]){e.value.urlsData=R.value[e.value.activeTab];return}e.value.isLoadingUrls=!0;try{const n=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/urls/tipo-usuario/${e.value.activeTab}?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=json`,l=await U.get(n);if(l.data){const i={...l.data,urls:((o=l.data.urls)==null?void 0:o.map(r=>({...r,visitas:1})))||[]};R.value[e.value.activeTab]=i,e.value.urlsData=i}}catch(n){console.error("Error al obtener URLs:",n)}finally{e.value.isLoadingUrls=!1}}},ie=async()=>{var s;if(!!((s=e.value.selectedRule)!=null&&s.id))try{const n=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/ciudades/${e.value.activeCiudadesTab}/?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}`,l=await U.get(n);l.data&&(e.value.ciudadesData={estadisticasGenerales:l.data.estadisticasGenerales,ciudades:l.data.ciudades.sort((i,r)=>r.totalUsuarios-i.totalUsuarios)},e.value.chartKey++)}catch(o){console.error("Error al obtener datos de ciudades:",o)}};L(()=>e.value.activeTab,async(s,o)=>{s!==o&&(e.value.selectedSubsection=null,e.value.activeInnerTab="secciones",B(),await K(s))},{flush:"post"}),L(()=>e.value.activeCiudadesTab,async(s,o)=>{s!==o&&await ie()}),L(()=>e.value.selectedRule,(s,o)=>{(s==null?void 0:s.id)&&s.id!==(o==null?void 0:o.id)&&(e.value.initialLoadComplete=!1,e.value.selectedSection=null,R.value={navigation:{anonimo:null,registrado:null,suscrito:null},cities:{anonimo:null,registrado:null,suscrito:null}},P(e.value.activeNavigationTab,!0),A(e.value.activeCiudadesTab,!0))}),L([()=>e.value.dateRange.start,()=>e.value.dateRange.end],([s,o],[n,l])=>{var i;s===n&&o===l||(R.value={anonimo:null,registrado:null,suscrito:null},(i=e.value.selectedRule)!=null&&i.id&&(e.value.initialLoadComplete=!1,K(e.value.activeTab,!0)))});const pe=s=>{e.value.selectedSubsection=s,e.value.activeInnerTab="urls"},be=async s=>{try{const n=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/url-visitantes?url=${encodeURIComponent(s)}&startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&typeUser=${e.value.activeNavigationTab}`,l=await U.get(n);e.value.visitantesData=l.data||[],e.value.showVisitantesModal=!0}catch(o){console.error("Error al obtener visitantes:",o)}},ge=async s=>{var o;if(!!((o=e.value.selectedRule)!=null&&o.id))try{const l=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/url-visitantes?url=${encodeURIComponent(s)}&startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&typeUser=${e.value.activeTab}&format=csv`,i=await U.get(l,{responseType:"blob"}),r=`visitantes_URL_${e.value.dateRange.start}_${e.value.dateRange.end}.csv`,_=window.URL.createObjectURL(new Blob([i.data])),m=document.createElement("a");m.href=_,m.setAttribute("download",r),document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(_)}catch(n){console.error("Error al descargar visitantes:",n)}},Q=async s=>{var o;if(!!((o=e.value.selectedRule)!=null&&o.id))try{const l=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/tipo/${s}/urls?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=csv`,i=await U.get(l,{responseType:"blob"}),r=`usuarios_${s}_${e.value.selectedRule.name}_${e.value.dateRange.start}_${e.value.dateRange.end}.csv`,_=window.URL.createObjectURL(new Blob([i.data])),m=document.createElement("a");m.href=_,m.setAttribute("download",r),document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(_)}catch(n){console.error("Error al descargar datos:",n)}},he=async()=>{try{const s=await U.get("https://estadisticas.ecuavisa.com/sites/gestor/Tools/contenidoLimits/config_contenido.php");s.data.success&&s.data.data&&(e.value.rules=s.data.data,e.value.rules.length>0&&(e.value.selectedRule=e.value.rules[0],await K(e.value.activeTab,!0)))}catch(s){console.error("Error al cargar las reglas:",s)}},ye=async s=>{try{await navigator.clipboard.writeText(s)}catch(o){console.error("Error al copiar URL:",o)}},X=I(!1),xe=async()=>{try{X.value=!0;const o=`https://restriccion-contenido.vercel.app/content-access/config/${e.value.selectedRule.id}/urls/subsecciones?startDate=${e.value.dateRange.start}&endDate=${e.value.dateRange.end}&format=csv`,n=await fetch(o);if(!n.ok)throw new Error("Error en la descarga");const l=await n.blob(),i=window.URL.createObjectURL(l),r=document.createElement("a");r.href=i,r.download=`subsecciones_${e.value.selectedRule.name}_${e.value.dateRange.start}_${e.value.dateRange.end}.csv`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(i),document.body.removeChild(r)}catch(s){console.log("Error al descargar:",s)}finally{X.value=!1}},De=F(()=>({chart:{type:"pie",height:350,foreColor:h.value?"#FFFFFF":"#000000",background:"transparent",fontFamily:"Public Sans, sans-serif",dropShadow:{enabled:!1}},legend:{position:"bottom",labels:{colors:h.value?"#FFFFFF":"#000000"},formatter:(s,o)=>{var n;return((n=e.value.statsData.secciones[o.seriesIndex])==null?void 0:n.seccion)||""}},labels:e.value.statsData.secciones.map(s=>s.seccion),stroke:{width:0},dataLabels:{enabled:!0,formatter:s=>`${Math.round(s)}%`,style:{fontSize:"18px",fontFamily:"Public Sans, sans-serif",fontWeight:"600",colors:[h.value?"#FFFFFF":"#000000"]},dropShadow:{enabled:!1}},tooltip:{theme:h.value?"dark":"light",y:{formatter:(s,{seriesIndex:o})=>{var n;return`${s.toFixed(1)}% (${((n=e.value.statsData.secciones[o])==null?void 0:n.total)||0} visitas)`}}},plotOptions:{pie:{dataLabels:{offset:-10}}}})),Re=F(()=>({chart:{type:"bar",height:350,foreColor:h.value?"#FFFFFF":"#000000",background:"transparent",fontFamily:"Public Sans, sans-serif",toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!0,formatter:s=>Math.round(s),style:{fontSize:"14px",fontFamily:"Public Sans, sans-serif"}},xaxis:{categories:e.value.statsData.subsecciones.map(s=>s.subseccion),labels:{style:{colors:h.value?"#FFFFFF":"#000000"}}},yaxis:{title:{text:"N\xFAmero de visitas",style:{color:h.value?"#FFFFFF":"#000000"}},labels:{formatter:s=>Math.round(s),style:{colors:h.value?"#FFFFFF":"#000000"}}},tooltip:{y:{formatter:s=>Math.round(s)}},legend:{show:!1},colors:["#7367F0"]})),we=F(()=>{var s,o;return{chart:{type:"bar",height:350,foreColor:h.value?"#FFFFFF":"#000000",background:"transparent",fontFamily:"Public Sans, sans-serif",toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4,distributed:!0}},dataLabels:{enabled:!0,formatter:n=>Math.round(n),style:{fontSize:"14px",fontFamily:"Public Sans, sans-serif",colors:["#fff"]}},xaxis:{categories:((o=(s=e.value.ciudadesData)==null?void 0:s.ciudades)==null?void 0:o.map(n=>n.ciudad))||[],labels:{style:{colors:h.value?"#FFFFFF":"#000000"},rotate:-45,trim:!0}},yaxis:{title:{text:"N\xFAmero de usuarios",style:{color:h.value?"#FFFFFF":"#000000"}},labels:{formatter:n=>Math.round(n),style:{colors:h.value?"#FFFFFF":"#000000"}}},tooltip:{y:{formatter:(n,{dataPointIndex:l})=>{var r;const i=(r=e.value.ciudadesData)==null?void 0:r.ciudades[l];return`Usuarios: ${n}
Accesos totales: ${(i==null?void 0:i.totalAccesos)||0}`}}},legend:{show:!1},colors:["#FF9F43","#7367F0","#28C76F","#EA5455","#00CFE8"]}}),Fe=F(()=>{if(!e.value.statsData.secciones.length)return[];const s=e.value.statsData.estadisticasGenerales.totalVisitas;return e.value.statsData.secciones.map(o=>o.total/s*100)}),Ce=F(()=>[{name:"Visitas",data:e.value.statsData.subsecciones.map(s=>s.total)}]),Ue=F(()=>{var s,o;return[{name:"Usuarios",data:((o=(s=e.value.ciudadesData)==null?void 0:s.ciudades)==null?void 0:o.map(n=>n.totalUsuarios))||[]}]});return Ee(async()=>{var s;await he(),(s=e.value.selectedRule)!=null&&s.id&&await Promise.all([P(e.value.activeNavigationTab,!0),A(e.value.activeCiudadesTab,!0)])}),(s,o)=>{const n=Ae;return u(),y(z,null,{default:a(()=>[t(p,{cols:"12"},{default:a(()=>[t(b,null,{default:a(()=>[t(N,{class:"header_card_item mb-0 pb-2"},{default:a(()=>[t(k,null,{default:a(()=>[d("Anal\xEDtica sobre restricci\xF3n de contenido")]),_:1}),t(Y,null,{default:a(()=>[d("Seleccione el filtro de fecha y tipo de regla")]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(z,{class:"mt-0"},{default:a(()=>[t(p,{cols:"12",md:"6"},{default:a(()=>[qe,t(Ie,{modelValue:e.value.selectedRule,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.selectedRule=l),items:e.value.rules,"item-title":"name","item-value":"id","return-object":"","hide-details":"",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(p,{cols:"12",md:"6"},{default:a(()=>[Qe,c("div",Xe,[t(n,{"prepend-inner-icon":"tabler-calendar",density:"compact","show-current":!0,onOnChange:ve,config:{position:"auto right",mode:"range",altFormat:"F j, Y",dateFormat:"Y-m-d",defaultDate:[e.value.dateRange.start,e.value.dateRange.end],maxDate:"today",showMonths:1,locale:{rangeSeparator:" al ",firstDayOfWeek:1},noCalendar:!1,enableTime:!1,wrap:!0}},null,8,["config"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),E.value?(u(),y(p,{key:0,cols:"12"},{default:a(()=>[t(b,{class:"",style:{"max-width":"400px","margin-left":"auto","margin-right":"auto"}},{default:a(()=>[t(g,null,{default:a(()=>[c("div",Ze,[He,t(Ne,{style:{color:"#7367f0"},indeterminate:"",color:"white",class:"mb-0"})])]),_:1})]),_:1})]),_:1})):(u(),y(p,{key:1,cols:"12",class:"p-0 m-0"},{default:a(()=>[t(z,null,{default:a(()=>[t(p,{cols:"12",md:"4"},{default:a(()=>[t(b,null,{default:a(()=>[t(N,{class:"header_card_item"},{default:a(()=>[c("div",null,[c("div",Je,[t(k,null,{default:a(()=>[d("Visitas por tipo de usuario")]),_:1}),t(Y,{class:"d-flex"},{default:a(()=>[ea,e.value.selectedRule?(u(),w("div",aa,v(e.value.selectedRule.name.toUpperCase()),1)):$("",!0)]),_:1})])])]),_:1}),t(g,null,{default:a(()=>[t(z,{dense:""},{default:a(()=>[t(p,{cols:"12"},{default:a(()=>[t(b,{variant:"flat",class:"user-type-card mb-3",elevation:"1"},{default:a(()=>[t(g,{class:"pa-4"},{default:a(()=>[c("div",ta,[c("div",sa,[c("div",la,[t(D,{icon:"mdi-account-outline",size:"24",color:"grey-darken-1",class:"mb-1"}),oa])]),c("div",ia,[c("div",na,[c("span",ca,v(e.value.userData.anonimos)+" usuarios ",1),t(C,{size:"small",variant:"flat",color:"primary",class:"custom-download-btn",onClick:o[1]||(o[1]=l=>Q("anonimo"))},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-download")]),_:1}),d(" Descargar ")]),_:1})])])])]),_:1})]),_:1})]),_:1}),t(p,{cols:"12"},{default:a(()=>[t(b,{variant:"flat",class:"user-type-card mb-3",elevation:"1"},{default:a(()=>[t(g,{class:"pa-4"},{default:a(()=>[c("div",ra,[c("div",da,[c("div",ua,[t(D,{icon:"mdi-account",size:"24",color:"grey-darken-1",class:"mb-1"}),va])]),c("div",fa,[c("div",ma,[c("span",_a,v(e.value.userData.registrados)+" usuarios ",1),t(C,{size:"small",variant:"flat",color:"primary",class:"custom-download-btn",onClick:o[2]||(o[2]=l=>Q("registrado"))},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-download")]),_:1}),d(" Descargar ")]),_:1})])])])]),_:1})]),_:1})]),_:1}),t(p,{cols:"12"},{default:a(()=>[t(b,{variant:"flat",class:"user-type-card",elevation:"1"},{default:a(()=>[t(g,{class:"pa-4"},{default:a(()=>[c("div",pa,[c("div",ba,[c("div",ga,[t(D,{icon:"mdi-star",size:"24",color:"grey-darken-1",class:"mb-1"}),ha])]),c("div",ya,[c("div",xa,[c("span",Da,v(e.value.userData.suscritos)+" usuarios ",1),t(C,{size:"small",variant:"flat",color:"primary",class:"custom-download-btn",onClick:o[3]||(o[3]=l=>Q("suscrito"))},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-download")]),_:1}),d(" Descargar ")]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"8"},{default:a(()=>[t(b,{class:"h-100"},{default:a(()=>[t(N,{class:"header_card_item"},{default:a(()=>[c("div",Ra,[c("div",wa,[t(k,null,{default:a(()=>[d("Secciones visitadas")]),_:1}),t(Y,{class:"d-flex"},{default:a(()=>[Fa,e.value.selectedRule?(u(),w("div",Ca,v(e.value.selectedRule.name.toUpperCase()),1)):$("",!0)]),_:1})])])]),_:1}),t(g,null,{default:a(()=>[(u(),y(f(H),{key:`pie-${e.value.chartKey}`,type:"pie",options:f(De),series:f(Fe),labels:s.pieChartLabels,height:"350"},null,8,["options","series","labels"]))]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"12"},{default:a(()=>[t(b,{class:"h-100"},{default:a(()=>[t(N,{class:"header_card_item"},{default:a(()=>[c("div",Ua,[c("div",$a,[t(k,null,{default:a(()=>[d("Subsecciones visitadas")]),_:1}),t(Y,{class:"d-flex"},{default:a(()=>[ka,e.value.selectedRule?(u(),w("div",Va,v(e.value.selectedRule.name.toUpperCase()),1)):$("",!0)]),_:1})]),t(C,{icon:"",color:"primary",variant:"text",onClick:xe,loading:X.value},{default:a(()=>[t(D,{icon:"mdi-download"})]),_:1},8,["loading"])])]),_:1}),t(g,null,{default:a(()=>[(u(),y(f(H),{key:`bar-${e.value.chartKey}`,type:"bar",options:f(Re),series:f(Ce),height:"350"},null,8,["options","series"]))]),_:1})]),_:1})]),_:1}),t(p,{cols:"12"},{default:a(()=>[t(b,null,{default:a(()=>[t(g,null,{default:a(()=>[Sa,c("div",Ta,[(u(),w(S,null,M([{value:"anonimo",label:"Visitantes an\xF3nimos"},{value:"registrado",label:"Registrados"},{value:"suscrito",label:"Suscritos"}],(l,i)=>t(C,{key:i,color:e.value.activeNavigationTab===l.value?"primary":"secondary",variant:e.value.activeNavigationTab===l.value?"elevated":"flat",size:"lg",class:"text-uppercase px-4 py-2",onClick:r=>e.value.activeNavigationTab=l.value},{default:a(()=>[d(v(l.label),1)]),_:2},1032,["color","variant","onClick"])),64))]),t(z,null,{default:a(()=>[f(le)?(u(),y(p,{key:0,cols:"12",md:"4"},{default:a(()=>[t(b,null,{default:a(()=>[t(k,{class:"text-h6 pa-4"},{default:a(()=>[d(" Top Secciones ")]),_:1}),t(g,null,{default:a(()=>[t(J,null,{default:a(()=>[(u(!0),w(S,null,M(f(de),(l,i)=>(u(),y(ee,{key:l.seccion,value:l,onClick:r=>{e.value.selectedSection=l.seccion,e.value.selectedSubsection=null}},{prepend:a(()=>[t(j,{size:"small",color:"primary",class:"mr-2"},{default:a(()=>[d(" #"+v(i+1),1)]),_:2},1024)]),default:a(()=>[t(ae,null,{default:a(()=>[d(v(l.seccion),1)]),_:2},1024),t(te,null,{default:a(()=>[d(v(l.totalVisitas)+" visitas ",1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0),t(p,{cols:12,md:f(le)?8:12},{default:a(()=>[t(b,null,{default:a(()=>[t(k,{class:"text-h6 pa-4 d-flex flex-column"},{default:a(()=>[c("div",La,[c("span",za,[d(" Detalle de secci\xF3n: "),c("span",Ma,v(e.value.selectedSection||(e.value.statsData.secciones.length===1?e.value.statsData.secciones[0].seccion:"")),1)])]),e.value.selectedSubsection?(u(),w("div",Ea,[d(" SUBSECCI\xD3N: "),c("span",Ia,v(e.value.selectedSubsection==="notas-sin-subseccion"?"Notas sin subsecci\xF3n":e.value.selectedSubsection),1)])):$("",!0)]),_:1}),t(Ye,{modelValue:e.value.activeInnerTab,"onUpdate:modelValue":o[4]||(o[4]=l=>e.value.activeInnerTab=l),color:"primary",class:"px-4"},{default:a(()=>[t(ne,{value:"secciones"},{default:a(()=>[d("Subsecciones")]),_:1}),t(ne,{value:"urls"},{default:a(()=>[d("URLs")]),_:1})]),_:1},8,["modelValue"]),t(g,null,{default:a(()=>[t(je,{modelValue:e.value.activeInnerTab,"onUpdate:modelValue":o[5]||(o[5]=l=>e.value.activeInnerTab=l)},{default:a(()=>[t(ce,{value:"secciones"},{default:a(()=>[f(W).length?(u(),y(J,{key:0},{default:a(()=>[(u(!0),w(S,null,M(f(W),(l,i)=>(u(),y(ee,{key:l.subseccion},{prepend:a(()=>[t(j,{size:"small",color:l.subseccion==="notas-sin-subseccion"?"warning":"primary",class:"mr-2"},{default:a(()=>[d(" #"+v(i+1),1)]),_:2},1032,["color"])]),default:a(()=>[t(ae,{class:"d-flex align-center"},{default:a(()=>[c("span",Na,v(l.subseccion==="notas-sin-subseccion"?"Notas sin subsecci\xF3n":l.subseccion||"Sin subsecci\xF3n"),1),t(C,{icon:"",variant:"text",size:"small",onClick:r=>pe(l.subseccion)},{default:a(()=>[t(D,null,{default:a(()=>[d("mdi-link-variant")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),t(te,null,{default:a(()=>[d(v(l.totalVisitas)+" visitas ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):f(fe)?(u(),y(G,{key:1,type:"info",variant:"tonal",class:"mt-2"},{default:a(()=>[d(v(f(oe)),1)]),_:1})):$("",!0)]),_:1}),t(ce,{value:"urls"},{default:a(()=>[t(b,{flat:""},{default:a(()=>[t(g,null,{default:a(()=>[e.value.isLoadingUrls?(u(),w("div",Ya,[t(Oe,{indeterminate:"",color:"primary",size:32,width:3})])):(u(),w("div",ja,[f(q).length?(u(),y(J,{key:0},{default:a(()=>[(u(!0),w(S,null,M(f(q),(l,i)=>(u(),y(ee,{key:i,class:"url-item"},{default:a(()=>[t(ae,{class:"text-body-2 d-flex align-center justify-space-between"},{default:a(()=>[c("div",Oa,v(l.url),1)]),_:2},1024),t(te,{class:"d-flex align-center flex-wrap gap-2 mt-2"},{default:a(()=>[e.value.activeNavigationTab!=="anonimo"?(u(),w(S,{key:0},[t(j,{size:"small",color:"primary",variant:"outlined",class:"ms-2"},{default:a(()=>[d(v(l.visitas)+" visitas ",1)]),_:2},1024),t(C,{size:"small",variant:"text",color:"primary",loading:e.value.loadingVisitantes===l.url,onClick:r=>be(l.url)},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-eye")]),_:1}),d(" Ver ")]),_:2},1032,["loading","onClick"]),t(C,{size:"small",variant:"text",color:"primary",onClick:r=>ge(l.url)},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-download")]),_:1}),d(" Descargar ")]),_:2},1032,["onClick"]),t(C,{size:"small",variant:"text",color:"primary",onClick:r=>ye(l.url)},{default:a(()=>[t(D,{size:"small",class:"me-1"},{default:a(()=>[d("mdi-content-copy")]),_:1}),d(" Copiar ")]),_:2},1032,["onClick"])],64)):$("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(u(),y(G,{key:1,type:"info",variant:"tonal",class:"mt-2"},{default:a(()=>[d(v(f(oe)),1)]),_:1}))]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",class:"d-none"},{default:a(()=>[t(b,null,{default:a(()=>[t(N,{class:"header_card_item"},{default:a(()=>[c("div",Pa,[t(k,null,{default:a(()=>[d("Ciudades por tipo de usuario")]),_:1}),t(Y,{class:"d-flex"},{default:a(()=>[Aa,e.value.selectedRule?(u(),w("div",Ba,v(e.value.selectedRule.name.toUpperCase()),1)):$("",!0)]),_:1})])]),_:1}),t(g,null,{default:a(()=>[c("div",Ga,[(u(),w(S,null,M([{value:"anonimo",label:"Visitantes an\xF3nimos"},{value:"registrado",label:"Registrados"},{value:"suscrito",label:"Suscritos"}],(l,i)=>t(C,{key:i,color:e.value.activeCiudadesTab===l.value?"primary":"secondary",variant:e.value.activeCiudadesTab===l.value?"elevated":"flat",size:"lg",class:"text-uppercase px-4 py-2",onClick:r=>e.value.activeCiudadesTab=l.value},{default:a(()=>[d(v(l.label),1)]),_:2},1032,["color","variant","onClick"])),64))]),t(z,{class:"mb-6"},{default:a(()=>[t(p,{cols:"12",md:"4"},{default:a(()=>[t(b,{variant:"flat",class:"stats-card h-100"},{default:a(()=>[t(g,{class:"text-center"},{default:a(()=>[t(D,{icon:"mdi-map-marker-multiple",size:"36",color:"muted",class:"mb-2"}),c("div",Ka,v(e.value.ciudadesData.estadisticasGenerales.totalCiudades),1),Wa]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"4"},{default:a(()=>[t(b,{variant:"flat",class:"stats-card h-100"},{default:a(()=>[t(g,{class:"text-center"},{default:a(()=>[t(D,{icon:"mdi-account-group",size:"36",color:"muted",class:"mb-2"}),c("div",qa,v(e.value.ciudadesData.estadisticasGenerales.totalUsuariosUnicos),1),Qa]),_:1})]),_:1})]),_:1}),t(p,{cols:"12",md:"4"},{default:a(()=>[t(b,{variant:"flat",class:"stats-card h-100"},{default:a(()=>[t(g,{class:"text-center"},{default:a(()=>[t(D,{icon:"mdi-chart-timeline-variant",size:"36",color:"muted",class:"mb-2"}),c("div",Xa,v(e.value.ciudadesData.estadisticasGenerales.totalAccesos),1),Za]),_:1})]),_:1})]),_:1})]),_:1}),e.value.ciudadesData.ciudades.length===0?(u(),y(G,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[d(" No hay datos de ciudades disponibles para el per\xEDodo seleccionado ")]),_:1})):(u(),y(f(H),{key:`ciudades-${e.value.chartKey}`,type:"bar",options:f(we),series:f(Ue),height:"350"},null,8,["options","series"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})),t(Pe,{modelValue:e.value.showVisitantesModal,"onUpdate:modelValue":o[7]||(o[7]=l=>e.value.showVisitantesModal=l),width:"600"},{default:a(()=>[t(b,null,{default:a(()=>[t(k,{class:"pa-4 d-flex justify-space-between align-center"},{default:a(()=>[c("div",Ha,[Ja,c("span",et,v(e.value.selectedUrl),1)]),t(C,{icon:"",variant:"text",size:"small",onClick:o[6]||(o[6]=l=>e.value.showVisitantesModal=!1)},{default:a(()=>[t(D,null,{default:a(()=>[d("mdi-close")]),_:1})]),_:1})]),_:1}),t(g,null,{default:a(()=>{var l;return[c("div",at,[t(j,{color:"primary",variant:"outlined"},{default:a(()=>{var i;return[d(" Total visitas: "+v(((i=e.value.visitantesData.estadisticas)==null?void 0:i.totalVisitas)||0),1)]}),_:1}),t(j,{color:"primary",variant:"outlined"},{default:a(()=>{var i;return[d(" Total visitantes: "+v(((i=e.value.visitantesData.estadisticas)==null?void 0:i.totalVisitantes)||0),1)]}),_:1})]),t(Ke,{align:"start","line-thickness":"2",density:"compact"},{default:a(()=>[(u(!0),w(S,null,M(e.value.visitantesData.visitantes,(i,r)=>(u(),y(We,{key:r,"dot-color":"primary",size:"small"},{default:a(()=>[t(b,{variant:"tonal",class:"mb-3"},{default:a(()=>[t(g,{class:"py-2"},{default:a(()=>[c("div",tt,[c("div",st,v(i.nombre)+" "+v(i.apellido),1),c("div",lt,[ot,d(" "+v(i.conteoVisitas),1)]),c("div",it,[nt,d(" "+v(i.fechasVisita[0]),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),(l=e.value.visitantesData.visitantes)!=null&&l.length?$("",!0):(u(),y(G,{key:0,type:"info",variant:"tonal",class:"mt-2"},{default:a(()=>[d(" No hay visitantes registrados en el per\xEDodo seleccionado ")]),_:1}))]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),ft=ke(rt,[["__scopeId","data-v-eed9242e"]]);export{ft as default};
