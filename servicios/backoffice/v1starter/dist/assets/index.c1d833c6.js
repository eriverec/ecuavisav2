import{R as gt,U as wt,bG as yt,r as s,I as xt,as as bt,Q as xe,v as Ct,z as At,o as u,x as Z,a as n,w as r,q as i,t as h,u as o,f as kt,F as Pe,C as Oe,e as q,g as be,h as ae,b as t,X as Ce,V as $e,aT as Ae,i as Y,a2 as ke,n as Vt,p as k,a3 as Re,L as H,a$ as Mt,aW as Et,c as g,N as _,d as St,aM as Lt,Y as Dt,Z as Ut,$ as qe,b0 as Ft,aQ as je,aR as Ht,a4 as le,aX as Tt,bc as Nt}from"./index.88d3c7f5.js";import{_ as Bt}from"./AddNewUserDrawer.d14432f5.js";import{a as zt}from"./formatters.a9a9bf7f.js";import{M as It}from"./index.50982b4e.js";import{V as Zt}from"./VSpacer.2a3e77c9.js";import{V as Yt}from"./VTooltip.2d0a8708.js";import{V as Gt}from"./VPagination.9412c3b8.js";import"./validators.b5f8ddc5.js";import"./VNavigationDrawer.44422f4c.js";const Pt={class:"d-flex align-center gap-2 my-1"},Ot=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 256 256"},[t("path",{fill:"currentColor",d:"M245.11 60.68c-7.65-13.19-27.84-16.16-58.5-8.66A95.93 95.93 0 0 0 32 128a98 98 0 0 0 .78 12.31C5.09 169 5.49 186 10.9 195.32C16 204.16 26.64 208 40.64 208a124.11 124.11 0 0 0 28.79-4A95.93 95.93 0 0 0 224 128a97.08 97.08 0 0 0-.77-12.25c12.5-13 20.82-25.35 23.65-35.92c1.95-7.32 1.36-13.76-1.77-19.15ZM128 48a80.11 80.11 0 0 1 78 62.2c-17.06 16.06-40.15 32.53-62.07 45.13c-27.55 15.81-51.45 25.67-70.51 31.07A79.94 79.94 0 0 1 128 48ZM24.74 187.29c-1.46-2.51-.65-7.24 2.22-13a79.05 79.05 0 0 1 10.29-15.05a96 96 0 0 0 18 31.32c-17.25 2.9-28.01 1.05-30.51-3.27ZM128 208a79.45 79.45 0 0 1-38.56-9.94a370 370 0 0 0 62.43-28.86c21.58-12.39 40.68-25.82 56.07-39.08A80.07 80.07 0 0 1 128 208ZM231.42 75.69c-1.7 6.31-6.19 13.53-12.63 21.13a95.69 95.69 0 0 0-18-31.35c14.21-2.35 27.37-2.17 30.5 3.24c.9 1.57.95 3.92.13 6.98Z"})],-1),$t=t("label",{class:"text-primary"},"Web:",-1),Rt=["hidden"],qt={class:"d-flex align-center gap-2 my-1"},jt=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"m17.578 4.432l-2-1.05C13.822 2.461 12.944 2 12 2s-1.822.46-3.578 1.382l-.321.169l8.923 5.099l4.016-2.01c-.646-.732-1.688-1.279-3.462-2.21Zm4.17 3.532l-3.998 2V13a.75.75 0 0 1-1.5 0v-2.287l-3.5 1.75v9.441c.718-.179 1.535-.607 2.828-1.286l2-1.05c2.151-1.129 3.227-1.693 3.825-2.708c.597-1.014.597-2.277.597-4.8v-.117c0-1.893 0-3.076-.252-3.978ZM11.25 21.904v-9.44l-8.998-4.5C2 8.866 2 10.05 2 11.941v.117c0 2.525 0 3.788.597 4.802c.598 1.015 1.674 1.58 3.825 2.709l2 1.049c1.293.679 2.11 1.107 2.828 1.286ZM2.96 6.641l9.04 4.52l3.411-1.705l-8.886-5.078l-.103.054c-1.773.93-2.816 1.477-3.462 2.21Z"})],-1),Jt=t("label",{class:"text-primary"},"App:",-1),Qt=["hidden"],Wt={class:"d-flex align-center gap-2 my-1"},Xt=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 26 26"},[t("path",{fill:"currentColor",d:"M12.906-.031a1 1 0 0 0-.125.031A1 1 0 0 0 12 1v1H3a3 3 0 0 0-3 3v13c0 1.656 1.344 3 3 3h9v.375l-5.438 2.719a1.006 1.006 0 0 0 .875 1.812L12 23.625V24a1 1 0 1 0 2 0v-.375l4.563 2.281a1.006 1.006 0 0 0 .875-1.812L14 21.375V21h9c1.656 0 3-1.344 3-3V5a3 3 0 0 0-3-3h-9V1a1 1 0 0 0-1.094-1.031zM2 5h22v13H2V5zm18.875 1a1 1 0 0 0-.594.281L17 9.563L14.719 7.28a1 1 0 0 0-1.594.219l-2.969 5.188l-1.219-3.063a1 1 0 0 0-1.656-.344l-3 3a1.016 1.016 0 1 0 1.439 1.44l1.906-1.906l1.438 3.562a1 1 0 0 0 1.812.125l3.344-5.844l2.062 2.063a1 1 0 0 0 1.438 0l4-4A1 1 0 0 0 20.875 6z"})],-1),Kt=t("label",{class:"text-primary"},"Total:",-1),ea={class:"date-picker-wrapper",style:{width:"auto"}},ta={class:"me-3",style:{width:"80px"}},aa={class:"d-flex align-init flex-wrap gap-2"},la={style:{width:"10rem"}},oa={class:"d-flex flex-wrap flex-column"},sa=t("span",null,"Exportar Todo",-1),na=t("span",null,"Esta carga puede demorar hasta 12 minutos, espere por favor",-1),ra={key:0,class:"px-3 py-1"},ia={class:"d-flex flex-wrap flex-column"},ca={key:0,class:"px-3 py-1"},ua=["sort-by","sort-desc"],da={class:"row-cr"},pa=t("div",null," Nombres ",-1),va={class:"row-cr"},ma=t("div",null,"Proveedor",-1),fa={class:"row-cr"},ha=t("div",null,"Creaci\xF3n",-1),_a={class:"row-cr"},ga=t("div",null,"\xDAltima sesi\xF3n",-1),wa={class:"row-cr"},ya=t("div",null,"Pa\xEDs",-1),xa={class:"row-cr"},ba=t("div",null,"Tel\xE9fono",-1),Ca={class:"row-cr"},Aa=t("div",null,"Newsletter",-1),ka=t("th",{scope:"col"},"Acciones",-1),Va={class:"d-flex align-center"},Ma={key:1},Ea={class:"d-flex flex-column"},Sa={class:"text-base"},La={class:"text-sm text-disabled"},Da={class:"d-flex align-center"},Ua={class:"d-flex flex-column"},Fa={class:"text-capitalize text-base vamosss"},Ha={class:"d-flex align-center"},Ta={class:"d-flex flex-column"},Na={class:"text-capitalize text-base"},Ba={class:"d-flex align-center"},za={class:"d-flex flex-column"},Ia={class:"text-capitalize text-base"},Za={class:"text-sm"},Ya={class:"text-base"},Ga={class:"itemListado"},Pa={class:"lis_true",style:{display:"none"}},Oa=t("span",{class:"lis_false"},"Cargando...",-1),$a={class:"text-center",style:{width:"5rem"}},Ra={class:"text-sm text-disabled"},qa=t("span",null,"\xBF Est\xE1 seguro que desea eliminar",-1),ja=t("br",null,null,-1),il={__name:"index",setup(Ja){const E=gt.exports.extendMoment(It);E.locale("es",[wt]),E.tz.setDefault("America/Guayaquil");const j=yt(),G=s(""),B=s(""),P=s(),S=s(10),Ve=s(2200),b=s(1),J=s(1),x=s({tamanioActual:0,tamanioTotal:0}),Me=s(0),oe=s(0),Ee=s(0),se=s(0),ne=s(0),re=s(0),ie=s(0),w=s({message:"Datos guardados",type:"success",model:!1}),O=s({_id:"_id",wylexId:"wylexId",site:"site",site_id:"site_id",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created_at",logged_at:"logged_at",logged_at_site:"logged_at_site",updated_at:"updated_at",validated_at:"validated_at",banned_at:"banned_at",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider",platform:"platform",created_in_os:"created_in_os"}),ce=s(0),ue=s(0),de=s(0),pe=s(0),ve=s(0),me=s(0),fe=s(0),he=s(0),Se=s(0),Le=s(0),De=s(0),Ue=s(0),C=s([]),Fe=s([]),He=s(0),Te=s(0),Ne=s(0),Be=s(0),X=s(""),_e=s(!0),ge=s(!1),v=s("created_at"),y=s(!0),Q=s([]);s(0);const T=s(""),N=s(""),K=s(""),ee=s(!1),L=s(!1),D=s(!1),U=s(!1),ze=s(!1),Ie=()=>{_e.value=!1,ge.value=!0},Ze=()=>{_e.value=!0,ge.value=!1},F=(e=!1)=>{L.value=e,D.value=e,U.value=e,ze.value=e},$=s(!1);s(JSON.parse(localStorage.getItem("userData"))),s(E().format("DD/MM/YYYY HH:mm:ss").toString());const z=s({}),W=s(!1),Je=xt(),V=()=>{try{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!0;Ie(),j.fetchUsers_v2({pageSize:S.value,page:b.value,query:X.value,provider:B.value,news:P.value,sort:y.value?-1:1,columnSort:v.value,fechai:T.value&&N.value?T.value:"",fechaf:T.value&&N.value?N.value:""}).then(e=>{C.value=e.data.users,Fe.value=e.data.totalUsers;const l=JSON.stringify(C.value),d=JSON.parse(l),m=JSON.stringify(C.value.map(c=>c.email),null,2);fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/sendpulse/token.php").then(function(c){return c.text()}).then(function(c){fetch("https://api.sendpulse.com/emails",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c},body:JSON.stringify({emails:m}),redirect:"follow"}).then(a=>a.json()).then(a=>{const p=C.value;p.forEach(ye=>{const _t=ye.email;ye.newsletter_opt_in=!1,Object.keys(a).forEach(Ge=>{const Xa=a[Ge];Ge.toLowerCase()==_t.toLowerCase()&&(ye.newsletter_opt_in=!0)})}),C.value=p;const f=document.querySelectorAll(".listadoGen .itemListado .lis_true"),M=document.querySelectorAll(".listadoGen .itemListado .lis_false");for(var A of f)A.style.display="block";for(var R of M)R.style.display="none"}).catch(a=>{w.value={message:"No se pudo vincular el usuario con el de sendpulse, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},console.log("error",a)})}).catch(function(c){w.value={message:"No se pudo crear el token de sendpulse, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},console.log(c)}),J.value=e.data.totalPage,Ze()}).catch(e=>{console.error(e)})}catch(e){w.value={message:"No se pudo recuperar los usuarios, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},console.error(e)}};(()=>{let e=localStorage.getItem("role");e!=="administrador"&&e!=="webmaster"&&e!=="audiencia"&&Je.push({path:"/pages/errors/not-authorized"})})(),(()=>{j.countUsers().then(e=>{const l=s(0),d=s(0),m=s(0),c=s(0),a=s(0),p=s(0),f=s(0),M=s(0),A=e.data.totalEmail+e.data.totalFacebook+e.data.totalGoogle;de.value=e.data.totalEmail,ce.value=e.data.totalFacebook,ue.value=e.data.totalGoogle,pe.value=e.data.totalApple,Me.value=e.data.totalEmail+e.data.totalFacebook+e.data.totalGoogle+e.data.totalApple,oe.value=e.data.totalAppEmail+e.data.totalAppGoogle+e.data.totalAppFacebook+e.data.totalAppApple,fe.value=e.data.totalAppEmail,ve.value=e.data.totalAppFacebook,me.value=e.data.totalAppGoogle,he.value=e.data.totalAppApple;let R=oe.value;se.value=e.data.totalEmail+e.data.totalAppEmail,ne.value=e.data.totalFacebook+e.data.totalAppFacebook,re.value=e.data.totalGoogle+e.data.totalAppGoogle,ie.value=e.data.totalApple+e.data.totalAppApple,Ee.value=se.value+ne.value+re.value+ie.value,l.value=de.value*100/A,He.value=Math.round((l.value+Number.EPSILON)*100)/100,d.value=ce.value*100/A,Te.value=Math.round((d.value+Number.EPSILON)*100)/100,m.value=ue.value*100/A,Ne.value=Math.round((m.value+Number.EPSILON)*100)/100,c.value=pe.value*100/A,Be.value=Math.round((c.value+Number.EPSILON)*100)/100,a.value=fe.value*100/R,Se.value=Math.round((a.value+Number.EPSILON)*100)/100,p.value=ve.value*100/R,Le.value=Math.round((p.value+Number.EPSILON)*100)/100,f.value=me.value*100/R,De.value=Math.round((f.value+Number.EPSILON)*100)/100,M.value=he.value*100/R,Ue.value=Math.round((M.value+Number.EPSILON)*100)/100}).catch(e=>{console.error(e)})})();const Qe=()=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!0;G.value&&(b.value=1,J.value=1,X.value=G.value,V())},We=()=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!0;b.value=1,J.value=1,P.value="",B.value=void 0,X.value="",G.value="",T.value="",N.value="",K.value="",V()};bt(async()=>{V()}),xe(async()=>b.value,async(e,l)=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!1;V()}),xe(async()=>S.value,async(e,l)=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!1;V()}),xe(async()=>B.value,async(e,l)=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!1;V()});const Xe=async()=>{},Ke=[{title:"Facebook",value:"facebook"},{title:"Google",value:"google"},{title:"Email",value:"email"},{title:"Apple",value:"apple"},{title:"Email desde app",value:"app-client-email"},{title:"Google desde app",value:"app-client-google"},{title:"Facebook desde app",value:"app-client-facebook"},{title:"Apple desde app",value:"app-client-apple"}],et=[{title:"True",value:"true"},{title:"False",value:"false"}],tt=e=>e==="google"||e==="app-client-google"?{color:"warning",icon:'<svg aria-hidden="true" class="native svg-icon iconGoogle" width="18" height="18" viewBox="0 0 18 18"><path d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18Z" fill="#4285F4"></path><path d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17Z" fill="#34A853"></path><path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07Z" fill="#FBBC05"></path><path d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3Z" fill="#EA4335"></path></svg>'}:e==="facebook"||e==="app-client-facebook"?{color:"success",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 9C18 4.02944 13.9706 0 9 0C4.02944 0 0 4.02944 0 9C0 13.4922 3.29117 17.2155 7.59375 17.8906V11.6016H5.30859V9H7.59375V7.01719C7.59375 4.76156 8.9374 3.51562 10.9932 3.51562C11.9779 3.51562 13.0078 3.69141 13.0078 3.69141V5.90625H11.8729C10.7549 5.90625 10.4062 6.6 10.4062 7.31175V9H12.9023L12.5033 11.6016H10.4062V17.8906C14.7088 17.2155 18 13.4922 18 9Z" fill="#1877F2"/></svg>'}:e==="apple"||e==="app-client-apple"?{color:"success",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"><path d="M11.6734 7.2221C10.7974 7.2221 9.44138 6.2261 8.01338 6.2621C6.12938 6.2861 4.40138 7.3541 3.42938 9.0461C1.47338 12.4421 2.92538 17.4581 4.83338 20.2181C5.76938 21.5621 6.87338 23.0741 8.33738 23.0261C9.74138 22.9661 10.2694 22.1141 11.9734 22.1141C13.6654 22.1141 14.1454 23.0261 15.6334 22.9901C17.1454 22.9661 18.1054 21.6221 19.0294 20.2661C20.0974 18.7061 20.5414 17.1941 20.5654 17.1101C20.5294 17.0981 17.6254 15.9821 17.5894 12.6221C17.5654 9.8141 19.8814 8.4701 19.9894 8.4101C18.6694 6.4781 16.6414 6.2621 15.9334 6.2141C14.0854 6.0701 12.5374 7.2221 11.6734 7.2221ZM14.7934 4.3901C15.5734 3.4541 16.0894 2.1461 15.9454 0.850098C14.8294 0.898098 13.4854 1.5941 12.6814 2.5301C11.9614 3.3581 11.3374 4.6901 11.5054 5.9621C12.7414 6.0581 14.0134 5.3261 14.7934 4.3901Z" fill="rgba(0,0,0,1)"></path></svg>'}:{color:"primary",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33.39 14" width="33.39" height="14"><g id="Capa_2" data-name="Capa 2"><g id="logo"><path d="M14.19,12.16a1.66,1.66,0,0,0-1.66-1.66H1.66a1.66,1.66,0,0,0,0,3.32H12.53A1.66,1.66,0,0,0,14.19,12.16Z" style="fill:#7367f0"/><path d="M32.52.19a1.68,1.68,0,0,0-2.25.68L25.09,9.14,20.23.77A1.72,1.72,0,0,0,18.77.08H7.82a1.66,1.66,0,0,0,0,3.32h9.53a1,1,0,0,1,.78.36l5.39,9.3a1.71,1.71,0,0,0,.71.75,1.66,1.66,0,0,0,2.25-.68L33.19,2.44A1.67,1.67,0,0,0,32.52.19Z" style="fill:#7367f0"/><path d="M19.25,13.83a1.65,1.65,0,0,0,.79-2.2s-2.38-4-3.24-5.74a1.12,1.12,0,0,0-1-.63H4.48a1.66,1.66,0,0,0,0,3.32H14a.65.65,0,0,1,.58.29C15.41,10.55,17,13,17,13.05A1.65,1.65,0,0,0,19.25,13.83Z" style="fill:#7367f0"/></g></g></svg>'},at=e=>e==="false"?"error":e==="true"?"success":e==="inactive"?"secondary":"primary",te=s(!1),lt=Ct(()=>{const e=C.value.length?(b.value-1)*S.value+1:0,l=C.value.length+(b.value-1)*S.value;return`Showing ${e} to ${l} of ${Fe.value} entries`});async function ot(e){le("agregar",e),j.addUser(e),V()}const st=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" style="width: 1rem; height: 1rem;" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="#7367f0" d="M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4Z"/></svg>',color:"primary",title:"Total de Usuarios",stats:Me,percentage:null,percentageApp:null,subtitle:oe,total:Ee},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33.39 14" width="1rem" height="1rem"><g id="Capa_2" data-name="Capa 2"><g id="logo"><path d="M14.19,12.16a1.66,1.66,0,0,0-1.66-1.66H1.66a1.66,1.66,0,0,0,0,3.32H12.53A1.66,1.66,0,0,0,14.19,12.16Z" style="fill:#7367f0"/><path d="M32.52.19a1.68,1.68,0,0,0-2.25.68L25.09,9.14,20.23.77A1.72,1.72,0,0,0,18.77.08H7.82a1.66,1.66,0,0,0,0,3.32h9.53a1,1,0,0,1,.78.36l5.39,9.3a1.71,1.71,0,0,0,.71.75,1.66,1.66,0,0,0,2.25-.68L33.19,2.44A1.67,1.67,0,0,0,32.52.19Z" style="fill:#7367f0"/><path d="M19.25,13.83a1.65,1.65,0,0,0,.79-2.2s-2.38-4-3.24-5.74a1.12,1.12,0,0,0-1-.63H4.48a1.66,1.66,0,0,0,0,3.32H14a.65.65,0,0,1,.58.29C15.41,10.55,17,13,17,13.05A1.65,1.65,0,0,0,19.25,13.83Z" style="fill:#7367f0"/></g></g></svg>',color:"error",title:"Total con Email",stats:de,percentage:He,percentageApp:Se,subtitle:fe,total:se},{icon:'<svg width="1rem" height="1rem" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 9C18 4.02944 13.9706 0 9 0C4.02944 0 0 4.02944 0 9C0 13.4922 3.29117 17.2155 7.59375 17.8906V11.6016H5.30859V9H7.59375V7.01719C7.59375 4.76156 8.9374 3.51562 10.9932 3.51562C11.9779 3.51562 13.0078 3.69141 13.0078 3.69141V5.90625H11.8729C10.7549 5.90625 10.4062 6.6 10.4062 7.31175V9H12.9023L12.5033 11.6016H10.4062V17.8906C14.7088 17.2155 18 13.4922 18 9Z" fill="#1877F2"/></svg>',color:"success",title:"Total con Facebook",stats:ce,percentage:Te,percentageApp:Le,subtitle:ve,total:ne},{icon:'<svg aria-hidden="true" class="native svg-icon iconGoogle" width="1rem" height="1rem" viewBox="0 0 18 18"><path d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18Z" fill="#4285F4"></path><path d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17Z" fill="#34A853"></path><path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07Z" fill="#FBBC05"></path><path d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3Z" fill="#EA4335"></path></svg>',color:"warning",title:"Total con Google",stats:ue,percentage:Ne,percentageApp:De,subtitle:me,total:re},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1rem" height="1rem"><path d="M11.6734 7.2221C10.7974 7.2221 9.44138 6.2261 8.01338 6.2621C6.12938 6.2861 4.40138 7.3541 3.42938 9.0461C1.47338 12.4421 2.92538 17.4581 4.83338 20.2181C5.76938 21.5621 6.87338 23.0741 8.33738 23.0261C9.74138 22.9661 10.2694 22.1141 11.9734 22.1141C13.6654 22.1141 14.1454 23.0261 15.6334 22.9901C17.1454 22.9661 18.1054 21.6221 19.0294 20.2661C20.0974 18.7061 20.5414 17.1941 20.5654 17.1101C20.5294 17.0981 17.6254 15.9821 17.5894 12.6221C17.5654 9.8141 19.8814 8.4701 19.9894 8.4101C18.6694 6.4781 16.6414 6.2621 15.9334 6.2141C14.0854 6.0701 12.5374 7.2221 11.6734 7.2221ZM14.7934 4.3901C15.5734 3.4541 16.0894 2.1461 15.9454 0.850098C14.8294 0.898098 13.4854 1.5941 12.6814 2.5301C11.9614 3.3581 11.3374 4.6901 11.5054 5.9621C12.7414 6.0581 14.0134 5.3261 14.7934 4.3901Z" fill="rgba(0,0,0,1)"></path></svg>',color:"warning",title:"Total con Apple",stats:pe,percentage:Be,percentageApp:Ue,subtitle:he,total:ie}];function nt(e){for(var l=typeof e!="object"?JSON.parse(e):e,d="",m=0;m<l.length;m++){var c="";for(var a in l[m]){c!=""&&(c+=",");var p=l[m][a];typeof p=="string"&&p.includes(",")&&(p=`"${p}"`),c+=p}d+=c+`\r
`}return d}function we(e,l,d){e&&l[0].wylexId!=="wylexId"&&l.unshift(e);var m=JSON.stringify(l),c=nt(m),a=d+".csv"||"export.csv",p=new Blob([c],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(p,a);else{var f=document.createElement("a");if(f.download!==void 0){var M=URL.createObjectURL(p);f.setAttribute("href",M),f.setAttribute("download",a),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}}}async function rt(){x.value={tamanioActual:0,tamanioTotal:0},Q.value=[];var e=1;for(let l=1;l<e+1;l++)await j.fetchUsers_v2({todaBase:1,pageSize:Ve.value,page:l,query:"",provider:"",news:"",sort:y.value?-1:1,columnSort:"",fechai:"",fechaf:""}).then(d=>{let m=Array.from(d.data.users);const c=d.data.totalUsers;l==1&&(e=d.data.totalPage+1),m.length<1&&(l=e.value+2),m.forEach(a=>{let p={};for(let f in O.value)a.hasOwnProperty(f)?p[f]=a[f]:p[f]="";Q.value.push(p)}),x.value.tamanioActual=Q.value.length,x.value.tamanioTotal==0&&(x.value.tamanioTotal=c),Q.value.sort((a,p)=>E(p.created_at,"DD/MM/YYYY-HH:mm:ss").diff(E(a.created_at,"DD/MM/YYYY-HH:mm:ss")))});$.value=!1}async function it(){try{F(!0),$.value=!0,await rt(),$.value=!1;let e=[];e=Q.value;let l="users_full";le("descarga-completa"),we(O.value,e,l),F(!1)}catch(e){console.log(e),w.value={message:"Existe un error al intentar exportar la data, intente nuevamente",type:"error",timeout:4e3,model:!0},F(!1)}}async function ct(){try{F(!0);let e=[],l=Array.from(C.value),d=C.value.length?(b.value-1)*S.value+1:0,m=C.value.length+(b.value-1)*S.value,c="users_section_"+d+"_"+m;l.forEach(a=>{let p={};for(let f in O.value)a.hasOwnProperty(f)?p[f]=a[f]:p[f]="";e.push(p)}),le("descarga-seccion"),we(O.value,e,c),F(!1)}catch(e){console.log(e),w.value={message:"Existe un error al intentar exportar la data, intente nuevamente",type:"error",timeout:4e3,model:!0},F(!1)}}async function ut(){try{ee.value=!0,F(!0),x.value={tamanioActual:0,tamanioTotal:0};let l=[];var e=J.value;for(let m=1;m<e+1;m++)await j.fetchUsers_v2({todaBase:0,pageSize:Ve.value,page:m,query:X.value,provider:B.value,news:P.value,sort:y.value?-1:1,columnSort:v.value,fechai:T.value&&N.value?T.value:"",fechaf:T.value&&N.value?N.value:""}).then(c=>{const a=c.data.users,p=c.data.totalUsers;m==1&&(e=c.data.totalPage+1),a.length<1&&(m=e+2),a.forEach(f=>{let M={};for(let A in O.value)f.hasOwnProperty(A)?M[A]=f[A]:M[A]="";l.push(M)}),x.value.tamanioActual=l.length,x.value.tamanioTotal==0&&(x.value.tamanioTotal=p)}).catch(c=>{console.error(c)});let d="users_busqueda";le("descarga-busqueda"),we(O.value,l,d),ee.value=!1,F(!1)}catch(l){console.log(l),w.value={message:"Existe un error al intentar exportar la data, intente nuevamente",type:"error",timeout:4e3,model:!0},F(!1)}}const I=e=>{if(L.value==!0&&D.value==!0&&U.value==!0)return w.value={message:"Existe una exportaci\xF3n en curso, por favor espere antes de realizar un filtro",type:"error",timeout:4e3,model:!0},!0;v.value===e?y.value=!y.value:(v.value=e,y.value=!1),V()},dt=e=>{e.value=e},pt=e=>{e.value=e};async function vt(e){if(!e)return null;await fetch("https://data.mongodb-api.com/app/backoffice1-usyys/endpoint/id?id="+e).then(l=>l.json()).then(l=>{z.value=l}).catch(l=>(w.value={message:"No se pudo eliminar el usuario, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},l)),W.value=!0}async function mt(){Ie();let e=z.value.wylexId;var l={method:"DELETE",redirect:"follow"};await fetch("https://data.mongodb-api.com/app/backoffice1-usyys/endpoint/delete/wylex?id="+e,l).then(d=>d.json()).then(d=>!0).catch(d=>(w.value={message:"No se pudo eliminar el usuario, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},d)),await fetch("https://servicio-delete.vercel.app/delete?id="+e,l).then(d=>d.json()).then(d=>!0).catch(d=>(w.value={message:"No se pudo eliminar el usuario, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},d)),W.value=!1,z.value={},V(),Ze()}const Ye=e=>{e===!1&&(z.value={}),W.value=e},ft=()=>{z.value={},W.value=!1},ht=e=>{e.length>1&&(T.value=`${E(e[0]).format("YYYY-MM-DD")}T00:00:00Z`,N.value=`${E(e[1]).format("YYYY-MM-DD")}T23:59:59Z`,V())};return(e,l)=>{const d=Tt,m=At("RouterLink"),c=Nt;return u(),Z("section",null,[n(kt,{modelValue:o(w).model,"onUpdate:modelValue":l[0]||(l[0]=a=>o(w).model=a),location:"top end",variant:"flat",timeout:o(w).timeout||2e3,color:o(w).type},{default:r(()=>[i(h(o(w).message),1)]),_:1},8,["modelValue","timeout","color"]),n($e,null,{default:r(()=>[(u(),Z(Pe,null,Oe(st,a=>n(q,{class:"mr-6",key:a.title,cols:"12",sm:"12",lg:"2"},{default:r(()=>[n(be,{class:"col-12 col-sm- col-lg-2 tarjeta"},{default:r(()=>[n(ae,{class:"d-flex justify-space-between",style:{"font-size":"11px"}},{default:r(()=>[t("div",null,[t("span",null,h(a.title),1),t("div",null,[t("div",Pt,[Ot,$t,i(" "+h(a.stats)+" ",1),t("span",{class:"text-success",hidden:!a.percentage},"("+h(a.percentage)+"%) ",9,Rt)]),t("div",qt,[jt,Jt,i(" "+h(a.subtitle)+" ",1),t("span",{class:"text-success",hidden:!a.percentageApp},"("+h(a.percentageApp)+"%) ",9,Qt)]),t("div",Wt,[Xt,Kt,i(" "+h(a.total),1)])])]),n(Ce,{rounded:"",variant:"tonal",color:a.color,innerHTML:a.icon,"max-width":"100%"},null,8,["color","innerHTML"])]),_:2},1024)]),_:2},1024)]),_:2},1024)),64)),n(q,{cols:"12"},{default:r(()=>[n(be,{title:"Filtro de b\xFAsqueda"},{default:r(()=>[n(ae,null,{default:r(()=>[n($e,null,{default:r(()=>[n(q,{cols:"12",sm:"4"},{default:r(()=>[n(Ae,{modelValue:o(B),"onUpdate:modelValue":l[1]||(l[1]=a=>Y(B)?B.value=a:null),label:"Proveedor",items:Ke,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),n(q,{cols:"12",sm:"4",style:{display:"none"}},{default:r(()=>[n(Ae,{modelValue:o(P),"onUpdate:modelValue":l[2]||(l[2]=a=>Y(P)?P.value=a:null),label:"Bolet\xEDn",items:et,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),n(q,{cols:"12",sm:"4"},{default:r(()=>[t("div",ea,[n(d,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:o(K),"onUpdate:modelValue":l[3]||(l[3]=a=>Y(K)?K.value=a:null),"show-current":"true",onOnChange:ht,config:{position:"auto right",mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",maxDate:new Date,minDate:new Date("2023-04-09"),reactive:!0,clearable:!0}},null,8,["modelValue","config"])])]),_:1})]),_:1})]),_:1}),n(ke),n(ae,{class:"d-flex flex-wrap py-4 gap-4"},{default:r(()=>[t("div",ta,[n(Ae,{modelValue:o(S),"onUpdate:modelValue":l[4]||(l[4]=a=>Y(S)?S.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),n(Zt),t("div",aa,[t("div",la,[n(Vt,{modelValue:o(G),"onUpdate:modelValue":l[5]||(l[5]=a=>Y(G)?G.value=a:null),placeholder:"Buscar...",density:"compact"},null,8,["modelValue"])]),n(k,{"prepend-icon":"tabler-search",onClick:Qe}),n(k,{color:"secondary",onClick:We},{default:r(()=>[i(" Reiniciar ")]),_:1}),t("div",oa,[n(k,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:it,loading:o($),disabled:o(L)},{default:r(()=>[sa,n(Yt,{"open-on-click":"","open-on-hover":!1,location:"top",activator:"parent","no-click-animation":"",disabled:!o($)},{default:r(()=>[na]),_:1},8,["disabled"])]),_:1},8,["loading","disabled"]),o($)?(u(),Z("small",ra," Exportando "+h(o(x).tamanioActual)+" / "+h(o(x).tamanioTotal)+" registros ",1)):Re("",!0)]),n(k,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:ct,disabled:o(D)},{default:r(()=>[i(" Exportar secci\xF3n ")]),_:1},8,["disabled"]),t("div",ia,[n(k,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:ut,loading:o(ee),disabled:o(U)},{default:r(()=>[i(" Exportar b\xFAsqueda ")]),_:1},8,["loading","disabled"]),o(ee)?(u(),Z("small",ca," Exportando "+h(o(x).tamanioActual)+" / "+h(o(x).tamanioTotal)+" registros ",1)):Re("",!0)]),n(k,{"prepend-icon":"tabler-plus",onClick:l[6]||(l[6]=a=>te.value=!0)},{default:r(()=>[i(" Agregar usuario ")]),_:1})])]),_:1}),n(ke),t("div",{class:H(["loader-section",{loaded:o(_e)}])},[n(Mt,{indeterminate:"",color:"primary"})],2),n(Et,{class:H(["text-no-wrap",{loaded:o(ge)}]),disabled:!0},{default:r(()=>[t("thead",{"sort-by":o(v),"sort-desc":o(y),"onUpdate:sortBy":dt,"onUpdate:sortDesc":pt},[t("tr",null,[t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[7]||(l[7]=a=>I("first_name"))},[t("div",da,[pa,t("span",{class:H(["sort-icon",{active:o(v)==="first_name"}])},[o(y)&&o(v)=="first_name"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="first_name"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[8]||(l[8]=a=>I("provider"))},[t("div",va,[ma,t("span",{class:H(["sort-icon",{active:o(v)==="provider"}])},[o(y)&&o(v)=="provider"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="provider"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[9]||(l[9]=a=>I("created_at"))},[t("div",fa,[ha,t("span",{class:H(["sort-icon",{active:o(v)==="created_at"}])},[o(y)&&o(v)=="created_at"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="created_at"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[10]||(l[10]=a=>I("logged_at"))},[t("div",_a,[ga,t("span",{class:H(["sort-icon",{active:o(v)==="logged_at"}])},[o(y)&&o(v)=="logged_at"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="logged_at"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[11]||(l[11]=a=>I("country"))},[t("div",wa,[ya,t("span",{class:H(["sort-icon",{active:o(v)==="country"}])},[o(y)&&o(v)=="country"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="country"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[12]||(l[12]=a=>I("phone_number"))},[t("div",xa,[ba,t("span",{class:H(["sort-icon",{active:o(v)==="phone_number"}])},[o(y)&&o(v)=="phone_number"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="phone_number"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[13]||(l[13]=a=>I("newsletter_opt_in"))},[t("div",Ca,[Aa,t("span",{class:H(["sort-icon",{active:o(v)==="newsletter_opt_in"}])},[o(y)&&o(v)=="newsletter_opt_in"?(u(),g(_,{key:0},{default:r(()=>[i("mdi-chevron-down")]),_:1})):!o(y)&&o(v)=="newsletter_opt_in"?(u(),g(_,{key:1},{default:r(()=>[i("mdi-chevron-up")]),_:1})):(u(),g(_,{key:2},{default:r(()=>[i("mdi-chevron-up-down")]),_:1}))],2)])]),ka])],40,ua),t("tbody",null,[(u(!0),Z(Pe,null,Oe(o(C),a=>(u(),Z("tr",{class:"listadoGen",key:a.wylexId,style:{height:"3.75rem"}},[t("td",null,[t("div",Va,[n(Ce,{variant:"tonal",class:"me-3",size:"38"},{default:r(()=>[a.avatar?(u(),g(St,{key:0,src:a.avatar},null,8,["src"])):(u(),Z("span",Ma,h(o(zt)(a.first_name)),1))]),_:2},1024),t("div",Ea,[t("h6",Sa,[n(m,{to:{name:"apps-user-view-id",params:{id:a.wylexId}},class:"font-weight-medium user-list-name"},{default:r(()=>[i(h(a.first_name)+" "+h(a.last_name),1)]),_:2},1032,["to"])]),t("span",La,h(a.email),1)])])]),t("td",null,[t("div",Da,[n(Ce,{class:"me-3",innerHTML:tt(a.provider).icon,variant:"tonal",size:"30"},null,8,["innerHTML"]),t("div",Ua,[t("span",Fa,h(a.provider.replace("app-client-email","App-Email").replace("app-client-google","App-Google").replace("app-client-facebook","App-Facebook").replace("app-client-apple","App-Apple")),1)])])]),t("td",null,[t("div",Ha,[t("div",Ta,[t("span",Na,h(a.created_at!=""?o(E).utc(a.created_at).tz("America/Guayaquil").format("YYYY-MM-DD HH:mm:ss"):""),1)])])]),t("td",null,[t("div",Ba,[t("div",za,[t("span",Ia,h(a.logged_at!=""?o(E).utc(a.logged_at).tz("America/Guayaquil").format("YYYY-MM-DD HH:mm:ss"):""),1)])])]),t("td",null,[t("span",Za,h(a.country),1)]),t("td",null,[t("span",Ya,h(a.phone_number),1)]),t("td",Ga,[n(Lt,{label:"",color:at(a.newsletter_opt_in),size:"small",class:"text-capitalize"},{default:r(()=>[t("span",Pa,h(a.newsletter_opt_in),1),Oa]),_:2},1032,["color"])]),t("td",$a,[n(k,{icon:"",size:"x-small",color:"default",variant:"text"},{default:r(()=>[n(m,{to:{name:"apps-user-view-id",params:{id:a.wylexId}},class:"font-weight-medium user-list-name"},{default:r(()=>[n(_,{size:"22",icon:"tabler-eye"})]),_:2},1032,["to"])]),_:2},1024),n(k,{icon:"",size:"x-small",color:"default",variant:"text",onClick:p=>vt(a.wylexId)},{default:r(()=>[n(_,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),n(k,{icon:"",size:"x-small",color:"default",variant:"text",style:{display:"none"}},{default:r(()=>[n(_,{size:"22",icon:"tabler-dots-vertical"}),n(Dt,{activator:"parent"},{default:r(()=>[n(Ut,null,{default:r(()=>[n(qe,{title:"View",to:{name:"apps-user-view-id",params:{id:a.wylexId}}},null,8,["to"]),n(qe,{title:"Suspend",href:"javascript:void(0)"})]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1},8,["class"]),n(ke),n(ae,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:r(()=>[t("span",Ra,h(o(lt)),1),n(Gt,{modelValue:o(b),"onUpdate:modelValue":l[14]||(l[14]=a=>Y(b)?b.value=a:null),size:"small","total-visible":5,length:o(J),disabled:o(ze),onClick:Xe},null,8,["modelValue","length","disabled"])]),_:1}),n(Ft,{persistent:"","no-click-animation":"",width:e.$vuetify.display.smAndDown?"auto":600,"model-value":o(W),"onUpdate:modelValue":Ye},{default:r(()=>[n(c,{onClick:l[15]||(l[15]=a=>Ye(!1))}),n(be,{class:"pa-sm-14 pa-5"},{default:r(()=>[n(je,{class:"text-center"},{default:r(()=>[n(Ht,{class:"text-h5 mb-3 p-5"},{default:r(()=>[qa,ja,t("span",null,[i("el usuario "),t("i",null,h(o(z).first_name)+" "+h(o(z).last_name),1),i(" ?")])]),_:1})]),_:1}),n(je,null,{default:r(()=>[n(q,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:r(()=>[n(k,{color:"error",onClick:mt},{default:r(()=>[i(" Aceptar ")]),_:1}),n(k,{onClick:ft},{default:r(()=>[i(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])]),_:1})]),_:1})]),_:1}),n(Bt,{isDrawerOpen:o(te),"onUpdate:isDrawerOpen":l[16]||(l[16]=a=>Y(te)?te.value=a:null),onUserData:ot},null,8,["isDrawerOpen"])])}}};export{il as default};
