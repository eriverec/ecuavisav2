import{M as f,R as g,S as v,U as C,ak as b,bP as c,o as l,x as h,F as y,C as T,a as d,w as p,aQ as _,aR as x,q as w,t as L,b as S,g as D}from"./index.88d3c7f5.js";import{a as $}from"./apexcharts.common.8ef5f801.js";const u=g.exports.extendMoment(v);u.locale("es",[C]);const k={setup(){const e=b(),t=e.current.value.colors,a=e.current.value.variables,s=`rgba(${c(t.primary)},${a["dragged-opacity"]})`,i=`rgba(${c(t["on-background"])},${a["high-emphasis-opacity"]})`,o=`rgba(${c(String(a["border-color"]))},${a["border-opacity"]})`,r=`rgba(${c(t["on-surface"])},${a["disabled-opacity"]})`;return{vuetifyTheme:e,currentTheme:t,variableTheme:a,labelPrimaryColor:s,legendColor:i,borderColor:o,labelColor:r,columnColors:{series1:"#0A6847",series2:"#7ABA78",bg:"#f8d3ff"}}},data(){return{isLoading:!0,preguntas:[],preguntasData:[],preguntasConCount:[],params:{fechai:"2023-01-01",fechaf:"2023-10-30"},trivias:[],dateRangeModel:null,selectedTrivia:{title:"Trivia: 1",value:1},chartList:[]}},computed:{chartConfigs(){return this.preguntas.map(e=>({chartOptions:{chart:{parentHeightOffset:0,type:"bar",toolbar:{show:!1}},plotOptions:{bar:{columnWidth:"32%",startingShape:"rounded",borderRadius:4,distributed:!0,dataLabels:{position:"center"}}},grid:{show:!0,padding:{top:0,bottom:0,left:-10,right:-10}},colors:[this.columnColors.series2,this.columnColors.series1],dataLabels:{enabled:!0,formatter(t){return`${t}`},offsetY:0,style:{fontSize:"15px",colors:[this.legendColor],fontWeight:"600"}},legend:{show:!0,position:"top",horizontalAlign:"left",labels:{colors:this.labelColor}},tooltip:{enabled:!0},xaxis:{categories:this.preguntasConCount[e].map(t=>t.respuesta),axisBorder:{show:!0,color:this.borderColor},axisTicks:{show:!1},labels:{style:{colors:this.labelColor,fontSize:"14px"}}},yaxis:{labels:{offsetX:-15,formatter(t){return`${parseInt(t/1)}`},style:{fontSize:"14px",colors:this.labelColor},min:0,max:6e4,tickAmount:6}}},series:[{data:this.preguntasConCount[e].map(t=>t.count)}]}))}},methods:{async fetchData(e=""){var t=document.querySelector("#id-card-estadistica");t.classList.add("disabled"),this.encodeDataToURL(this.params);const s=await(await fetch("https://showandevents-service.vercel.app/all?fechai=2023-01-01&fechaf=2024-10-30&idProyecto=2&idTrivia=1")).json();this.preguntas=[],this.preguntasConCount=[],this.preguntasData=[],s.data.forEach(i=>{i.data.forEach(o=>{o.trivia.forEach(r=>{if(this.preguntas.includes(r.pregunta)){const n=this.preguntasConCount[r.pregunta].find(m=>m.respuesta===r.respuesta);n!==void 0?n.count++:this.preguntasConCount[r.pregunta].push({respuesta:r.respuesta,count:1})}else this.preguntas.push(r.pregunta),this.preguntasData.push(o),this.preguntasConCount[r.pregunta]=[{respuesta:r.respuesta,count:1}]})})}),this.isLoading=!1},createChart(e,t){e.chartOptions.chart.height=350;var a=[{name:"Usuarios",data:e.series[0].data}];e.chartOptions.series=a;const s=new $(t,e.chartOptions);this.chartList.push(s),s.render();var i=document.querySelector("#id-card-estadistica");i.classList.remove("disabled")},initChart(){for(var e in this.chartList){const t=this.chartList[e];t&&t.destroy()}if(this.chartConfigs.length>0){const t=this.$refs.chart;for(let a=0;a<t.length;a++)this.createChart(this.chartConfigs[a],t[a])}},async getListTrivia(){var e=this.encodeDataToURL(this.params);const a=await(await fetch("https://showandevents-service.vercel.app/group?"+e)).json();this.itemsIdTrivias=[],a.resp&&(this.trivias=a.data.map(s=>({title:"Trivia: "+s._id,value:s._id})))},generateURL(){const e=this.encodeDataToURL(this.params);this.url=`https://example.com?${e}`},encodeDataToURL(e){return Object.keys(e).map(t=>`${t}=${encodeURIComponent(e[t])}`).join("&")},async clearSelection(){this.selectedTrivia=null,this.params={fechai:"2023-01-01",fechaf:"2023-10-30"},this.preguntas=[],await this.fetchData(),this.initChart()},async btn_filter(){this.params.idTrivia=this.selectedTrivia,await this.fetchData(),this.initChart()},onChangeRange(e,t,a){console.log("Selected country:",e)},async accionBackoffice(){let e=u().format("DD/MM/YYYY HH:mm:ss").toString(),t=JSON.parse(localStorage.getItem("userData"));if(t.email!=="admin@demo.com"){var a=new Headers;a.append("Content-Type","application/json");var s=JSON.stringify({usuario:t.email,pagina:"concursos-clickclickboom-estadisticas",fecha:e}),i={method:"POST",headers:a,body:s,redirect:"follow"};await fetch("https://servicio-logs.vercel.app/accion",i).then(o=>{}).catch(o=>console.log("error",o))}}},async mounted(){this.getListTrivia(),this.params.idTrivia=this.selectedTrivia.value,await this.fetchData(),this.initChart()}},R={id:"id-card-estadistica"},O={key:0,class:"mt-6"};function U(e,t,a,s,i,o){return l(),h("div",R,[i.isLoading?(l(),h("div",O,"Cargando datos...")):(l(!0),h(y,{key:1},T(i.preguntas,(r,n)=>(l(),h("div",{key:n,class:"mt-6"},[d(D,null,{default:p(()=>[d(_,{class:"pb-sm-0"},{default:p(()=>[d(x,null,{default:p(()=>[w(L(r),1)]),_:2},1024),S("div",{ref_for:!0,ref:"chart",style:{height:"250px"}},null,512)]),_:2},1024)]),_:2},1024)]))),128))])}const B=f(k,[["render",U]]);export{B as default};
