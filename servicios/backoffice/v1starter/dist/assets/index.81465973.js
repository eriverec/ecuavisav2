import{r as n,as as le,v as se,o as b,x as q,a as e,w as a,q as d,t as x,u as o,f as oe,e as C,g as N,aR as L,h as j,b as i,p,c as S,aQ as G,aW as ne,F as I,C as z,N as H,V as B,l as re,m as ue,n as ie,i as D,a2 as de,b0 as M,bc as ce}from"./index.88d3c7f5.js";/* empty css              */import{V as me}from"./VCheckbox.50e352e3.js";const pe={class:"d-flex flex-wrap gap-4 mt-10"},fe=i("thead",null,[i("tr",null,[i("th",{scope:"col"},"Id"),i("th",{scope:"col"},"Nombre"),i("th",{scope:"col"},"Acciones")])],-1),ve={class:"text-medium-emphasis"},ge={class:"text-medium-emphasis"},_e={class:"text-medium-emphasis"},be={class:"d-flex align-center justify-space-between botonescurrentPage"},ye=i("span",{class:"mt-4"},"Asignar paquetes",-1),qe={__name:"index",setup(we){const F=n([]),Q=n([]),h=n([]),P=n(!1),y="https://ecuavisa-suscripciones.vercel.app";async function T(){try{P.value=!0;const l=await(await fetch(y+"/grupo")).json();h.value=l.data,P.value=!1}catch(s){console.error(s.message)}}async function J(){try{const l=await(await fetch(y+"/paquete")).json();let u=Array.from(l.data),t=[];for(const c of u){let V={title:c.nombre,value:c._id};t.push(V)}F.value=t,Q.value=l.data}catch(s){console.error(s.message)}}le(async()=>{await T()});const k=8,f=n(1),W=se(()=>{const s=(f.value-1)*k,l=s+k;return h.value.slice(s,l)}),K=()=>{f.value*k<h.value.length&&f.value++},X=()=>{f.value>1&&f.value--},_=n(!1),w=n(""),m=n(""),v=n([]),r=n({message:"Datos guardados",type:"success",model:!1});n(!1),n([]);function E(){m.value="",v.value=[]}function U(){E(),_.value=!1}async function Y(){E(),w.value="add",await J(),_.value=!0}const A=n("");async function Z(s){E(),w.value="edit",await J();const t=(await(await fetch(y+"/grupo/"+s)).json()).data;A.value=t._id,m.value=t.nombre,v.value=t.paquetes,_.value=!0}async function ee(){let s=m.value,l=v.value;if(!s||s=="")return r.value={message:"Debe a\xF1adir un nombre",type:"error",model:!0},!1;if(l.length<1)return r.value={message:"Debe seleccionar almenos 1 paquete",type:"error",model:!0},!1;var u=new Headers;if(u.append("Content-Type","application/json"),w.value==="add"){let V={nombre:m.value,paquetes:v.value};var t=JSON.stringify(V),c={method:"POST",headers:u,body:t,redirect:"follow"};const R=await(await fetch(y+"/grupo",c)).json();R.resp?r.value={message:"Grupo creado correctamente",type:"success",model:!0}:r.value={message:R.mensaje,type:"error",model:!0}}else if(w.value==="edit"){let V={id:A.value,nombre:m.value,paquetes:v.value};var t=JSON.stringify(V),c={method:"PUT",headers:u,body:t,redirect:"follow"};const $=await(await fetch(y+"/grupo",c)).json();$.resp?r.value={message:"Grupo editado correctamente",type:"success",model:!0}:r.value={message:$.mensaje,type:"error",model:!0}}await T(),_.value=!1}const g=n(!1),O=n("");function ae(s){g.value=!0,O.value=s}async function te(){var s={method:"DELETE",redirect:"follow"};const u=await(await fetch(y+"/grupo/"+O.value,s)).json();u.resp?r.value={message:"Grupo eliminado correctamente",type:"success",model:!0}:r.value={message:u.mensaje,type:"error",model:!0},await T(),g.value=!1}return(s,l)=>{const u=ce;return b(),q("section",null,[e(oe,{modelValue:o(r).model,"onUpdate:modelValue":l[0]||(l[0]=t=>o(r).model=t),location:"top end",variant:"flat",color:o(r).type},{default:a(()=>[d(x(o(r).message),1)]),_:1},8,["modelValue","color"]),e(B,null,{default:a(()=>[e(C,{cols:"12",sm:"12",lg:"12"},{default:a(()=>[e(N,null,{default:a(()=>[e(L,{class:"pt-4 pl-6"},{default:a(()=>[d("Lista de grupos de paquetes")]),_:1}),e(j,{style:{"margin-bottom":"-2rem"}},{default:a(()=>[i("div",pe,[e(p,{"prepend-icon":"tabler-user-plus",color:"success",variant:"tonal",class:"ml-auto",onClick:Y},{default:a(()=>[d(" Crear grupo ")]),_:1})])]),_:1}),o(P)?(b(),S(G,{key:0},{default:a(()=>[d(" Cargando datos... ")]),_:1})):(b(),S(G,{key:1},{default:a(()=>[e(ne,{class:"text-no-wrap tableNavegacion mb-5"},{default:a(()=>[fe,i("tbody",null,[(b(!0),q(I,null,z(o(W),t=>(b(),q("tr",null,[i("td",ve,x(t._id),1),i("td",ge,x(t.nombre),1),i("td",_e,[e(p,{color:"success",variant:"text",icon:"",onClick:c=>Z(t._id)},{default:a(()=>[e(H,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(p,{icon:"",color:"error",variant:"text",onClick:c=>ae(t._id)},{default:a(()=>[e(H,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),i("div",be,[e(p,{icon:"tabler-arrow-big-left-lines",onClick:X,disabled:o(f)===1},null,8,["disabled"]),d(" P\xE1gina "+x(o(f))+" ",1),e(p,{icon:"tabler-arrow-big-right-lines",onClick:K,disabled:o(f)*k>=o(h).length},null,8,["disabled"])])]),_:1}))]),_:1})]),_:1})]),_:1}),e(M,{modelValue:o(_),"onUpdate:modelValue":l[3]||(l[3]=t=>D(_)?_.value=t:null),persistent:"","max-width":"800"},{default:a(()=>[e(u,{onClick:U}),e(N,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(G,{class:"text-center"},{default:a(()=>[e(L,{class:"text-h5 mb-3"},{default:a(()=>[d(x(o(w)==="add"?"Crear un grupo de paquetes":"Editar "+o(m)),1)]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(re,{class:"mt-6",onSubmit:ue(ee,["prevent"])},{default:a(()=>[e(B,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(B,null,{default:a(()=>[e(C,{cols:"12"},{default:a(()=>[e(ie,{modelValue:o(m),"onUpdate:modelValue":l[1]||(l[1]=t=>D(m)?m.value=t:null),label:"Nombre"},null,8,["modelValue"])]),_:1}),ye,e(de,{class:"my-2"}),e(C,{cols:"12"},{default:a(()=>[(b(!0),q(I,null,z(o(F),t=>(b(),S(C,{style:{"margin-top":"-1.5rem"},cols:"6"},{default:a(()=>[e(me,{modelValue:o(v),"onUpdate:modelValue":l[2]||(l[2]=c=>D(v)?v.value=c:null),label:t.title,value:t.value},null,8,["modelValue","label","value"])]),_:2},1024))),256))]),_:1})]),_:1}),e(C,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(p,{type:"submit"},{default:a(()=>[d(" Guardar ")]),_:1}),e(p,{color:"secondary",variant:"tonal",onClick:U},{default:a(()=>[d(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(M,{modelValue:o(g),"onUpdate:modelValue":l[6]||(l[6]=t=>D(g)?g.value=t:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(u,{onClick:l[4]||(l[4]=t=>g.value=!o(g))}),e(N,{title:"Eliminar registro"},{default:a(()=>[e(j,null,{default:a(()=>[d(" \xBFDesea eliminar el grupo? ")]),_:1}),e(j,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(p,{color:"secondary",variant:"tonal",onClick:l[5]||(l[5]=t=>g.value=!1)},{default:a(()=>[d(" No, Cerrar ")]),_:1}),e(p,{onClick:te},{default:a(()=>[d(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{qe as default};
