import{r as s,as as I,Q as q,o as u,x as b,a,w as e,e as c,g as C,aR as m,q as o,b2 as P,c as f,h as k,aT as Q,b as n,t as V,u as w,bx as N,a3 as g,aM as B,F as U,C as H,V as J}from"./index.88d3c7f5.js";import{getCampaigns as K,getCampaignStatistics as W}from"./useSendPulse.148aa0c9.js";const X=n("strong",null,"Send Date:",-1),Y=n("strong",null,"Permalink:",-1),Z=["href"],$={class:"d-flex gap-3 justify-center align-start flex-column mt-4"},ee=n("span",{class:"text-h5 font-bold"},"Datos de Campa\xF1a",-1),ae={key:1,class:"list-group mb-3"},te={class:"d-flex w-100 justify-content-between"},le={class:"mb-1"},re={__name:"index",setup(se){const x=s([]),h=s(null),p=s(!1),l=s([]),y=s({}),S=s({chart:{type:"donut"},labels:[],legend:{position:"bottom"}}),D=s([]),R=s({chart:{type:"bar",toolbar:{show:!0}},plotOptions:{bar:{horizontal:!1,distributed:!0}},colors:["#FFC107","#4CAF50","#FF5722"],dataLabels:{enabled:!1},xaxis:{categories:["Emails Entregados","Emails Abiertos","Emails No Abiertos"]}}),E=s([{data:[]}]),M=s({chart:{type:"bar",toolbar:{show:!0}},plotOptions:{bar:{horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:[]}}),F=s([{data:[]}]);I(async()=>{p.value=!0;const r=await K();x.value=r,p.value=!1}),q(h,async r=>{if(!r)return;p.value=!0;const i=await W(r);l.value=i.statistics.general,y.value={sendDate:i.send_date,permalink:i.permalink},p.value=!1,j()});function j(){var O,A,T,L,z;const r=((O=l.value.find(t=>t.explain==="Delivered"))==null?void 0:O.count)||0,i=((A=l.value.find(t=>t.explain==="Opened"))==null?void 0:A.count)||0,d=r-i;E.value[0].data=[r,i,d],S.value.labels=["Entregados","Catalogado como spam","Fallo de entrega","No existe email","Mailbox is full"],D.value=[r,l.value.filter(t=>t.explain.includes("Mail server answer")).reduce((t,_)=>t+_.count,0),((T=l.value.find(t=>t.explain==="Delivery failure"))==null?void 0:T.count)||0,((L=l.value.find(t=>t.explain==="Not valid email"))==null?void 0:L.count)||0,((z=l.value.find(t=>t.explain==="Temporary blocked"))==null?void 0:z.count)||0];const v=["Mail server answer :: Rejected by server as spam","Mail server answer :: No such email","Mail server answer :: Mailbox is full","Not valid email","Temporary blocked"];M.value.xaxis.categories=v,F.value[0].data=v.map(t=>{var _;return((_=l.value.find(G=>G.explain===t))==null?void 0:_.count)||0})}return(r,i)=>(u(),b("div",null,[a(J,{class:"align-items-start"},{default:e(()=>[a(c,{sm:"8",cols:"12"},{default:e(()=>[a(C,{class:"mb-3"},{default:e(()=>[a(m,null,{default:e(()=>[o("Datos estad\xEDsticos de Campa\xF1as")]),_:1}),a(P,null,{default:e(()=>[o("Muestra detalles estad\xEDsticos relevantes sobre la campa\xF1a seleccionada")]),_:1}),x.value.length>1?(u(),f(k,{key:0},{default:e(()=>[a(Q,{modelValue:h.value,"onUpdate:modelValue":i[0]||(i[0]=d=>h.value=d),items:x.value,"item-text":"title","item-value":"id",label:"Selecciona una campa\xF1a"},null,8,["modelValue","items"])]),_:1})):(u(),f(k,{key:1},{default:e(()=>[o("Cargando...")]),_:1}))]),_:1}),l.value.length>0?(u(),f(C,{key:0,class:"d-flex flex-wrap"},{default:e(()=>[a(c,{md:"4",cols:"12",class:"mb-3"},{default:e(()=>[a(m,null,{default:e(()=>[o("Resumen")]),_:1}),n("div",null,[n("p",null,[X,o(" "+V(y.value.sendDate),1)]),n("p",null,[Y,o(),n("a",{href:y.value.permalink,target:"_blank"},"Link",8,Z)])])]),_:1}),a(c,{md:"8",cols:"12",class:"mb-3"},{default:e(()=>[a(m,null,{default:e(()=>[o("Gr\xE1fico de entregas de email")]),_:1}),a(w(N),{type:"donut",options:S.value,series:D.value},null,8,["options","series"])]),_:1}),a(c,{md:"6",cols:"12",class:"mb-3"},{default:e(()=>[a(m,null,{default:e(()=>[o("Gr\xE1fico de Aperturas y No Aperturas")]),_:1}),a(w(N),{type:"bar",options:R.value,series:E.value},null,8,["options","series"])]),_:1}),a(c,{md:"6",cols:"12"},{default:e(()=>[a(m,null,{default:e(()=>[o("Errores de Servidor de Correo")]),_:1}),a(w(N),{type:"bar",options:M.value,series:F.value},null,8,["options","series"])]),_:1})]),_:1})):g("",!0)]),_:1}),a(c,{sm:"4",cols:"12"},{default:e(()=>[l.value?(u(),f(C,{key:0},{default:e(()=>[a(k,null,{default:e(()=>[n("div",$,[ee,p.value?(u(),f(B,{key:0,size:"large"},{default:e(()=>[o("Calculando...")]),_:1})):g("",!0),l.value.length>0?(u(),b("div",ae,[(u(!0),b(U,null,H(l.value,(d,v)=>(u(),b("div",{key:v,class:"list-group-item list-group-item-action flex-column align-items-start"},[n("div",te,[n("h5",le,V(d.explain),1),a(B,{size:"small",color:"secondary"},{default:e(()=>[o("#"+V(d.count),1)]),_:2},1024)])]))),128))])):g("",!0)])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]))}};export{re as default};
