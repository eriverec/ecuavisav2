import{R,U as S,r as o,Q as $,v as N,as as q,o as m,x as g,a as l,w as r,e as F,g as I,aR as E,N as C,h as U,b as a,aT as K,n as j,b1 as Q,p as M,q as G,a2 as D,aW as W,F as H,C as J,u as _,t as f,a3 as O,ao as k,ap as A,V as X}from"./index.88d3c7f5.js";import{M as Y}from"./index.50982b4e.js";import{V as Z}from"./VSpacer.2a3e77c9.js";import{V as ee}from"./VPagination.9412c3b8.js";const ae=a("span",{class:"text-primary"},"Ver dispositivos",-1),se=a("span",{class:"text-medium-emphasis"}," de usuarios suscritos",-1),te={class:"me-3 d-flex gap-4"},le=a("div",{class:"app-user-search-filter d-flex align-top"},null,-1),oe=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"Nombre"),a("th",{scope:"col"},"Apellido"),a("th",{scope:"col"},"Email"),a("th",{scope:"col"},"Ver dispositivos")])],-1),ne={key:0},re={class:"text-center",style:{width:"5rem"}},ue=a("tr",null,[a("td",{colspan:"9",class:"text-center"},"No hay datos que mostrar")],-1),ie=[ue],ce=a("tr",null,[a("td",{colspan:"9",class:"text-center"},"Cargando datos, por favor espere un momento...")],-1),de=[ce],pe={class:"text-sm text-disabled"},_e={__name:"index_old",setup(ve){const x=R.exports.extendMoment(Y);x.locale("es",[S]),x.tz.setDefault("America/Guayaquil");const B=o(0),y=o([]),u=o([]),c=o(1),p=o(0),n=o(10),d=o(!1),v=o(!1);o(!1);const h=o(""),L=o({message:"Datos guardados",type:"success",model:!1});async function P(s,t){const e=`https://ecuavisa-suscripciones.vercel.app/suscripciones/all?page=${s}&limit=${t}`,b=await(await fetch(e)).json();return b.resp?b:null}async function T(){d.value=!0;try{let s=[],t=1,e=!0;for(;e;){const i=await P(t,100);i&&i.data&&i.data.length>0?(s=[...s,...i.data],t++):e=!1}y.value=s,u.value=s,B.value=s.length,p.value=Math.ceil(s.length/n.value)}catch(s){console.error("Error al obtener los usuarios:",s),L.value={message:"No se pudo recuperar los usuarios, recargue de nuevo.",type:"error",model:!0}}finally{d.value=!1}}function V(){v.value=!0;const s=h.value.toLowerCase();u.value=y.value.filter(t=>{if(t.user&&t.user.length>0){const e=t.user[0].first_name.toLowerCase(),i=t.user[0].last_name.toLowerCase();return e.includes(s)||i.includes(s)}return!1}),c.value=1,p.value=Math.ceil(u.value.length/n.value),v.value=!1}$(n,()=>{c.value=1,p.value=Math.ceil(u.value.length/n.value)});const z=N(()=>{const s=u.value.length?(c.value-1)*n.value+1:0,t=Math.min(s+n.value-1,u.value.length);return`Mostrando ${s} a ${t} de ${u.value.length} registros`}),w=N(()=>{const s=(c.value-1)*n.value,t=s+n.value;return u.value.slice(s,t)});return q(()=>{T()}),(s,t)=>(m(),g("section",null,[l(X,null,{default:r(()=>[l(F,{cols:"12",sm:"12",lg:"12"},{default:r(()=>[l(I,{style:{padding:"25px"}},{default:r(()=>[l(E,null,{default:r(()=>[l(C,{icon:"tabler-devices",color:"primary",size:"24",class:"me-2"}),ae,se]),_:1}),l(U,{class:"d-flex py-4 gap-4 flex-wrap",style:{"align-items":"flex-start"}},{default:r(()=>[a("div",te,[l(K,{class:"bg-white",modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"]),l(j,{modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),label:"Buscar por nombre o apellido","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":"",onKeyup:Q(V,["enter"]),style:{width:"300px"}},null,8,["modelValue","onKeyup"]),l(M,{color:"primary",loading:v.value,disabled:v.value||d.value,onClick:V},{default:r(()=>[G(" Buscar ")]),_:1},8,["loading","disabled"])]),l(Z),le]),_:1}),l(D),l(W,{class:"text-no-wrap"},{default:r(()=>[oe,d.value?O("",!0):(m(),g("tbody",ne,[(m(!0),g(H,null,J(_(w),e=>(m(),g("tr",{key:e._id,style:{height:"3.75rem"}},[a("td",null,f(e.user&&e.user.length>0?e.user[0].first_name:"N/A"),1),a("td",null,f(e.user&&e.user.length>0?e.user[0].last_name:"N/A"),1),a("td",null,f(e.user&&e.user.length>0?e.user[0].email:"N/A"),1),a("td",re,[l(M,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-suscriptores-userdevice-id",params:{id:e.user&&e.user.length>0?e.user[0].wylexId:"0"}}},{default:r(()=>[l(C,{size:"22",icon:"tabler-devices"})]),_:2},1032,["to"])])]))),128))])),k(a("tfoot",null,ie,512),[[A,!_(w).length&&!d.value]]),k(a("tfoot",null,de,512),[[A,d.value]])]),_:1}),l(D),l(U,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:r(()=>[a("span",pe,f(_(z)),1),l(ee,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=e=>c.value=e),size:"small","total-visible":5,length:p.value},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{_e as default};
