import{r as n,o as U,c as L,w as t,V as h,a,b as f,d as g,u as e,e as c,t as b,i as _,f as y,g as B,h as k,j as F,k as M,l as D,m as q,n as P,p as $,q as E}from"./index.88d3c7f5.js";import{u as x,b as C,m as G,a as J}from"./route-block.4e37cd7f.js";import{r as S}from"./validators.b5f8ddc5.js";const O="/assets/auth-v2-reset-password-illustration-dark.d3746a9f.png",z="/assets/auth-v2-reset-password-illustration-light.435863a4.png";const A={class:"position-relative auth-bg rounded-lg w-100 ma-8 me-0"},H={class:"d-flex align-center justify-center w-100 h-100"},K=f("h5",{class:"text-h5 font-weight-semibold mb-1"}," Restablecer contrase\xF1a \u{1F512} ",-1),Q={__name:"reset-password",setup(W){const r=n({newPassword:"",confirmPassword:""}),R=x(z,O),I=x(J,G),m=n(!1),p=n(!1),V=n(),i=n(""),w=n(!1),d=n(!1),v=n(!1);async function T(){if(r.value.newPassword==r.value.confirmPassword){v.value=!0;var u=window.location.search,s=new URLSearchParams(u),o=s.get("tk");const N=JSON.stringify({password:r.value.newPassword,token:o});await fetch("https://gestores-flax.vercel.app/updatePassword",{method:"PUT",headers:{"Content-Type":"application/json"},body:N}).then(l=>l.json()).then(l=>{if(l.message=="Su contrase\xF1a ha sido modificada")return i.value=l.message,w.value=!0,!0;if(l.error)return d.value=!0,i.value=l.error,!1}).catch(l=>{console.log(l)}),v.value=!1}else d.value=!0,i.value="Las contrase\xF1as deben coincidir"}const j=()=>{var u;(u=V.value)==null||u.validate().then(({valid:s})=>{s&&T()})};return(u,s)=>(U(),L(h,{"no-gutters":"",class:"auth-wrapper"},{default:t(()=>[a(c,{md:"8",class:"d-none d-md-flex"},{default:t(()=>[f("div",A,[f("div",H,[a(g,{"max-width":"400",src:e(R),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),a(g,{class:"auth-footer-mask",src:e(I)},null,8,["src"])])]),_:1}),a(y,{modelValue:e(w),"onUpdate:modelValue":s[0]||(s[0]=o=>_(w)?w.value=o:null),color:"primary",transition:"scale-transition",location:"top center"},{default:t(()=>[f("h3",null,b(e(i)),1)]),_:1},8,["modelValue"]),a(y,{modelValue:e(d),"onUpdate:modelValue":s[1]||(s[1]=o=>_(d)?d.value=o:null),color:"error",transition:"scale-transition",location:"top center"},{default:t(()=>[f("h3",null,b(e(i)),1)]),_:1},8,["modelValue"]),a(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:t(()=>[a(B,{flat:"",width:"500",class:"mt-12 mt-sm-0 pa-4"},{default:t(()=>[a(k,null,{default:t(()=>[a(e(F),{nodes:e(M).app.logo,class:"mb-6"},null,8,["nodes"]),K]),_:1}),a(k,null,{default:t(()=>[a(D,{ref_key:"refVForm",ref:V,onSubmit:q(j,["prevent"])},{default:t(()=>[a(h,null,{default:t(()=>[a(c,{cols:"12"},{default:t(()=>[a(P,{modelValue:e(r).newPassword,"onUpdate:modelValue":s[2]||(s[2]=o=>e(r).newPassword=o),label:"Nueva contrase\xF1a",type:e(m)?"text":"password","append-inner-icon":e(m)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[3]||(s[3]=o=>m.value=!e(m)),rules:[e(S)]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),a(c,{cols:"12"},{default:t(()=>[a(P,{modelValue:e(r).confirmPassword,"onUpdate:modelValue":s[4]||(s[4]=o=>e(r).confirmPassword=o),label:"Confirmar contrase\xF1a",type:e(p)?"text":"password","append-inner-icon":e(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":s[5]||(s[5]=o=>p.value=!e(p)),rules:[e(S)]},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),a(c,{cols:"12"},{default:t(()=>[a($,{block:"",type:"submit",loading:e(v)},{default:t(()=>[E(" Enviar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1}))}};typeof C=="function"&&C(Q);export{Q as default};
