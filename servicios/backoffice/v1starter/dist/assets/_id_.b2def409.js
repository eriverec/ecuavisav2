import{R as z,S as F,U as M,cy as P,r as e,v as q,as as H,o as i,x as g,a as t,w as l,g as v,aR as J,q as p,bR as O,p as h,u as o,i as w,b0 as X,c as m,e as B,b7 as Y,h as D,a3 as c,b as r,t as d,F as G,C as K,X as Q,N as W,V as Z}from"./index.88d3c7f5.js";import{V as ee}from"./VPagination.9412c3b8.js";const ae=r("div",null,"Cargando datos, espere...",-1),se={class:"mb-3"},te={class:"font-weight-medium text-base text-subtitle-2"},le={class:"list_items_registros"},oe=["href"],ne={class:"pt-2"},re=["href"],ie={class:"pt-2"},ue=r("div",null,"No hay datos que mostrar... ",-1),_e={__name:"[id]",setup(ce){z.exports.extendMoment(F).locale("es",[M]);const R=P(),y=e("tab-detalles"),V=e(!0),E=e({_id:"",frecuenciaDesafio:"",frecuenciaValor:"",tituloDesafio:"",descripcionDesafio:"",statusDesafio:"",tituloSticker:"",URLSticker:""});async function S(){const a=await(await fetch(`https://servicio-desafios.vercel.app/desafios/${R.params.id}`)).json();return E.value=a.data,V.value=!1,a[0]}e(""),e("");const k=e([]);e(!1),e(!1),e(!1),e(""),e([]),e(""),e("");const N=e(""),u=e(!1),f=e(1),b=e(9),x=e(0),T=e(0),$=q(()=>Math.ceil(x.value/b.value)),j=n=>{f.value=n,C()},I=n=>{N.value=n,u.value=!0};H(async()=>{S(),C()}),e([]);const U=e(!0),_="https://phpstack-1011861-4362286.cloudwaysapps.com/uploads";async function C(){try{const a=await(await fetch(`https://servicio-niveles-puntuacion.vercel.app/historico/files-list-id/?&page=${f.value}&limit=${b.value}&idRegla=${R.params.id}`)).json();k.value=a.data,x.value=a.total,T.value=a.total,U.value=!1}catch(n){console.error("Error al obtener el historial:",n),U.value=!1}}const L=async()=>{const n=N.value;try{(await fetch("https://servicio-niveles-puntuacion.vercel.app/historico/delete-file/",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ruta_archivo:n})})).ok?(console.log("Imagen eliminada exitosamente"),console.log(n),C()):console.error("Error al eliminar la imagen")}catch(a){console.error("Error en la solicitud:",a)}u.value=!1};return(n,a)=>(i(),g("section",null,[t(X,{modelValue:o(u),"onUpdate:modelValue":a[1]||(a[1]=s=>w(u)?u.value=s:null),"max-width":"500"},{default:l(()=>[t(v,null,{default:l(()=>[t(J,null,{default:l(()=>[p("\xBFEst\xE1s seguro de eliminar el archivo?")]),_:1}),t(O,null,{default:l(()=>[t(h,{text:"",onClick:L},{default:l(()=>[p("S\xED")]),_:1}),t(h,{color:"red darken-1",text:"",onClick:a[0]||(a[0]=s=>u.value=!1)},{default:l(()=>[p("No")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Z,null,{default:l(()=>[o(V)?(i(),m(B,{key:0,class:"",cols:"12",md:"12",lg:"12"},{default:l(()=>[t(Y,{modelValue:o(y),"onUpdate:modelValue":a[2]||(a[2]=s=>w(y)?y.value=s:null),class:"v-tabs-pill"},null,8,["modelValue"]),t(v,{class:""},{default:l(()=>[t(D,null,{default:l(()=>[ae]),_:1})]),_:1})]),_:1})):c("",!0),o(V)?c("",!0):(i(),m(B,{key:1,class:"pt-7",cols:"12",md:"12",lg:"12"},{default:l(()=>[t(h,{class:"my-2",to:{name:"apps-reglasYDesafios-gestorArchivos"}},{default:l(()=>[p(" Regresar al listado ")]),_:1}),r("h2",se,[p("Archivos sobre: "),r("b",null,'"'+d(o(E).tituloDesafio)+'"',1),r("p",te," Un total de "+d(o(T))+" registros ",1)]),r("div",le,[(i(!0),g(G,null,K(o(k),(s,A)=>(i(),m(v,{class:"mb-4 py-2",key:A},{default:l(()=>[t(D,null,{default:l(()=>[s.type=="image"?(i(),g("a",{key:0,href:_+s.url,target:"blank_",class:"d-flex flex-column justify-center align-center rounded me-6"},[t(Q,{size:130,image:_+s.url,class:"items-img"},null,8,["image"]),r("small",ne,"* type: "+d(s.type),1),r("small",null,"* user: "+d(s.idUser),1)],8,oe)):c("",!0),s.type=="video"?(i(),g("a",{key:1,href:_+s.url,target:"blank_",class:"d-flex flex-column justify-center align-center rounded me-6"},[t(W,{size:122,class:"px-1",icon:"mdi-file-video"}),r("small",ie,"* type: "+d(s.type),1),r("small",null,"* user: "+d(s.idUser),1)],8,re)):c("",!0)]),_:2},1024),t(h,{icon:"tabler-trash",block:"",color:"error",class:"rounded-t-0 btn_delete_item",onClick:fe=>I(_+s.url)},null,8,["onClick"])]),_:2},1024))),128))]),o(x)>o(b)?(i(),m(ee,{key:0,modelValue:o(f),"onUpdate:modelValue":[a[3]||(a[3]=s=>w(f)?f.value=s:null),j],size:"small","total-visible":4,length:o($)},null,8,["modelValue","length"])):c("",!0),o(k).length<1?(i(),m(v,{key:1},{default:l(()=>[t(D,null,{default:l(()=>[ue]),_:1})]),_:1})):c("",!0)]),_:1}))]),_:1})]))}};export{_e as default};
