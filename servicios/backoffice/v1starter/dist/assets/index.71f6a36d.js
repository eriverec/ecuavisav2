import{R as at,U as st,r as m,bA as ne,bB as ot,as as lt,v as E,Q as I,ak as it,bP as x,bQ as nt,o as b,x as _,a as s,w as l,q as f,t as p,f as rt,e as M,b7 as Ee,b8 as te,g as X,h as dt,b9 as Pe,ba as re,aQ as G,b as d,aR as P,b2 as de,a2 as ze,bC as j,u as h,a3 as A,V as W,N as L,c as R,bx as ae,Z as he,$ as be,a0 as ge,aT as ct,aW as ut,F as q,C as se,aM as ye,aq as Ie,p as _e,ao as je,ap as Le,a1 as ft}from"./index.88d3c7f5.js";import{M as pt}from"./index.50982b4e.js";import{V as vt}from"./VPagination.9412c3b8.js";const mt={class:"d-flex"},ht={class:"descripcion"},bt={class:"bg-ecuavisa py-4 d-flex gap-4 flex-wrap"},gt={class:"date-picker-wrappe",style:{width:"190px"}},yt={style:{"min-width":"230px",width:"auto"}},_t={key:0,class:"d-none",style:{"min-width":"230px",width:"auto"}},xt={key:1,class:"d-none",style:{"min-width":"230px",width:"auto"}},wt={class:"d-flex flex-wrap py-0 gap-4 align-items-center",style:{"justify-content":"space-between"}},Yt={style:{display:"none"}},St={class:"px-4"},Vt=d("br",null,null,-1),Dt={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Ct={class:"descripcion"},$t=d("br",null,null,-1),Mt={class:"mt-3"},kt={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Tt={class:"descripcion"},At=d("br",null,null,-1),Ft=d("br",null,null,-1),Ot={class:"mt-3"},Et={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Pt={class:"descripcion"},zt={class:"mt-3"},It={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},jt={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Lt={class:"descripcion"},Rt={class:"mt-3"},Ut={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},Ht={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Nt={class:"descripcion"},Bt={class:"mt-3"},Xt={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},Gt=d("div",{class:"loading"},"Cargando informaci\xF3n",-1),Wt={class:"item-limit"},qt=d("label",null,"Mostrar",-1),Zt=d("label",null,"registros",-1),Qt={key:0},Jt=d("thead",{class:"text-uppercase"},[d("tr",null,[d("th",{scope:"col"}," P\xE1gina "),d("th",{scope:"col"}," Secci\xF3n "),d("th",{scope:"col",class:"text-center"}," Tiempo promedio "),d("th",{scope:"col",class:"text-center"}," Visitas "),d("th",{scope:"col"}," Acci\xF3n ")])],-1),Kt={style:{"min-width":"17rem","max-width":"17rem"}},ea={class:"text-center"},ta={class:"text-center"},aa={class:"text-center",style:{width:"5rem"}},sa=d("tr",null,[d("td",{colspan:"8",class:"text-center text-body-1"}," No data available ")],-1),oa=[sa],la={key:1},ia={class:"text-xs text-primary pl-2"},na={class:"espacio-right-2"},ra={key:0},da=["onClick"],ca={class:"list-group"},ha={__name:"index",setup(ua){const g=at.exports.extendMoment(pt);g.tz.setDefault("America/Guayaquil"),g.locale("es",[st]);const ce=a=>g.tz(a,"America/Guayaquil"),oe=m("tab-lista"),S=m([]),z=m([]),Z=m(!0),xe=m([]),Re=m(!1),le=m(1),U=m(15),y=m(!1),Q=ne(),$=m({i:Q.i,f:Q.f,title:"hoy"}),F=m({message:"Datos guardados",type:"success",model:!1}),V=m({i:Q.i,f:Q.f,title:"hoy"}),J=m("Hoy"),w=m("Ayer"),ie=ot(),k=m(Q.limit),O=m("0"),H=m(""),D=m(""),K=m(""),we=m([]),Ye=m([]),Se=m([]),Ve=[{title:"Ordenar ASC por nombre de usuario",value:1},{title:"Ordenar DESC por nombre de usuario",value:2},{title:"Ordenar ASC por fecha de registro",value:3},{title:"Ordenar DESC por fecha de registro",value:4},{title:"Ordenar ASC por tiempo de permanencia",value:5},{title:"Ordenar DESC por tiempo de permanencia",value:6}],Ue=[{title:"Ordenar ASC por nombre de p\xE1gina",value:7},{title:"Ordenar DESC por nombre de p\xE1gina",value:8},{title:"Ordenar ASC por tiempo promedio",value:9},{title:"Ordenar DESC por tiempo promedio",value:10},{title:"Ordenar ASC por visitas",value:11},{title:"Ordenar DESC por visitas",value:12}],N=m({title:U.value,value:U.value}),He=[{title:"10",value:10},{title:"30",value:30},{title:"50",value:50},{title:"100",value:100},{title:"200",value:200}],ue=m(Ve),Ne=m([{title:"Agrupar por p\xE1gina",value:1}]);lt(async()=>{await fe();let a=ne("Ayer");V.value={i:a.i,f:a.f,title:w.value},y.value=!0,await Me({fechai:V.value.i.format("YYYY-MM-DD"),fechaf:V.value.f.format("YYYY-MM-DD")}),y.value=!1});function Be(a){const t=new Set;return a.data.map(e=>e.section).filter(e=>t.has(e)?!1:(t.add(e),!0)).map(e=>e.includes("-1")?{title:"Otros",value:e}:{title:e,value:e})}function Xe(a){const t=a.data.reduce((o,i)=>{const n=i.section,u=o.findIndex(v=>v.section===n);return u===-1?o.push({section:n,total:1,sumSeconds:i.seconds,porcentaje:0,promedio:0}):(o[u].total+=1,o[u].sumSeconds+=i.seconds),o},[]),e=a.data.length;return t.forEach(o=>{o.porcentaje=parseFloat(o.total/e*100).toFixed(2),o.promedio=o.sumSeconds/o.total}),t}function Ge(a){const t=a.data.reduce((o,i)=>{const n=i.subsection,u=o.findIndex(v=>v.subsection===n);return u===-1?o.push({subsection:n,total:1,sumSeconds:i.seconds,porcentaje:0,promedio:0}):(o[u].total+=1,o[u].sumSeconds+=i.seconds),o},[]).reduce((o,i)=>{if(i.subsection){const n={porcentaje:i.porcentaje,promedio:i.promedio,subsection:i.subsection,sumSeconds:i.sumSeconds,total:i.total};o.push(n)}return o},[]),e=t.reduce((o,i)=>o+i.total,0);return t.forEach(o=>{o.porcentaje=parseFloat(o.total/e*100).toFixed(2),o.promedio=o.sumSeconds/o.total}),t}async function fe(a={}){try{const{tipo:e="fecha",section:o="",fechai:i=g().format("YYYY-MM-DD"),fechaf:n=g().format("YYYY-MM-DD"),limit:u=2e3}=a;var t=await fetch(`https://servicio-permanencia.vercel.app/get/section/${i}/${n}?section=${o}&limit=${u}`);const v=await t.json();v.data.forEach(r=>{r.date=g(r.timestamp,"dd/mm/YYYY, HH:mm:ss").format("YYYY-MM-DD")}),S.value=v.data,xe.value=v.data;const c=Be(v);Se.value=Ge(v),Ye.value=Xe(v),e=="fecha"&&(we.value=c,K.value="",H.value="")}catch(e){return F.value={message:"No se pudo recuperar los datos de la secci\xF3n, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},console.error(e.message)}}const pe=E(()=>{const a=(le.value-1)*U.value,t=le.value*U.value;return S.value.slice(a,t)}),We=E(()=>Math.ceil(S.value.length/U.value));function qe(a){a<0&&(a+=24*3600);const t=Math.floor(a/3600),e=Math.floor(a%3600/60),o=a%60;return`${t} horas, ${e} minutos y ${o} segundos`}I(async()=>J.value,async()=>{let a=ne(J.value);$.value={i:a.i,f:a.f,title:J.value},k.value=a.limit,y.value=!0,await fe({limit:10,fechai:$.value.i.format("YYYY-MM-DD"),fechaf:$.value.f.format("YYYY-MM-DD"),tipo:"fecha",limit:k.value}),y.value=!1,D.value=null}),I(async()=>K.value,async()=>{const a=K.value,e=[...new Set(a.map(o=>o.value))].join(", ");y.value=!0,await fe({limit:10,fechai:$.value.i.format("YYYY-MM-DD"),fechaf:$.value.f.format("YYYY-MM-DD"),section:e,limit:k.value,tipo:"section"}),y.value=!1,D.value=null}),I(async()=>w.value,async()=>{let a=ne(w.value);V.value={i:a.i,f:a.f,title:w.value},k.value=a.limit,y.value=!0,await Me({fechai:V.value.i.format("YYYY-MM-DD"),fechaf:V.value.f.format("YYYY-MM-DD")}),y.value=!1,D.value=null});function De(a){switch(a){case 1:return(t,e)=>t.user.first_name>e.user.first_name?1:-1;case 2:return(t,e)=>e.user.first_name>t.user.first_name?1:-1;case 3:return(t,e)=>new Date(t.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"))-new Date(e.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"));case 4:return(t,e)=>new Date(e.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"))-new Date(t.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"));case 5:return(t,e)=>t.seconds-e.seconds;case 6:return(t,e)=>e.seconds-t.seconds;case 7:return(t,e)=>t.title>e.title?1:-1;case 8:return(t,e)=>e.title>t.title?1:-1;case 9:return(t,e)=>t.promedio-e.promedio;case 10:return(t,e)=>e.promedio-t.promedio;case 11:return(t,e)=>t.total-e.total;case 12:return(t,e)=>e.total-t.total;default:return null}}I(async()=>H.value,async()=>{const a=S.value;if(H.value){const e=H.value.value,o=[...a].sort(De(e));S.value=o}else{D.value=null;const t=[...a].sort(De(4));S.value=t}});const Ze=a=>{const t={};return a.filter(e=>{const o=e.date;return t[o]?(t[o]++,!1):(t[o]=1,!0)}).map(e=>({date:e.date,total:t[e.date]}))};function Qe(a){const t=Array.from(S.value);switch(a){case 1:return t.reduce((i,n)=>{const u=i.findIndex(v=>v.title===n.title);return u===-1?i.push({title:n.title,promedio:n.seconds,section:n.section,total:1,url:n.url,sumSeconds:n.seconds,data:[n]}):(i[u].promedio=(i[u].promedio*i[u].data.length+n.seconds)/(i[u].data.length+1),i[u].sumSeconds+=n.seconds,i[u].data.push(n),i[u].total+=1),i},[]);case 2:const o=t.reduce((i,n)=>{const u=i.findIndex(v=>v.section===n.section);return u===-1?i.push({title:n.title,date:n.date,promedio:n.seconds,section:n.section,total:1,url:n.url,sumSeconds:n.seconds,data:[n]}):(i[u].promedio=(i[u].promedio*i[u].data.length+n.seconds)/(i[u].data.length+1),i[u].sumSeconds+=n.seconds,i[u].data.push(n),i[u].total+=1),i},[]);return o.forEach(i=>{i.data&&(i.data.sort((n,u)=>{const v=new Date(n.date),c=new Date(u.date);return v-c}),i.data=Ze(i.data))}),o;default:return null}}I(async()=>D.value,async()=>{if(D.value,D.value){const t=D.value.value,e=Qe(t);S.value=e,ue.value=Ue}else S.value=xe.value,ue.value=Ve});const Je=a=>{const t=`rgba(${x(a.colors["on-surface"])},${a.variables["medium-emphasis-opacity"]})`,e=`rgba(${x(a.colors["on-surface"])},${a.variables["disabled-opacity"]})`,o=`rgba(${x(String(a.variables["border-color"]))},${a.variables["border-opacity"]})`,i=`rgba(${x(a.colors["on-surface"])},${a.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:t,themeDisabledTextColor:e,themeBorderColor:o,themePrimaryTextColor:i}},C=it(),{themeBorderColor:fa,themeDisabledTextColor:Ke}=Je(C.current.value);function ve(a){if(typeof a!="number"||isNaN(a))return"El valor no es un n\xFAmero v\xE1lido.";if(a<0)return console.log(a),"El valor no es un n\xFAmero v\xE1lido.";let t,e;return a<60?(t=a,e="segundos"):a<3600?(t=a/60,e="minutos"):(t=a/3600,e="horas"),`${parseInt(t)} ${e}`}const Ce=E(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let i=Array.from(Ye.value);const n={name:"Device",data:[]},u=[];for(let c in i){let r=parseFloat(i[c].porcentaje);n.data.push(r),u.push(i[c].section)}const v={chart:{parentHeightOffset:0,type:"donut",events:{dataPointSelection:function(c,r,Y){}}},labels:u,colors:["#7365ed","#9d92f2","#ff7f50","#EE2E31","#ff6347","#00fa9a","#ffa500","#1D7874","#ff4500","#32cd32","#ff1493","#00fa9a","#ff69b4","#9932cc","#ff8c00","#8b008b","#8a2be2"],stroke:{width:0},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:T}){const ee=T.config.series[r];return ee>5?`${ee}%`:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"11px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:"bold",colors:void 0},background:{enabled:!0,foreColor:"#fff",padding:4,borderRadius:2,borderWidth:1,borderColor:"#fff",opacity:1,dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},legend:{position:"bottom",horizontalAlign:"center",offsetX:0,markers:{width:7,height:7},show:!0,formatter:function(c,r){return[c," <br> ",`<div style="margin-top:10px;font-size:17px;color:rgba(var(--v-theme-on-background),var(--v-high-emphasis-opacity))">${r.w.globals.series[r.seriesIndex]}%<small style="font-size:14px"></small></div>`]},labels:{colors:Ke,useSeriesColors:!1}},tooltip:{theme:!1,custom:function({series:c,seriesIndex:r,dataPointIndex:Y,w:T}){return`<div class="tooltip-content">
          <div class="tooltip-body">
            <div class="tooltip-title">
              Permanencia de ${$.value.title}<br>
              <small>Muestra de ${k.value} registros</small>
            </div>
            <div class="tooltip-subtitle">
              Secci\xF3n
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                ${T.config.labels[r]}
              </div>
              <div class="tooltip-data-value">
                ${c[r]}%
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Visitas
              </div>
              <div class="tooltip-data-value">
                ${i[r].total}
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Tiempo promedio
              </div>
              <div class="tooltip-data-value">
                ${ve(i[r].promedio)} 
              </div>
            </div>
          </div>
        </div>`}},grid:{padding:{top:15,right:-20,left:-20}},states:{hover:{filter:{type:"none"}}},plotOptions:{pie:{donut:{size:"60%",labels:{show:!1,value:{fontSize:"1.375rem",fontFamily:"Public Sans",color:o,fontWeight:600,offsetY:-15,formatter(c){return`${parseInt(c)}%`}},name:{offsetY:20,fontFamily:"Public Sans"},total:{show:!1,showAlways:!1,color:a.success,fontSize:".8125rem",label:"Total",fontFamily:"Public Sans",formatter(){return"184"}}}}}}};return{series:n.data,options:v}}),$e=E(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let i=Array.from(Se.value);const n={name:"Device",data:[]},u=[];for(let c in i){let r=parseFloat(i[c].porcentaje);n.data.push(r),u.push(i[c].subsection)}const v={chart:{parentHeightOffset:0,type:"donut"},labels:u,colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],stroke:{width:0},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:T}){const ee=T.config.series[r];return ee>5?`${ee}%`:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"11px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:"bold",colors:void 0},background:{enabled:!0,foreColor:"#fff",padding:4,borderRadius:2,borderWidth:1,borderColor:"#fff",opacity:1,dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},legend:{position:"bottom",horizontalAlign:"center",offsetX:0,markers:{width:7,height:7},show:!0,formatter:function(c,r){return[c," <br> ",`<div style="margin-top:10px;font-size:17px;color:rgba(var(--v-theme-on-background),var(--v-high-emphasis-opacity))">${r.w.globals.series[r.seriesIndex]}%<small style="font-size:14px"></small></div>`]},labels:{colors:o,useSeriesColors:!1}},tooltip:{theme:!1,custom:function({series:c,seriesIndex:r,dataPointIndex:Y,w:T}){return`<div class="tooltip-content">
          <div class="tooltip-body">
            <div class="tooltip-title">
              Permanencia de ${$.value.title}<br>
              <small>Muestra de ${k.value} registros</small>
            </div>
            <div class="tooltip-subtitle">
              Secci\xF3n
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                ${T.config.labels[r]}
              </div>
              <div class="tooltip-data-value">
                ${c[r]}%
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Visitas
              </div>
              <div class="tooltip-data-value">
                ${i[r].total}
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Tiempo promedio
              </div>
              <div class="tooltip-data-value">
                ${ve(i[r].promedio)} 
              </div>
            </div>
          </div>
        </div>`}},grid:{padding:{top:15,right:-20,left:-20}},states:{hover:{filter:{type:"none"}}},plotOptions:{pie:{donut:{size:"60%",labels:{show:!1,value:{fontSize:"1.375rem",fontFamily:"Public Sans",color:o,fontWeight:600,offsetY:-15,formatter(c){return`${parseInt(c)}%`}},name:{offsetY:20,fontFamily:"Public Sans"},total:{show:!1,showAlways:!1,color:a.success,fontSize:".8125rem",label:"Total",fontFamily:"Public Sans",formatter(){return"184"}}}}}}};return{series:n.data,options:v}});I(async()=>N.value,async()=>{if(N.value,N.value){const a=N.value.value;U.value=a}}),I(async()=>O.value,async()=>{console.log(O.value)});async function Me(a={}){try{Z.value=!0;const{fechai:e=g().format("YYYY-MM-DD"),fechaf:o=g().format("YYYY-MM-DD")}=a;var t=await fetch(`https://servicio-permanencia.vercel.app/chart/agrupacion/dias?fechai=${e}&?fechaf=${o}`);const i=await t.json();i.resp&&(z.value=i.data,Z.value=!1)}catch(e){return F.value={message:"No se pudo recuperar los datos del gr\xE1fico por d\xEDa, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0},console.error(e.message)}}function me(){return g().add(1,"day").format("YYYY-MM-DD")}const ke=E(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let i=Array.from(z.value);const n={};i.forEach(c=>{c.data.forEach(r=>{n[r.section]||(n[r.section]={name:r.section,data:[]}),n[r.section].data.push([g(c.fecha).add(1,"days").valueOf(),r.totalVistas])})});const u=Object.values(n);w.value=="Hoy"&&u.forEach(c=>{const r=me();c.data.push([g(r).valueOf(),0])});const v={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Visitas",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return c.toFixed(0)}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return ce(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:v}}),Te=E(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let i=Array.from(z.value);const n={};i.forEach(c=>{c.data.forEach(r=>{n[r.section]||(n[r.section]={name:r.section,data:[]}),n[r.section].data.push([g(c.fecha).add(1,"days").valueOf(),parseFloat((r.promedioSegundos/60).toFixed(2))])})});const u=Object.values(n);w.value=="Hoy"&&u.forEach(c=>{const r=me();c.data.push([g(r).valueOf(),0])});const v={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:T}){return`${c} min`}},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Tiempo promedio en minutos",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return`${c.toFixed(2)} min`}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return ce(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:v}}),Ae=E(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let i=Array.from(z.value);const n={};i.forEach(c=>{c.data.forEach(r=>{const Y=g(c.fecha).add(1,"days").valueOf();n[Y]||(n[Y]=0),n[Y]+=r.totalVistas})});const u=[{name:"Total de visitas",data:Object.entries(n).map(([c,r])=>[parseInt(c),r])}];w.value=="Hoy"&&u.forEach(c=>{const r=me();c.data.push([g(r).valueOf(),0])});const v={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:T}){return`${c} visitas`}},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Visitas totales",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return`${c.toFixed(0)} visitas`}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return ce(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:v}}),Fe=m([]);fetch("https://servicio-permanencia.vercel.app/get/document/2024-01-12/2024-01-12").then(a=>a.json()).then(a=>{Fe.value=a.data}).catch(a=>{F.value={message:"No se pudo recuperar los datos, por favor intente nuevamente.",type:"error",timeout:4e3,model:!0}});const et=E(()=>{const a={"0 a 30 segundos":{total:0,urls:{}},"30 segundos a 1 minuto":{total:0,urls:{}},"1 a 5 minutos":{total:0,urls:{}},"5 a 10 minutos":{total:0,urls:{}},"10 a 30 minutos":{total:0,urls:{}},"30 minutos en adelante":{total:0,urls:{}}};return Fe.value.forEach(t=>{let e;const o=t.seconds;o<=30?e="0 a 30 segundos":o<=60?e="30 segundos a 1 minuto":o<=300?e="1 a 5 minutos":o<=600?e="5 a 10 minutos":o<=1800?e="10 a 30 minutos":e="30 minutos en adelante",a[e].urls[t.url]||(a[e].urls[t.url]=[]),a[e].urls[t.url].push(t),a[e].total++}),a}),B=nt({}),Oe=a=>{B[a]===void 0?B[a]=!0:B[a]=!B[a]};return(a,t)=>(b(),_("section",null,[s(rt,{modelValue:F.value.model,"onUpdate:modelValue":t[0]||(t[0]=e=>F.value.model=e),location:"top end",variant:"flat",timeout:F.value.timeout||2e3,color:F.value.type},{default:l(()=>[f(p(F.value.message),1)]),_:1},8,["modelValue","timeout","color"]),s(W,null,{default:l(()=>[s(M,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:l(()=>[s(Ee,{modelValue:oe.value,"onUpdate:modelValue":t[1]||(t[1]=e=>oe.value=e),class:"v-tabs-pill d-none"},{default:l(()=>[s(te,{value:"tab-lista",class:""},{default:l(()=>[f(" Listado ")]),_:1}),s(te,{value:"tab-agregar",class:""},{default:l(()=>[f(" Estad\xEDsticas ")]),_:1})]),_:1},8,["modelValue"]),s(X,{class:"mt-5"},{default:l(()=>[s(dt,null,{default:l(()=>[s(Pe,{modelValue:oe.value,"onUpdate:modelValue":t[13]||(t[13]=e=>oe.value=e)},{default:l(()=>[s(re,{value:"tab-lista"},{default:l(()=>[s(G,{class:"header_card_item px-3"},{append:l(()=>[]),default:l(()=>[d("div",mt,[d("div",ht,[s(P,{class:"pb-2"},{default:l(()=>[f("Permanencia de usuarios, "+p($.value.title),1)]),_:1}),s(de,null,{default:l(()=>[f("*Muestra el tiempo que ha permanecido un usuario registrado en las p\xE1ginas de ecuavisa.com.")]),_:1}),s(de,null,{default:l(()=>[f("*Mostrando data desde, "+p($.value.i.format("YYYY-MM-DD"))+" hasta "+p($.value.f.format("YYYY-MM-DD")),1)]),_:1}),s(de,null,{default:l(()=>[f("*Este informe se basa en una muestra de "+p(k.value)+" registros",1)]),_:1})])]),s(ze,{class:"my-5"}),d("div",bt,[d("div",gt,[s(j,{disabled:y.value,modelValue:J.value,"onUpdate:modelValue":t[2]||(t[2]=e=>J.value=e),items:h(ie),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])]),d("div",yt,[s(j,{clearable:"",multiple:"",density:"compact",disabled:y.value,modelValue:K.value,"onUpdate:modelValue":t[3]||(t[3]=e=>K.value=e),items:we.value,variant:"outlined",label:"Seleccionar secciones","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])]),O.value!=0?(b(),_("div",_t,[s(j,{clearable:"",density:"compact",disabled:y.value,modelValue:H.value,"onUpdate:modelValue":t[4]||(t[4]=e=>H.value=e),items:ue.value,variant:"outlined",label:"Ordenar registros","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])):A("",!0),O.value!=0?(b(),_("div",xt,[s(j,{clearable:"",density:"compact",disabled:y.value,modelValue:D.value,"onUpdate:modelValue":t[5]||(t[5]=e=>D.value=e),items:Ne.value,variant:"outlined",label:"Agrupar registros","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])):A("",!0)])]),_:1}),d("div",wt,[d("div",Yt,[s(P,null,{default:l(()=>[f(" Permanencia de usuarios del d\xEDa de hoy ")]),_:1}),s(de,null,{default:l(()=>[f("Muestra el tiempo que ha permanecido un usuario registrado en las p\xE1ginas de ecuavisa.com ")]),_:1})])]),d("div",St,[s(W,null,{default:l(()=>[s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[s(Ee,{modelValue:O.value,"onUpdate:modelValue":t[6]||(t[6]=e=>O.value=e),class:"v-tabs-pill"},{default:l(()=>[s(te,{key:"0",value:"0"},{default:l(()=>[s(L,{start:"",icon:"mdi-chart-scatterplot-hexbin"}),f(" Estadisticas ")]),_:1}),s(te,{class:"d-none",key:"1",value:"1"},{default:l(()=>[s(L,{start:"",icon:"mdi-format-list-bulleted"}),f(" Lista ")]),_:1}),s(te,{key:"2",value:"2"},{default:l(()=>[s(L,{start:"",icon:"mdi-clock-time-eight-outline"}),f(" Agrupaci\xF3n por tiempo ")]),_:1})]),_:1},8,["modelValue"]),Vt,s(Pe,{modelValue:O.value,"onUpdate:modelValue":t[12]||(t[12]=e=>O.value=e)},{default:l(()=>[s(re,{key:"0",value:"0"},{default:l(()=>[z.value.length>0&&Z.value==!1?(b(),R(W,{key:0},{default:l(()=>[s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[s(X,{class:"px-0 py-0 pb-4 v-card--flat mb-4 v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:l(()=>[s(G,{class:"header_card_item pb-0"},{default:l(()=>[d("div",Dt,[d("div",Ct,[s(P,null,{default:l(()=>[f("Tiempo de permanencia"),$t,f(" por secci\xF3n")]),_:1}),d("small",Mt,"Este informe se basa en una muestra de "+p(k.value)+" registros",1)])])]),_:1}),s(h(ae),{options:h(Ce).options,series:h(Ce).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[s(X,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:l(()=>[s(G,{class:"header_card_item pb-0"},{default:l(()=>[d("div",kt,[d("div",Tt,[s(P,null,{default:l(()=>[f("Tiempo de permanencia "),At,f("por subsecci\xF3n"),Ft]),_:1}),d("small",Ot,"Este informe se basa en una muestra de "+p(k.value)+" registros",1)])])]),_:1}),s(h(ae),{options:h($e).options,series:h($e).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(M,{cols:"12",sm:"12",class:"",style:{}},{default:l(()=>[s(X,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:l(()=>[s(G,{class:"header_card_item pb-0"},{append:l(()=>[d("div",It,[s(j,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[7]||(t[7]=e=>w.value=e),items:h(ie),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:l(()=>[d("div",Et,[d("div",Pt,[s(P,null,{default:l(()=>[f("Totales por visitas")]),_:1}),d("small",zt,"Mostrando data desde, "+p(V.value.i.format("YYYY-MM-DD"))+" hasta "+p(V.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(h(ae),{options:h(Ae).options,series:h(Ae).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(M,{cols:"12",sm:"12",class:"",style:{}},{default:l(()=>[s(X,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:l(()=>[s(G,{class:"header_card_item pb-0"},{append:l(()=>[d("div",Ut,[s(j,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[8]||(t[8]=e=>w.value=e),items:h(ie),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:l(()=>[d("div",jt,[d("div",Lt,[s(P,null,{default:l(()=>[f("Visitas por secci\xF3n")]),_:1}),d("small",Rt,"Mostrando data desde, "+p(V.value.i.format("YYYY-MM-DD"))+" hasta "+p(V.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(h(ae),{options:h(ke).options,series:h(ke).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(M,{cols:"12",sm:"12",class:"",style:{}},{default:l(()=>[s(X,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:l(()=>[s(G,{class:"header_card_item pb-0"},{append:l(()=>[d("div",Xt,[s(j,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=e=>w.value=e),items:h(ie),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:l(()=>[d("div",Ht,[d("div",Nt,[s(P,null,{default:l(()=>[f("Tiempo promedio por secci\xF3n")]),_:1}),d("small",Bt,"Mostrando data desde, "+p(V.value.i.format("YYYY-MM-DD"))+" hasta "+p(V.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(h(ae),{options:h(Te).options,series:h(Te).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1})]),_:1})):A("",!0),z.value.length==0&&Z.value==!0?(b(),R(W,{key:1},{default:l(()=>[s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[f(" Cargando gr\xE1ficos... ")]),_:1})]),_:1})):A("",!0),z.value.length<1&&Z.value==!1?(b(),R(W,{key:2},{default:l(()=>[s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[f(" No existen datos que mostrar ")]),_:1})]),_:1})):A("",!0)]),_:1}),s(re,{key:"1",value:"1"},{default:l(()=>[S.value.length<1?(b(),R(he,{key:0,lines:"two",border:""},{default:l(()=>[s(be,null,{default:l(()=>[s(ge,null,{default:l(()=>[Gt]),_:1})]),_:1})]),_:1})):A("",!0),s(W,null,{default:l(()=>[s(M,{cols:"12",sm:"12",class:""},{default:l(()=>[d("div",Wt,[qt,s(ct,{style:{"min-width":"90px"},modelValue:N.value,"onUpdate:modelValue":t[10]||(t[10]=e=>N.value=e),items:He,"item-title":"title","item-value":"value",label:"","persistent-hint":"","return-object":"","single-line":""},null,8,["modelValue"]),Zt]),D.value?(b(),_("div",Qt,[s(ut,{class:"text-no-wrap invoice-list-table"},{default:l(()=>[Jt,d("tbody",null,[(b(!0),_(q,null,se(h(pe),(e,o)=>(b(),_("tr",{key:o,style:{height:"3.75rem"}},[d("td",Kt,[s(P,{title:e.title,style:{"font-size":"18px"}},{default:l(()=>[d("small",null,p(e.title),1)]),_:2},1032,["title"])]),d("td",null,p(e.section),1),d("td",ea,[s(ye,Ie({label:""},{status:"Paid",chip:{color:"success"}},{size:"small"}),{default:l(()=>[f(p(ve(parseInt(e.promedio))),1)]),_:2},1040)]),d("td",ta,[s(ye,Ie({label:""},{status:"Paid",chip:{color:"success"}},{size:"small"}),{default:l(()=>[f(p(e.total)+" visitas ",1)]),_:2},1040)]),d("td",aa,[s(_e,{icon:"",size:"x-small",color:"info",variant:"text",href:e.url,target:"_blank"},{default:l(()=>[s(L,{size:"22",icon:"mdi-link-variant"})]),_:2},1032,["href"])])]))),128))]),je(d("tfoot",null,oa,512),[[Le,!h(pe).length]])]),_:1})])):(b(),_("div",la,[S.value.length>0?(b(),R(he,{key:0,lines:"two",border:""},{default:l(()=>[(b(!0),_(q,null,se(h(pe),(e,o)=>(b(),_(q,{key:o},[s(be,{disabled:Re.value},{append:l(()=>[d("div",na,[s(_e,{icon:"",size:"x-small",color:"info",variant:"text",href:e.url,target:"_blank"},{default:l(()=>[s(L,{size:"22",icon:"mdi-link-variant"})]),_:2},1032,["href"]),s(_e,{icon:"",size:"x-small",color:"info",variant:"text",href:"/apps/user/view/"+e.user.userId,target:"_blank"},{default:l(()=>[s(L,{size:"22",icon:"mdi-account-outline"})]),_:2},1032,["href"])])]),default:l(()=>[s(ge,null,{default:l(()=>[f(p(e.user.first_name||"Not Found")+" "+p(e.user.last_name||"")+" ",1),s(ye,null,{default:l(()=>[f(" estuvo "+p(qe(e.seconds)),1)]),_:2},1024)]),_:2},1024),s(ft,{class:"mt-1",title:"Estado de campa\xF1a"},{default:l(()=>[d("span",ia,[s(L,{icon:"mdi-web"}),f(": "+p(e.title),1)])]),_:2},1024)]),_:2},1032,["disabled"]),o!==S.value.length-1?(b(),R(ze,{key:0})):A("",!0)],64))),128))]),_:1})):A("",!0)])),s(vt,{class:"mt-5",modelValue:le.value,"onUpdate:modelValue":t[11]||(t[11]=e=>le.value=e),length:h(We),"total-visible":7},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),s(re,{key:"2",value:"2"},{default:l(()=>[(b(!0),_(q,null,se(h(et),(e,o)=>(b(),R(he,{lines:"two",border:"",key:o},{default:l(()=>[s(be,null,{default:l(()=>[s(ge,{onClick:i=>Oe(o)},{default:l(()=>[f(p(o)+": "+p(e.total)+" usuario(s) ",1)]),_:2},1032,["onClick"]),B[o]?(b(),_("div",ra,[(b(!0),_(q,null,se(e.urls,(i,n)=>(b(),_("div",{key:n},[d("button",{class:"btn btn-secondary my-2",type:"button",onClick:u=>Oe(n)},p(n)+" ("+p(i.length)+" usuario(s)) ",9,da),je(d("ul",ca,[(b(!0),_(q,null,se(i,u=>(b(),_("li",{class:"list-group-item",key:u.id},p(u.user.first_name)+" - "+p(u.seconds)+" segundos ",1))),128))],512),[[Le,B[n]]])]))),128))])):A("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{ha as default};
