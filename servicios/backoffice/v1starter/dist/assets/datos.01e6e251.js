import{R as U,S as q,U as F,r as d,v as u,as as L,o as n,x as c,a as t,w as s,e as V,g as R,h as S,b as a,t as l,q as r,u as _,X as m,N as h,V as O}from"./index.88d3c7f5.js";import{V as j}from"./VTooltip.2d0a8708.js";const X={class:""},G={key:0},H={key:1},J={key:2},K=a("span",{class:"text-h56"},"Usuarios Suscritos",-1),Q={class:"d-flex align-center gap-2 my-1"},Z=a("label",{class:"text-primary"},"Suscripci\xF3nes activas:",-1),ee={class:"d-flex align-center gap-2 my-1"},ae=a("label",{class:"text-primary"},"Suscripciones Fallidas:",-1),te={class:"d-flex align-center gap-2 my-1"},se=a("label",{class:"text-primary"},"Total Procesados:",-1),oe={key:0},le={key:1},ne={key:2},ce=a("span",{class:"text-h56"},"Registros Semanales",-1),re={class:"d-flex align-center gap-2 my-1"},ie=a("label",{class:"text-primary"},"Semana Actual:",-1),de={class:"d-flex align-center gap-2 my-1"},ue=a("label",{class:"text-primary"},"Semana Anterior:",-1),_e={key:0},fe={key:1},pe={key:2},ve=a("span",{class:"text-h56"},"Reembolsos",-1),me={class:"d-flex align-center gap-2 my-1"},he=a("label",{class:"text-primary"},"Solicitudes:",-1),ge=a("div",{class:"d-flex align-center gap-2 my-1"},[a("label",{class:"text-primary"},"Pendientes:"),r(" 0 ")],-1),ye={class:"d-flex align-center gap-2 my-1"},xe=a("label",{class:"text-primary"},"Completados:",-1),Ve={__name:"datos",setup(be){const i=U.exports.extendMoment(q);i.locale("es",[F]),i.updateLocale("es",{week:{dow:1}});const f=d([]),g=d(!0),v=d(null),D=d(1),y=d(0),z=50,C=async()=>{try{g.value=!0;const e=await fetch(`https://ecuavisa-suscripciones.vercel.app/suscripciones/all?page=${D.value}&limit=${z}`);if(!e.ok)throw new Error("Network response was not ok");const o=await e.json();f.value=[...f.value,...o.data],y.value=o.total,f.value.length<y.value&&(D.value++,await C())}catch(e){v.value=e.message}finally{g.value=!1}},E=u(()=>f.value.filter(e=>e.estado===3).length),M=u(()=>f.value.filter(e=>e.estado!=3).length),A=(e,o=0)=>{const p=i().add(o,"weeks").startOf("isoWeek"),w=i().add(o,"weeks").endOf("isoWeek");return i(e).isBetween(p,w,null,"[]")},Y=(e=0)=>{const o=i().add(e,"weeks").startOf("isoWeek"),p=i().add(e,"weeks").endOf("isoWeek");return`${o.format("D")} al ${p.format("D")} de ${p.format("MMM YYYY")}`},$=u(()=>f.value.filter(e=>e.estado===3&&A(e.created_at)).length),W=u(()=>f.value.filter(e=>e.estado===3&&A(e.created_at,-1)).length),N=u(()=>Y()),B=u(()=>Y(-1)),x=d([]),b=d(!0),k=d(null),I=async()=>{try{b.value=!0;const e="2023-09-01",o=i().format("YYYY-MM-DD"),p=await fetch(`https://ecuavisa-suscripciones.vercel.app/backoffice-grafico/total-reembolsos-por-fecha?fechai=${e}&fechaf=${o}&idPaquete=651c9d012ff9fa09a75e6c16`);if(!p.ok)throw new Error("Error al obtener datos de reembolsos");const w=await p.json();x.value=w.data}catch(e){k.value=e.message}finally{b.value=!1}},P=u(()=>{const e=x.value.find(o=>o.estado===1);return e?e.total:0}),T=u(()=>x.value.reduce((e,o)=>e+o.total,0));return L(()=>{C(),I()}),(e,o)=>(n(),c("div",X,[t(O,null,{default:s(()=>[t(V,{cols:"12",md:"12",lg:"4"},{default:s(()=>[t(R,{style:{height:"150px"}},{default:s(()=>[t(S,{class:"d-flex justify-space-between"},{default:s(()=>[a("div",null,[g.value?(n(),c("p",G,"Cargando...")):v.value?(n(),c("p",H,"Error: "+l(v.value),1)):(n(),c("div",J,[K,a("div",null,[a("div",Q,[Z,r(" "+l(_(E)),1)]),a("div",ee,[ae,r(" "+l(_(M)),1)]),a("div",te,[se,r(" "+l(y.value),1)])])]))]),t(m,{variant:"tonal",color:"success"},{default:s(()=>[t(h,{size:"20",icon:"tabler-user"})]),_:1})]),_:1})]),_:1})]),_:1}),t(V,{cols:"12",md:"12",lg:"4"},{default:s(()=>[t(R,{style:{height:"150px"}},{default:s(()=>[t(S,{class:"d-flex justify-space-between"},{default:s(()=>[a("div",null,[g.value?(n(),c("p",oe,"Cargando...")):v.value?(n(),c("p",le,"Error: "+l(v.value),1)):(n(),c("div",ne,[ce,a("div",null,[a("div",re,[ie,r(" "+l(_($))+" ",1),t(m,{size:"x-small",variant:"tonal",color:"secondary"},{default:s(()=>[t(h,{size:"20",icon:"tabler-info-circle"}),t(j,{activator:"parent",location:"top"},{default:s(()=>[r(l(_(N)),1)]),_:1})]),_:1})]),a("div",de,[ue,r(" "+l(_(W))+" ",1),t(m,{size:"x-small",variant:"tonal",color:"secondary"},{default:s(()=>[t(h,{size:"20",icon:"tabler-info-circle"}),t(j,{activator:"parent",location:"top"},{default:s(()=>[r(l(_(B)),1)]),_:1})]),_:1})])])]))]),t(m,{variant:"tonal",color:"warning"},{default:s(()=>[t(h,{size:"20",icon:"tabler-calendar"})]),_:1})]),_:1})]),_:1})]),_:1}),t(V,{cols:"12",md:"12",lg:"4"},{default:s(()=>[t(R,{style:{height:"150px"}},{default:s(()=>[t(S,{class:"d-flex justify-space-between"},{default:s(()=>[a("div",null,[b.value?(n(),c("p",_e,"Cargando reembolsos...")):k.value?(n(),c("p",fe,"Error: "+l(k.value),1)):(n(),c("div",pe,[ve,a("div",null,[a("div",me,[he,r(" "+l(_(T)),1)]),ge,a("div",ye,[xe,r(" "+l(_(P)),1)])])]))]),t(m,{variant:"tonal",color:"primary"},{default:s(()=>[t(h,{size:"20",icon:"tabler-rotate-2"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{Ve as _};
