import{M as Ae,R as Be,S as Ge,U as qe,r as u,as as He,v as Je,Q as $,z as Qe,o as V,x as O,a as e,w as l,q as c,t as f,u as s,f as We,g as N,i as p,b0 as Q,b as r,h as F,p as m,e as h,b9 as Ye,ba as Ze,aR as xe,b2 as Ke,N as S,c as A,Z as ce,$ as U,a0 as ve,a3 as B,F as W,C as ye,a2 as Y,aQ as Xe,l as el,m as ll,V as Z,n as K,aT as he,aU as Ce,aV as ke,a1 as fe,bc as al,bd as tl,be as ol}from"./index.88d3c7f5.js";import{m as sl}from"./moduloTemplate.7adf9c65.js";import{V as nl}from"./VBadge.0df54a63.js";const X=G=>(tl("data-v-9b53b5b2"),G=G(),ol(),G),il=["title","src"],ul={class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},dl={class:"px-4"},rl=X(()=>r("div",{class:"loading"},null,-1)),cl={class:"nombre-desafio d-flex flex-column"},vl={class:"d-flex"},fl=X(()=>r("small",null,"M\xF3dulo",-1)),ml={class:"text-disabled"},pl={class:"p-0"},_l=X(()=>r("b",null,"_id:",-1)),gl={class:"mr-2"},bl={class:"espacio-right-2"},Vl={class:"d-flex align-center justify-space-between botonescurrentPage"},wl=X(()=>r("span",{class:"ms-4"},"Video",-1)),xl={class:"text-xs text-disabled"},yl={class:"btn-order",style:{}},hl={__name:"index",setup(G){Be.exports.extendMoment(Ge).locale("es",[qe]);const C=u(!1),ee=u(!1),le=u("tab-lista");u(1);const D=u([]),Le=u(1);u(1),u(""),u(!1);const Te=u(!1);u(!1);const z=u(!1),ae=u(null),k=u(null),M=u(!1),q=u(null),R=u(""),E=u([]),P=u([]),H=u(null),te=u(!1),L=u(null),oe=u([]);u("");const je=u(""),me=u("");u(""),u(!0),u(""),u("");const De=u(""),_=u([]),se=u(!1),w=u(null),v=u([]),T=u(null),Me=u(null),ne=u(""),g=u({message:"Datos guardados",type:"success",model:!1}),I=u([]),ie=u([]);He(async()=>{await pe(),await de(),await ue()});async function ue(n=1,t=10){try{x.value=1;var i=new Headers;i.append("Content-Type","application/json");var o={method:"GET",headers:i,redirect:"follow"},a=await fetch("https://servicio-elearning.vercel.app/modulo/all?limit=200&page=1",o);const d=await a.json();D.value=d.data,Le.value=Math.ceil(d.total/d.limit)}catch(d){return console.error(d.message)}}async function pe(n=1,t=10){try{te.value=!0;var i=new Headers;i.append("Content-Type","application/json");var o={method:"GET",headers:i,redirect:"follow"},a=await fetch("https://e-learning-cuestionario.vercel.app/cuestionarios/all/get",o);const d=await a.json();P.value=d.data.reduce((b,y)=>(b.push({title:`${y.titulo}`,value:y._id}),b),[]),oe.value=P.value,te.value=!1}catch(d){return console.error(d.message)}}async function de(n=1,t=10){try{se.value=!0;var i=new Headers;i.append("Content-Type","application/json");var o={method:"GET",headers:i,redirect:"follow"},a=await fetch("https://servicio-elearning.vercel.app/video/all?limit=200&page=1",o);const d=await a.json();I.value=d.data.reduce((b,y)=>(b.push({title:`${y.titulo}`,value:y._id}),b),[]),ie.value=I.value,se.value=!1}catch(d){return console.error(d.message)}}const J=8,x=u(1),Ee=Je(()=>{const n=(x.value-1)*J,t=n+J;return D.value.slice(n,t)}),Ie=()=>{x.value*J<D.value.length&&x.value++},Se=()=>{x.value>1&&x.value--};function re(){ne.value="",w.value="",je.value="",me.value="",T.value="",Me.value="",me.value="",_.value=[],De.value="",v.value=[],E.value=null}function _e(){re(),M.value=!1}async function Ue(){re(),R.value="add",M.value=!0}function ze(n,t){return n.filter(o=>t.includes(o.value)).map(o=>o.value)}function Re(n,t){t.sort((o,a)=>o.posicion-a.posicion);let i=[];for(let o=0;o<t.length;o++){let a=n.find(d=>d===t[o]._id);a&&i.push({title:t[o].titulo,value:a})}return i}async function Pe(n){re(),R.value="edit";const o=(await(await fetch("https://servicio-elearning.vercel.app/modulo/get/"+n)).json()).data;ne.value=o._id,w.value=o.titulo,T.value=o.descripcion,o.cuestionario&&(E.value=o.cuestionario._id),_.value=ze(I.value,o.videos.reduce((a,d)=>(a.push(d._id),a),[])),M.value=!0,v.value=Re(_.value,o.videos)}async function $e(){if(!w.value||!T.value||!_.value)return g.value={message:"Llenar todos los campos para crear el registro",type:"error",model:!0},!1;var n=new Headers;if(n.append("Content-Type","application/json"),R.value==="add"){let o={titulo:w.value,descripcion:T.value,idCuestionario:E.value||null,videos:Ve()};var t=JSON.stringify(o),i={method:"POST",headers:n,body:t,redirect:"follow"};const d=await(await fetch("https://servicio-elearning.vercel.app/modulo/create",i)).json();if(d.resp)g.value={message:"Registro creado correctamente",type:"success",model:!0};else return g.value={message:d.mensaje,type:"error",model:!0},console.error(d.error),!1}else if(R.value==="edit"){let o={titulo:w.value,descripcion:T.value,idCuestionario:E.value||null,videos:Ve()};var t=JSON.stringify(o),i={method:"POST",headers:n,body:t,redirect:"follow"};const y=await(await fetch("https://servicio-elearning.vercel.app/modulo/update/"+ne.value,i)).json();if(y.resp)g.value={message:"Registro actualizado correctamente",type:"success",model:!0};else return g.value={message:y.mensaje,type:"error",model:!0},console.error(y.error),!1}await ue(),M.value=!1}const j=u(!1),ge=u("");function Oe(n){j.value=!0,ge.value=n}function be(){const n=I.value,t=_.value;if(t){if(v.value.length<t.length)for(var i in n)t[t.length-1]==n[i].value&&v.value.push(n[i]);if(v.value.length>t.length){const a=v.value.filter(d=>!t.includes(d.value));for(var o in a)for(var i in v.value)if(a[o].value==v.value[i].value){v.value.splice(i,1);break}}}}$(async()=>_.value,async()=>{_.value&&be()});function Ve(){const n=v.value,t=[];return n.forEach((i,o)=>{t.push({value:i.value,posicion:o})}),t}function we(n,t){const i=v.value,o=i.findIndex(a=>a.value===n);if(o===-1){console.log("El valor especificado no se encontr\xF3 en la lista.");return}if(t==="arriba"&&o>0)[i[o],i[o-1]]=[i[o-1],i[o]];else if(t==="abajo"&&o<i.length-1)[i[o],i[o+1]]=[i[o+1],i[o]];else{console.log("La direcci\xF3n especificada es inv\xE1lida o el elemento est\xE1 en el extremo de la lista.");return}}async function Ne(){ee.value=!0;var n={method:"DELETE",redirect:"follow"};const i=await(await fetch("https://servicio-elearning.vercel.app/modulo/delete/"+ge.value,n)).json();i.resp?g.value={message:"Desaf\xEDo eliminado correctamente",type:"success",model:!0}:g.value={message:i.mensaje,type:"error",model:!0},await ue(),j.value=!1,ee.value=!1}$(async()=>k.value,async()=>{k.value?I.value=ie.value.filter(n=>n.title.toLowerCase().indexOf(k.value.toLowerCase())>-1||n.value.indexOf(k.value)>-1):I.value=ie.value}),$(q,n=>{n||setTimeout(()=>{k.value=""},1e3)}),$(async()=>L.value,async()=>{L.value?P.value=oe.value.filter(n=>n.title.toLowerCase().indexOf(L.value.toLowerCase())>-1||n.value.indexOf(L.value)>-1):P.value=oe.value}),$(H,n=>{n||setTimeout(()=>{L.value=""},1e3)});const Fe=async n=>{n.action=="modal"&&(C.value=n.modalShow),n.action=="add"&&(await de(),C.value=n.modalShow,_.value.push(n.id),be())};return(n,t)=>{const i=al,o=Qe("v-list-item-content");return V(),O("section",null,[e(We,{modelValue:s(g).model,"onUpdate:modelValue":t[0]||(t[0]=a=>s(g).model=a),location:"top end",variant:"flat",timeout:s(g).timeout||2e3,color:s(g).type},{default:l(()=>[c(f(s(g).message),1)]),_:1},8,["modelValue","timeout","color"]),e(Q,{modelValue:s(C),"onUpdate:modelValue":t[2]||(t[2]=a=>p(C)?C.value=a:null),width:"600"},{default:l(()=>[e(i,{onClick:t[1]||(t[1]=a=>C.value=!s(C))}),e(N,null,{default:l(()=>[e(sl,{"onGet:eventModalCR":Fe})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:s(z),"onUpdate:modelValue":t[5]||(t[5]=a=>p(z)?z.value=a:null),width:"500"},{activator:l(({props:a})=>[]),default:l(()=>[e(i,{onClick:t[3]||(t[3]=a=>z.value=!s(z))}),e(N,{title:s(ae).idRudoModel},{default:l(()=>[r("iframe",{class:"mt-3",title:"Video "+s(ae).idRudoModel,width:"100%",height:"300",src:s(ae).urlContent},null,8,il),e(F,{class:"d-flex justify-end"},{default:l(()=>[e(m,{onClick:t[4]||(t[4]=a=>z.value=!1)},{default:l(()=>[c(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),e(Q,{modelValue:s(j),"onUpdate:modelValue":t[8]||(t[8]=a=>p(j)?j.value=a:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[e(i,{onClick:t[6]||(t[6]=a=>j.value=!s(j))}),e(N,{title:"Eliminar registro"},{default:l(()=>[e(F,null,{default:l(()=>[c(" \xBFDesea eliminar el registro? ")]),_:1}),e(F,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[e(m,{color:"secondary",variant:"tonal",onClick:t[7]||(t[7]=a=>j.value=!1)},{default:l(()=>[c(" No, cerrar ")]),_:1}),e(m,{disabled:s(ee),onClick:Ne},{default:l(()=>[c(" Si, eliminar ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,null,{default:l(()=>[e(h,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:l(()=>[e(N,{class:"mt-5"},{default:l(()=>[e(F,null,{default:l(()=>[e(Ye,{modelValue:s(le),"onUpdate:modelValue":t[19]||(t[19]=a=>p(le)?le.value=a:null)},{default:l(()=>[e(Ze,{value:"tab-lista"},{default:l(()=>[r("div",ul,[r("div",null,[e(xe,null,{default:l(()=>[c(" Listado de modulos E-Learning ")]),_:1}),e(Ke,null,{default:l(()=>[c(" Mantenimiento de modulos E-Learning ")]),_:1})])]),r("div",dl,[e(m,{color:"primary",class:"mb-4",onClick:Ue},{default:l(()=>[c(" Crear registro "),e(S,{size:22,icon:"tabler-plus"})]),_:1}),s(D).length<1?(V(),A(ce,{key:0,lines:"two",border:""},{default:l(()=>[e(U,null,{default:l(()=>[e(ve,null,{default:l(()=>[rl]),_:1})]),_:1})]),_:1})):B("",!0),s(D).length>0?(V(),A(ce,{key:1,lines:"two",border:""},{default:l(()=>[(V(!0),O(W,null,ye(s(Ee),(a,d)=>(V(),O(W,{key:d},[e(U,{disabled:s(Te)},{append:l(()=>[r("div",bl,[e(m,{title:"Editar registro",color:"success",variant:"text",icon:"",onClick:b=>Pe(a._id)},{default:l(()=>[e(S,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(m,{title:"Eliminar el registro",icon:"",size:"x-small",color:"error",variant:"text",onClick:b=>Oe(a._id)},{default:l(()=>[e(S,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-elearning-gestion-modulos-view-id",params:{id:a._id}}},{default:l(()=>[e(S,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])])]),default:l(()=>[e(ve,null,{default:l(()=>[r("div",cl,[r("div",vl,[fl,r("small",ml,[r("code",pl,[_l,c(f(a._id),1)])])]),r("label",null,f(a.titulo),1),r("small",gl,f(a.descripcion),1)])]),_:2},1024)]),_:2},1032,["disabled"]),d!==s(D).length-1?(V(),A(Y,{key:0})):B("",!0)],64))),128))]),_:1})):B("",!0),r("div",Vl,[e(m,{icon:"tabler-arrow-big-left-lines",onClick:Se,disabled:s(x)===1},null,8,["disabled"]),c(" P\xE1gina "+f(s(x))+" ",1),e(m,{icon:"tabler-arrow-big-right-lines",onClick:Ie,disabled:s(x)*J>=s(D).length},null,8,["disabled"])])]),e(Q,{modelValue:s(M),"onUpdate:modelValue":t[18]||(t[18]=a=>p(M)?M.value=a:null),persistent:"","no-click-animation":"","max-width":"800"},{default:l(()=>[e(i,{onClick:_e}),e(N,{class:"pa-sm-14 pa-5"},{default:l(()=>[e(Xe,{class:"text-center"},{default:l(()=>[e(xe,{class:"text-h5 mb-3"},{default:l(()=>[c(f(s(R)==="add"||s(R)==="duplicate"?"Crear registro":"Editar: "+s(w)),1)]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(el,{class:"mt-6",onSubmit:ll($e,["prevent"])},{default:l(()=>[e(Z,{class:""},{default:l(()=>[e(Z,null,{default:l(()=>[e(h,{cols:"6"},{default:l(()=>[e(K,{modelValue:s(w),"onUpdate:modelValue":t[9]||(t[9]=a=>p(w)?w.value=a:null),label:"T\xEDtulo del modulo"},null,8,["modelValue"])]),_:1}),e(h,{cols:"6"},{default:l(()=>[e(K,{modelValue:s(T),"onUpdate:modelValue":t[10]||(t[10]=a=>p(T)?T.value=a:null),label:"Descripci\xF3n"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:l(()=>[e(he,{menu:s(H),"onUpdate:menu":t[12]||(t[12]=a=>p(H)?H.value=a:null),"no-data-text":"No existen cuestionario que mostrar","append-icon":"mdi-refresh","item-text":"title","item-value":"value",modelValue:s(E),"onUpdate:modelValue":t[13]||(t[13]=a=>p(E)?E.value=a:null),items:s(P),disabled:s(te),label:"Cuestionario para al final del m\xF3dulo",clearable:"","onClick:append":pe,"menu-props":{maxHeight:"400"}},{"prepend-item":l(()=>[e(U,null,{default:l(()=>[e(o,null,{default:l(()=>[e(K,{modelValue:s(L),"onUpdate:modelValue":t[11]||(t[11]=a=>p(L)?L.value=a:null),clearable:"",placeholder:"Buscar cuestionario"},null,8,["modelValue"])]),_:1})]),_:1}),e(Y,{class:"mt-2"})]),selection:l(({item:a})=>[r("div",null,f(a.title)+" - "+f(a.value),1)]),item:l(({item:a,props:d})=>[e(U,Ce(ke(d)),{default:l(()=>[e(o,null,{default:l(()=>[e(fe,null,{default:l(()=>[r("p",null,"_id: "+f(a.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["menu","modelValue","items","disabled"])]),_:1}),e(h,{cols:"12"},{default:l(()=>[e(Z,null,{default:l(()=>[e(h,{cols:"9"},{default:l(()=>[e(he,{menu:s(q),"onUpdate:menu":t[15]||(t[15]=a=>p(q)?q.value=a:null),"item-text":"title","item-value":"value",modelValue:s(_),"onUpdate:modelValue":t[16]||(t[16]=a=>p(_)?_.value=a:null),items:s(I),chips:"",multiple:"",attach:"",label:"Videos educativos","no-data-text":"No existen videos que mostrar","append-icon":"mdi-refresh","onClick:append":de,disabled:s(se),"menu-props":{maxHeight:"300"}},{"prepend-item":l(()=>[e(U,null,{default:l(()=>[e(o,null,{default:l(()=>[e(K,{modelValue:s(k),"onUpdate:modelValue":t[14]||(t[14]=a=>p(k)?k.value=a:null),clearable:"",placeholder:"Buscar video"},null,8,["modelValue"])]),_:1})]),_:1}),e(Y,{class:"mt-2"})]),selection:l(({item:a})=>[r("div",null,f(a.title)+" - "+f(a.value),1)]),item:l(({item:a,props:d})=>[e(U,Ce(ke(d)),{default:l(()=>[e(o,null,{default:l(()=>[e(fe,null,{default:l(()=>[r("p",null,"_id: "+f(a.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["menu","modelValue","items","disabled"])]),_:1}),e(h,{cols:"3"},{default:l(()=>[e(m,{title:"Agregar m\xF3dulo",block:"",onClick:t[17]||(t[17]=a=>C.value=!0)},{default:l(()=>[c(" Agregar ")]),_:1})]),_:1})]),_:1})]),_:1}),s(_).length>0?(V(),A(h,{key:0,cols:"12"},{default:l(()=>[e(ce,{lines:"two",border:""},{default:l(()=>[(V(!0),O(W,null,ye(s(v),(a,d)=>(V(),O(W,{key:a.value},[e(U,null,{prepend:l(()=>[e(S,{size:35,icon:"mdi-file-video",color:"success"})]),append:l(()=>[r("div",yl,[e(m,{size:"x-small",disabled:d==0,variant:"text",onClick:b=>we(a.value,"arriba")},{default:l(()=>[e(S,{size:25,icon:"mdi-arrow-up-bold-box"})]),_:2},1032,["disabled","onClick"]),e(m,{size:"x-small",disabled:d==s(v).length-1,variant:"text",onClick:b=>we(a.value,"abajo")},{default:l(()=>[e(S,{size:25,icon:"mdi-arrow-down-bold-box"})]),_:2},1032,["disabled","onClick"])])]),default:l(()=>[e(ve,null,{default:l(()=>[c(f(a.title),1)]),_:2},1024),e(fe,{class:"mt-1"},{default:l(()=>[e(nl,{dot:"",location:"start center","offset-x":"2",color:"success",class:"me-3"},{default:l(()=>[wl]),_:1}),r("span",xl,f(a.value),1)]),_:2},1024)]),_:2},1024),d!==s(v).length-1?(V(),A(Y,{key:0})):B("",!0)],64))),128))]),_:1})]),_:1})):B("",!0)]),_:1}),e(h,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(m,{type:"submit"},{default:l(()=>[c(" Guardar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:_e},{default:l(()=>[c(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})])}}},jl=Ae(hl,[["__scopeId","data-v-9b53b5b2"]]);export{jl as default};
