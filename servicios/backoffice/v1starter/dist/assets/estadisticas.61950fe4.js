import{M as w,R as k,S as D,U as S,ak as L,bP as p,o as m,x as f,a as i,w as l,aQ as g,aR as v,q as u,b2 as R,h as V,b as c,p as b,aT as O,g as C,F as _,C as U,t as y,aX as E}from"./index.88d3c7f5.js";import{a as j}from"./apexcharts.common.8ef5f801.js";const T=k.exports.extendMoment(D);T.locale("es",[S]);const B={setup(){const t=L(),e=t.current.value.colors,a=t.current.value.variables,o=`rgba(${p(e.primary)},${a["dragged-opacity"]})`,s=`rgba(${p(e["on-background"])},${a["high-emphasis-opacity"]})`,n=`rgba(${p(String(a["border-color"]))},${a["border-opacity"]})`,d=`rgba(${p(e["on-surface"])},${a["disabled-opacity"]})`;return{vuetifyTheme:t,currentTheme:e,variableTheme:a,labelPrimaryColor:o,legendColor:s,borderColor:n,labelColor:d,columnColors:{series1:"#826af9",series2:"#d2b0ff",bg:"#f8d3ff"}}},data(){return{isLoading:!0,preguntas:[],preguntasData:[],preguntasConCount:[],params:{fechai:"2023-01-01",fechaf:"2023-10-30"},trivias:[],dateRangeModel:null,selectedTrivia:{title:"Trivia: 1",value:1},chartList:[]}},computed:{chartConfigs(){return this.preguntas.map(t=>({chartOptions:{chart:{parentHeightOffset:0,type:"bar",toolbar:{show:!1}},plotOptions:{bar:{columnWidth:"32%",startingShape:"rounded",borderRadius:4,distributed:!0,dataLabels:{position:"center"}}},grid:{show:!0,padding:{top:0,bottom:0,left:-10,right:-10}},colors:[this.columnColors.series2,this.columnColors.series1],dataLabels:{enabled:!0,formatter(e){return`${e}`},offsetY:0,style:{fontSize:"15px",colors:[this.legendColor],fontWeight:"600"}},legend:{show:!0,position:"top",horizontalAlign:"left",labels:{colors:this.labelColor}},tooltip:{enabled:!0},xaxis:{categories:this.preguntasConCount[t].map(e=>e.respuesta),axisBorder:{show:!0,color:this.borderColor},axisTicks:{show:!1},labels:{style:{colors:this.labelColor,fontSize:"14px"}}},yaxis:{labels:{offsetX:-15,formatter(e){return`${parseInt(e/1)}`},style:{fontSize:"14px",colors:this.labelColor},min:0,max:6e4,tickAmount:6}}},series:[{data:this.preguntasConCount[t].map(e=>e.count)}]}))}},methods:{async fetchData(t=""){var e=document.querySelector("#id-card-estadistica");e.classList.add("disabled");var a=this.encodeDataToURL(this.params);const s=await(await fetch("https://showandevents-service.vercel.app/all?"+a)).json();this.preguntas=[],this.preguntasConCount=[],this.preguntasData=[],s.data.forEach(n=>{n.data.forEach(d=>{d.trivia.forEach(r=>{if(this.preguntas.includes(r.pregunta)){const h=this.preguntasConCount[r.pregunta].find(x=>x.respuesta===r.respuesta);h!==void 0?h.count++:this.preguntasConCount[r.pregunta].push({respuesta:r.respuesta,count:1})}else this.preguntas.push(r.pregunta),this.preguntasData.push(d),this.preguntasConCount[r.pregunta]=[{respuesta:r.respuesta,count:1}]})})}),this.isLoading=!1},createChart(t,e){t.chartOptions.chart.height=350;var a=[{name:"Num de usuarios que respondieron",data:t.series[0].data}];t.chartOptions.series=a;const o=new j(e,t.chartOptions);this.chartList.push(o),o.render();var s=document.querySelector("#id-card-estadistica");s.classList.remove("disabled")},initChart(){for(var t in this.chartList){const e=this.chartList[t];e&&e.destroy()}if(this.chartConfigs.length>0){const e=this.$refs.chart;for(let a=0;a<e.length;a++)this.createChart(this.chartConfigs[a],e[a])}},async getListTrivia(){var t=this.encodeDataToURL(this.params);const a=await(await fetch("https://showandevents-service.vercel.app/group?"+t)).json();this.itemsIdTrivias=[],a.resp&&(this.trivias=a.data.map(o=>({title:"Trivia: "+o._id,value:o._id})))},generateURL(){const t=this.encodeDataToURL(this.params);this.url=`https://example.com?${t}`},encodeDataToURL(t){return Object.keys(t).map(e=>`${e}=${encodeURIComponent(t[e])}`).join("&")},async clearSelection(){this.selectedTrivia=null,this.params={fechai:"2023-01-01",fechaf:"2023-10-30"},this.preguntas=[],await this.fetchData(),this.initChart()},async btn_filter(){this.params.idTrivia=this.selectedTrivia,await this.fetchData(),this.initChart()},onChangeRange(t,e,a){console.log("Selected country:",t)},async accionBackoffice(){let t=T().format("DD/MM/YYYY HH:mm:ss").toString(),e=JSON.parse(localStorage.getItem("userData"));if(e.email!=="admin@demo.com"){var a=new Headers;a.append("Content-Type","application/json");var o=JSON.stringify({usuario:e.email,pagina:"concursos-clickclickboom-estadisticas",fecha:t}),s={method:"POST",headers:a,body:o,redirect:"follow"};await fetch("https://servicio-logs.vercel.app/accion",s).then(n=>{}).catch(n=>console.log("error",n))}}},async mounted(){this.getListTrivia(),this.params.idTrivia=this.selectedTrivia.value,await this.fetchData(),this.initChart()}},M={class:"me-3"},N={class:"d-flex align-center flex-wrap gap-2"},Y={class:"d-flex align-center flex-wrap gap-2"},$={class:"date-picker-wrapper",style:{width:"233px"}},q={id:"id-card-estadistica"},F={key:0,class:"mt-6"};function I(t,e,a,o,s,n){const d=E;return m(),f(_,null,[i(C,{class:"mt-6"},{default:l(()=>[i(g,{class:"pb-sm-0"},{default:l(()=>[i(v,null,{default:l(()=>[u("Estad\xEDsticas")]),_:1}),i(R,null,{default:l(()=>[u("De usuarios que se inscribieron de los \xFAltimos 7 d\xEDas")]),_:1})]),_:1}),i(V,{class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},{default:l(()=>[c("div",M,[i(b,{color:"secondary",onClick:n.clearSelection,disabled:s.selectedTrivia==null},{default:l(()=>[u(" Reiniciar ")]),_:1},8,["onClick","disabled"])]),c("div",N,[i(O,{style:{width:"190px"},modelValue:s.selectedTrivia,"onUpdate:modelValue":e[0]||(e[0]=r=>s.selectedTrivia=r),items:s.trivias,label:"Trivias",clearable:"","clear-icon":"tabler-x",searchable:!0},null,8,["modelValue","items"]),i(b,{variant:"tonal",color:"success","prepend-icon":"tabler-search",onClick:n.btn_filter},{default:l(()=>[u(" Buscar ")]),_:1},8,["onClick"])]),c("div",Y,[c("div",$,[i(d,{style:{display:"none"},disabled:"true",id:"date-picker",placeholder:"Seleccionar una fecha","prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:s.dateRangeModel,"onUpdate:modelValue":e[1]||(e[1]=r=>s.dateRangeModel=r),onOnChange:n.onChangeRange,config:{position:"left",mode:"range",altFormat:"F j, Y",dateFormat:"Y-m-d",maxDate:new Date}},null,8,["modelValue","onOnChange","config"])])])]),_:1})]),_:1}),c("div",q,[s.isLoading?(m(),f("div",F,"Cargando datos...")):(m(!0),f(_,{key:1},U(s.preguntas,(r,h)=>(m(),f("div",{key:h,class:"mt-6"},[i(C,null,{default:l(()=>[i(g,{class:"pb-sm-0"},{default:l(()=>[i(v,null,{default:l(()=>[c("strong",null,[c("small",null,"Trivia #00"+y(s.preguntasData[h].idTrivia),1)]),u(" - "+y(r),1)]),_:2},1024),c("div",{ref_for:!0,ref:"chart",style:{height:"250px"}},null,512)]),_:2},1024)]),_:2},1024)]))),128))])],64)}const A=w(B,[["render",I]]);export{A as default};
