import{r as u,as as oe,v as ne,o as x,x as J,a as e,w as l,q as n,t as C,u as s,f as ue,e as y,g as U,aR as q,h,b as I,n as E,b1 as re,i as w,p as d,c as P,aQ as B,F as ie,C as de,d as ce,b2 as K,N as z,V as $,l as ve,m as fe,aT as me,b0 as H,bc as pe}from"./index.88d3c7f5.js";const ge={class:"d-flex flex-wrap gap-4 mt-10"},Ve={style:{width:"15rem"}},_e={class:"d-flex justify-space-between flex-wrap pt-8"},be={class:"me-2 mb-2"},ye=I("br",null,null,-1),we={key:1,class:"mt-5 d-flex align-center justify-space-evenly botonescurrentPage"},De={__name:"index",setup(xe){const k=u([]),f=u(""),D=u(!1);async function M(){try{var o=[];let t=1;for(;;){const T=(await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/get/all?page="+t)).json()).data;if(T.length===0)break;o.push(...T),k.value=Array.from(o),t+=1}}catch(t){console.error(t.message)}}async function j(){D.value=!0,await M(),D.value=!1}oe(async()=>{await j()});const N=8,m=u(1);async function A(){if(f.value!=""){D.value=!0;const t=await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/get/nombre/?nombre="+f.value)).json();k.value=t.data,D.value=!1}else f.value="",await j()}async function Q(){f.value!=""&&(f.value="",await j())}const G=ne(()=>{const o=(m.value-1)*N,t=o+N;return k.value.slice(o,t)}),W=()=>{m.value*N<k.value.length&&m.value++},X=()=>{m.value>1&&m.value--},c=u(!1),S=u(""),F=u(""),v=u(""),p=u(""),g=u(""),V=u(""),_=u(""),i=u({message:"Datos guardados",type:"success",model:!1}),Y=[{title:"Desaf\xEDo a la fama",value:"desafio a la fama"}];async function Z(o){c.value=!0,S.value="editar";const a=(await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/"+o)).json()).data;F.value=a._id,v.value=a.nombre,p.value=a.descripcion,g.value=a.etiqueta,V.value=a.urlImagen,_.value=a==null?void 0:a.categoria}async function ee(){S.value="agregar",v.value="",p.value="",g.value="",V.value="",_.value="",c.value=!0}async function ae(){var o=new Headers;if(o.append("Content-Type","application/json"),S.value==="agregar"){let a={nombre:v.value,descripcion:p.value,etiqueta:g.value,urlImagen:V.value,categoria:_.value};var t=JSON.stringify(a),r={method:"POST",headers:o,body:t,redirect:"follow"};const L=await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/insert",r)).json();L.resp?i.value={message:"Detalle de voto creado correctamente",type:"success",model:!0}:i.value={message:L.mensaje,type:"error",model:!0}}else if(S.value==="editar"){let a={id:F.value,nombre:v.value,descripcion:p.value,etiqueta:g.value,urlImagen:V.value,categoria:_.value};var t=JSON.stringify(a),r={method:"PUT",headers:o,body:t,redirect:"follow"};const R=await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/update",r)).json();R.resp?i.value={message:"Detalle de voto editado correctamente",type:"success",model:!0}:i.value={message:R.mensaje,type:"error",model:!0}}c.value=!1,await j()}function le(){c.value=!1,v.value="",p.value="",g.value="",V.value="",_.value=""}const b=u(!1),O=u("");function te(o){b.value=!0,O.value=o}async function se(){var o={method:"DELETE",redirect:"follow"};const r=await(await fetch("https://ecuavisa-servicio-votacion.vercel.app/detalle/delete?id="+O.value,o)).json();r.resp?i.value={message:"Detalle de voto eliminado correctamente",type:"success",model:!0}:i.value={message:r.mensaje,type:"error",model:!0},await j(),b.value=!1}return(o,t)=>{const r=pe;return x(),J("section",null,[e(ue,{modelValue:s(i).model,"onUpdate:modelValue":t[0]||(t[0]=a=>s(i).model=a),location:"top end",variant:"flat",color:s(i).type},{default:l(()=>[n(C(s(i).message),1)]),_:1},8,["modelValue","color"]),e($,null,{default:l(()=>[e(y,{cols:"12",sm:"12",lg:"12"},{default:l(()=>[e(U,null,{default:l(()=>[e(q,{class:"pt-4 pl-6"},{default:l(()=>[n("Lista de detalles de voto")]),_:1}),e(h,null,{default:l(()=>[I("div",ge,[I("div",Ve,[e(E,{onKeyup:re(A,["enter"]),onInput:A,modelValue:s(f),"onUpdate:modelValue":t[1]||(t[1]=a=>w(f)?f.value=a:null),density:"compact",label:"Buscar","prepend-inner-icon":"tabler-search"},null,8,["onKeyup","modelValue"])]),e(d,{onClick:Q},{default:l(()=>[n(" Reiniciar ")]),_:1}),e(d,{"prepend-icon":"tabler-user-plus",color:"success",variant:"tonal",class:"ml-auto",onClick:ee},{default:l(()=>[n(" Agregar participante ")]),_:1})])]),_:1})]),_:1})]),_:1}),s(D)?(x(),P(B,{key:0},{default:l(()=>[n(" Cargando datos... ")]),_:1})):s(k).length===0?(x(),P(B,{key:1},{default:l(()=>[n(" No existen datos para mostrar. ")]),_:1})):(x(!0),J(ie,{key:2},de(s(G),a=>(x(),P(y,{cols:"12",sm:"6",lg:"3"},{default:l(()=>[e(U,null,{default:l(()=>[e(ce,{class:"immm__",width:200,"aspect-ratio":"1/1",src:a.urlImagen,cover:""},null,8,["src"]),e(h,{class:"position-relative"},{default:l(()=>[I("div",_e,[I("div",be,[e(q,{class:"pa-0"},{default:l(()=>[n(C(a.nombre),1)]),_:2},1024),e(K,{class:"text-base pa-0"},{default:l(()=>[n(C(a.descripcion),1)]),_:2},1024),e(K,{class:"text-base pa-0"},{default:l(()=>[n(C(a.etiqueta)+" ",1),ye,n(" Votos: "+C(a.votosTotales),1)]),_:2},1024),e(q,{class:"pa-0"})])])]),_:2},1024),e(h,null,{default:l(()=>[e(d,{class:"mr-3",color:"success",variant:"tonal",icon:"",onClick:T=>Z(a._id)},{default:l(()=>[e(z,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(d,{icon:"",color:"error",variant:"tonal",onClick:T=>te(a._id)},{default:l(()=>[e(z,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),s(D)?(x(),P(B,{key:0})):(x(),J("div",we,[e(d,{icon:"tabler-arrow-big-left-lines",onClick:X,disabled:s(m)===1},null,8,["disabled"]),n(" P\xE1gina "+C(s(m))+" ",1),e(d,{icon:"tabler-arrow-big-right-lines",onClick:W,disabled:s(m)*N>=s(k).length},null,8,["disabled"])])),e(H,{modelValue:s(c),"onUpdate:modelValue":t[8]||(t[8]=a=>w(c)?c.value=a:null),persistent:"","max-width":"600"},{default:l(()=>[e(r,{onClick:t[2]||(t[2]=a=>c.value=!s(c))}),e(U,{class:"pa-sm-14 pa-5"},{default:l(()=>[e(B,{class:"text-center"},{default:l(()=>[e(q,{class:"text-h5 mb-3"},{default:l(()=>[n(C(s(S)==="agregar"?"Agregar un detalle de voto":"Editar "+s(v)),1)]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(ve,{class:"mt-6",onSubmit:fe(ae,["prevent"])},{default:l(()=>[e($,{class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e($,null,{default:l(()=>[e(y,{cols:"6"},{default:l(()=>[e(E,{modelValue:s(v),"onUpdate:modelValue":t[3]||(t[3]=a=>w(v)?v.value=a:null),label:"Nombre"},null,8,["modelValue"])]),_:1}),e(y,{cols:"6"},{default:l(()=>[e(E,{modelValue:s(p),"onUpdate:modelValue":t[4]||(t[4]=a=>w(p)?p.value=a:null),label:"Descripci\xF3n"},null,8,["modelValue"])]),_:1}),e(y,{cols:"5"},{default:l(()=>[e(E,{modelValue:s(g),"onUpdate:modelValue":t[5]||(t[5]=a=>w(g)?g.value=a:null),label:"Etiqueta"},null,8,["modelValue"])]),_:1}),e(y,{cols:"7"},{default:l(()=>[e(me,{modelValue:s(_),"onUpdate:modelValue":t[6]||(t[6]=a=>w(_)?_.value=a:null),label:"Categor\xEDa",items:Y},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(E,{modelValue:s(V),"onUpdate:modelValue":t[7]||(t[7]=a=>w(V)?V.value=a:null),label:"Im\xE1gen"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(d,{type:"submit"},{default:l(()=>[n(" Guardar ")]),_:1}),e(d,{color:"secondary",variant:"tonal",onClick:le},{default:l(()=>[n(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:s(b),"onUpdate:modelValue":t[11]||(t[11]=a=>w(b)?b.value=a:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[e(r,{onClick:t[9]||(t[9]=a=>b.value=!s(b))}),e(U,{title:"Eliminar registro"},{default:l(()=>[e(h,null,{default:l(()=>[n(" \xBFDesea eliminar el registro? ")]),_:1}),e(h,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[e(d,{color:"secondary",variant:"tonal",onClick:t[10]||(t[10]=a=>b.value=!1)},{default:l(()=>[n(" No, Cerrar ")]),_:1}),e(d,{onClick:se},{default:l(()=>[n(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{De as default};
