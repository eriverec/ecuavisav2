import{r as c,as as ne,o as x,x as j,a as e,w as a,f as z,u as o,i as Y,q as r,b as u,aR as A,p,h as C,c as q,aW as ue,F as W,C as de,t as V,aM as re,N as I,b0 as O,g as E,aQ as F,l as Q,m as X,V as S,e as d,n as G,aT as b,c7 as H,bc as fe,aX as ce}from"./index.88d3c7f5.js";const ve={class:"d-flex align-center flex-wrap gap-2"},pe=u("thead",null,[u("tr",null,[u("th",{scope:"col"},"Nombre"),u("th",{scope:"col"},"Dispositivo"),u("th",{scope:"col"},"Browser"),u("th",{scope:"col"},"Os"),u("th",{scope:"col"},"Actividad"),u("th",{scope:"col"},"Fecha"),u("th",{scope:"col"},"Default"),u("th",{scope:"col"},"Acciones")])],-1),me={class:"text-center",style:{width:"5rem"}},Ve=u("span",null,"\xBF Est\xE1 seguro que desea eliminar",-1),be=u("br",null,null,-1),he={__name:"filtrosDispositivos",setup(De){const T=c(!0),U=c([]),s=c({}),n=c({}),D=c({}),h=c(!1),y=c(!1),g=c(!1),v=c(!1),w=c(!1),N=[{title:"Por sesi\xF3n",value:"sesion"},{title:"Por p\xE1ginas vistas",value:"visita"}],$=[{title:"Movil",value:"movil"},{title:"Desktop",value:"desktop"}],P=[{title:"Windows",value:"Windows"},{title:"Mac OS",value:"Mac OS"},{title:"Linux",value:"Linux"},{title:"Android",value:"Android"},{title:"Todos",value:"todos"}],B=[{title:"Chrome",value:"Chrome"},{title:"Safari",value:"Safari"},{title:"Firefox",value:"Firefox"},{title:"Todos",value:"todos"}];async function k(){T.value=!0,await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/all").then(i=>i.json()).then(i=>{U.value=Array.from(i),T.value=!1}).catch(i=>i)}ne(k);async function K(){y.value=!0}async function Z(){v.value=!1,w.value=!1;let t=Array.from(U.value).filter(l=>l.isDefault===!0);if(t.length&&n.value.isDefault===!0){let l=JSON.stringify({id:t[0]._id,isDefault:!1});await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:l}).catch(_=>_)}let f="chartDispositivos",m=JSON.stringify({nombre:n.value.nombre,tipo:f,device:n.value.device,browser:n.value.browser,os:n.value.os,actividad:n.value.actividad,fecha:n.value.fecha,isDefault:n.value.isDefault});await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/add",{method:"POST",headers:{"Content-Type":"application/json"},body:m}).then(l=>l.json()).then(l=>l=="El filtro ya existe"?(v.value=!0,!1):l=="Faltan datos"?(w.value=!0,!1):(y.value=!1,w.value=!1,v.value=!1,k(),!0)).catch(l=>l)}const ee=()=>{n.value={},y.value=!1},R=i=>{i===!1&&(n.value={}),y.value=i},L=c("");async function le(i){await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/id?"+new URLSearchParams({id:i})).then(t=>t.json()).then(t=>{s.value=t,L.value=t.nombre}).catch(t=>t),h.value=!0}async function te(i){v.value=!1;let f=Array.from(U.value).filter(l=>l.isDefault===!0);if(f.length&&s.value.isDefault===!0){let l=JSON.stringify({id:f[0]._id,isDefault:!1});await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:l}).catch(_=>_)}let m;s.value.nombre==L.value?m=JSON.stringify({id:i,device:s.value.device,browser:s.value.browser,os:s.value.os,actividad:s.value.actividad,fecha:s.value.fecha,isDefault:s.value.isDefault}):m=JSON.stringify({id:i,nombre:s.value.nombre,device:s.value.device,browser:s.value.browser,os:s.value.os,actividad:s.value.actividad,fecha:s.value.fecha,isDefault:s.value.isDefault}),await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:m}).then(l=>l.json()).then(l=>l=="El nombre del filtro ya existe"?(v.value=!0,!1):(h.value=!1,v.value=!1,k(),!0)).catch(l=>l)}const ae=()=>{s.value={},h.value=!1},M=i=>{i===!1&&(s.value={}),h.value=i};async function oe(i){g.value=!0,await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/id?"+new URLSearchParams({id:i})).then(t=>t.json()).then(t=>{D.value=t}).catch(t=>t)}async function se(){let i=D.value._id;var t={method:"DELETE",redirect:"follow"};await fetch("https://servicio-filtros.vercel.app/dispositivos/grafico/delete?"+new URLSearchParams({id:i}),t).then(f=>f.json()).then(f=>(g.value=!1,D.value={},k(),!0)).catch(f=>f)}const J=i=>{i===!1&&(D.value={}),g.value=i},ie=()=>{D.value={},g.value=!1};return(i,t)=>{const f=fe,m=ce;return x(),j(W,null,[e(C,null,{default:a(()=>[e(z,{modelValue:o(v),"onUpdate:modelValue":t[0]||(t[0]=l=>Y(v)?v.value=l:null),color:"error",transition:"scale-transition",location:"top center"},{default:a(()=>[r(" El nombre del filtro ya est\xE1 en uso. ")]),_:1},8,["modelValue"]),e(z,{modelValue:o(w),"onUpdate:modelValue":t[1]||(t[1]=l=>Y(w)?w.value=l:null),color:"error",transition:"scale-transition",location:"top center"},{default:a(()=>[r(" Porfavor ingresar todos los datos. ")]),_:1},8,["modelValue"]),u("div",ve,[e(A,null,{default:a(()=>[r("Filtros de dispositivos")]),_:1}),e(p,{"prepend-icon":"tabler-plus",onClick:K},{default:a(()=>[r(" A\xF1adir filtro ")]),_:1})])]),_:1}),o(T)?(x(),q(C,{key:0},{default:a(()=>[r("Cargando datos...")]),_:1})):(x(),q(C,{key:1},{default:a(()=>[e(ue,{class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:a(()=>[pe,u("tbody",null,[(x(!0),j(W,null,de(o(U),l=>(x(),j("tr",null,[u("td",null,V(l.nombre),1),u("td",null,V(l.device),1),u("td",null,V(l.browser),1),u("td",null,V(l.os),1),u("td",null,V(l.actividad),1),u("td",null,V(l.fecha),1),u("td",null,[e(re,{color:l.isDefault==!0?"success":"warning",class:"mr-4"},{default:a(()=>[r(V(l.isDefault==!0?"Default":"No default"),1)]),_:2},1032,["color"])]),u("td",me,[e(p,{icon:"",size:"x-small",color:"default",variant:"text",onClick:_=>le(l._id)},{default:a(()=>[e(I,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(p,{icon:"",size:"x-small",color:"default",variant:"text",onClick:_=>oe(l._id)},{default:a(()=>[e(I,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),e(O,{persistent:"","no-click-animation":"",width:i.$vuetify.display.smAndDown?"auto":700,"model-value":o(h),"onUpdate:modelValue":M},{default:a(()=>[e(f,{onClick:t[2]||(t[2]=l=>M(!1))}),e(E,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(F,{class:"text-center"},{default:a(()=>[e(A,{class:"text-h5 mb-3"},{default:a(()=>[r(" Editar el filtro ")]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(Q,{class:"mt-6",onSubmit:t[11]||(t[11]=X(l=>te(o(s)._id),["prevent"]))},{default:a(()=>[e(S,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(S,null,{default:a(()=>[e(d,{cols:"6"},{default:a(()=>[e(G,{modelValue:o(s).nombre,"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).nombre=l),label:"Nombre"},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(s).device,"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).device=l),label:"Dispositivo",items:$},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(s).browser,"onUpdate:modelValue":t[5]||(t[5]=l=>o(s).browser=l),label:"Browser",items:B},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(s).os,"onUpdate:modelValue":t[6]||(t[6]=l=>o(s).os=l),label:"Os",items:P},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(s).actividad,"onUpdate:modelValue":t[7]||(t[7]=l=>o(s).actividad=l),label:"Actividad",items:N},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(m,{label:"Fecha","prepend-inner-icon":"tabler-calendar",density:"compact","default-value":new Date,modelValue:o(s).fecha,"onUpdate:modelValue":t[8]||(t[8]=l=>o(s).fecha=l),"show-current":"true",onOnChange:t[9]||(t[9]=()=>{}),config:{mode:"range",altFormat:"F j, Y",dateFormat:"m-d-Y",maxDate:new Date,reactive:!0}},null,8,["default-value","modelValue","config"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(H,{modelValue:o(s).isDefault,"onUpdate:modelValue":t[10]||(t[10]=l=>o(s).isDefault=l),density:"compact",label:"Default"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(p,{type:"submit"},{default:a(()=>[r(" Enviar ")]),_:1}),e(p,{color:"secondary",variant:"tonal",onClick:ae},{default:a(()=>[r(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(O,{persistent:"","no-click-animation":"",width:i.$vuetify.display.smAndDown?"auto":700,"model-value":o(y),"onUpdate:modelValue":R},{default:a(()=>[e(f,{onClick:t[12]||(t[12]=l=>R(!1))}),e(E,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(F,{class:"text-center"},{default:a(()=>[e(A,{class:"text-h5 mb-3"},{default:a(()=>[r(" A\xF1adir un filtro ")]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(Q,{class:"mt-6",onSubmit:t[21]||(t[21]=X(l=>Z(),["prevent"]))},{default:a(()=>[e(S,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(S,null,{default:a(()=>[e(d,{cols:"6"},{default:a(()=>[e(G,{modelValue:o(n).nombre,"onUpdate:modelValue":t[13]||(t[13]=l=>o(n).nombre=l),label:"Nombre"},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(n).device,"onUpdate:modelValue":t[14]||(t[14]=l=>o(n).device=l),label:"Dispositivo",items:$},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(n).browser,"onUpdate:modelValue":t[15]||(t[15]=l=>o(n).browser=l),label:"Browser",items:B},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(n).os,"onUpdate:modelValue":t[16]||(t[16]=l=>o(n).os=l),label:"Os",items:P},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(b,{modelValue:o(n).actividad,"onUpdate:modelValue":t[17]||(t[17]=l=>o(n).actividad=l),label:"Actividad",items:N},null,8,["modelValue"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(m,{label:"Fecha","prepend-inner-icon":"tabler-calendar",density:"compact","default-value":new Date,modelValue:o(n).fecha,"onUpdate:modelValue":t[18]||(t[18]=l=>o(n).fecha=l),"show-current":"true",onOnChange:t[19]||(t[19]=()=>{}),config:{mode:"range",altFormat:"F j, Y",dateFormat:"m-d-Y",maxDate:new Date,reactive:!0}},null,8,["default-value","modelValue","config"])]),_:1}),e(d,{cols:"6"},{default:a(()=>[e(H,{modelValue:o(n).isDefault,"onUpdate:modelValue":t[20]||(t[20]=l=>o(n).isDefault=l),density:"compact",label:"Default"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(p,{type:"submit"},{default:a(()=>[r(" Enviar ")]),_:1}),e(p,{color:"secondary",variant:"tonal",onClick:ee},{default:a(()=>[r(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(O,{persistent:"","no-click-animation":"",width:i.$vuetify.display.smAndDown?"auto":600,"model-value":o(g),"onUpdate:modelValue":J},{default:a(()=>[e(f,{onClick:t[22]||(t[22]=l=>J(!1))}),e(E,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(F,{class:"text-center"},{default:a(()=>[e(A,{class:"text-h5 mb-3 p-5"},{default:a(()=>[Ve,be,u("span",null,[r("el filtro "),u("i",null,V(o(D).nombre),1),r(" ?")])]),_:1})]),_:1}),e(F,null,{default:a(()=>[e(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(p,{color:"error",onClick:se},{default:a(()=>[r(" Aceptar ")]),_:1}),e(p,{onClick:ie},{default:a(()=>[r(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])]),_:1}))],64)}}};export{he as default};
