import{M as K,R as Q,S as Z,U as ee,ak as ae,r as n,as as te,v as se,u as r,o as i,x as d,a as c,w as b,q as oe,aR as B,V as re,e as R,i as q,aT as le,b as s,L as A,N as I,bx as L,a3 as N,c as ne,F as ce,C as ie,t as k,aW as ue,bP as v,aX as de,bd as pe,be}from"./index.88d3c7f5.js";const z=p=>(pe("data-v-6e470f2a"),p=p(),be(),p),me={key:0,class:"text-center py-3"},he={key:1},ve={class:"tab-titles parentTabs"},fe={class:"tab-content"},_e={key:0,class:"tab-item"},ye={key:1,class:"tab-item"},ge={key:0,class:"text-center py-5"},Te=z(()=>s("thead",null,[s("tr",null,[s("th",null,"Paquetes"),s("th")])],-1)),Ye=z(()=>s("td",null,"TOTAL",-1)),we={data(){return{selectedTab:0}},methods:{selectTab(p){this.selectedTab=p}}},xe=Object.assign(we,{__name:"baja-suscriptores",setup(p){const u=Q.exports.extendMoment(Z);u.locale("es",[ee]);const E=e=>{const a=`rgba(${v(e.colors["on-surface"])},${e.variables["medium-emphasis-opacity"]})`,l=`rgba(${v(e.colors["on-surface"])},${e.variables["disabled-opacity"]})`,t=`rgba(${v(String(e.variables["border-color"]))},${e.variables["border-opacity"]})`,o=`rgba(${v(e.colors["on-surface"])},${e.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:a,themeDisabledTextColor:l,themeBorderColor:t,themePrimaryTextColor:o}},U=ae(),f=n([]),{themeBorderColor:V,themeDisabledTextColor:M,themeSecondaryTextColor:H}=E(U.current.value),_=n([]),y=n(u().subtract(1,"days").format("DD-MM-YYYY").toString()+" a "+u().format("DD-MM-YYYY").toString()),g=n(!0),T=n({}),Y=n(u().format("YYYY-MM-DD")),w=n(u().subtract(1,"days").format("YYYY-MM-DD")),x=n(null),C=n([]),D=n(0),S=n({chart:{type:"donut"},labels:[],legend:{position:"bottom",markers:{offsetX:-3},labels:{colors:H},itemMargin:{vertical:3,horizontal:10}}}),$=n([]);async function X(){const a=await(await fetch(`https://api-configuracion.vercel.app/web/baja-suscriptores?from=${Y.value}&to=${w.value}`)).json();if(a.status==="ok"){const t=a.resultForChart.mounts,o=Object.keys(t),j=Object.values(t);S.value.labels=o,$.value=j;const P=Object.entries(t).sort((m,h)=>h[1]-m[1]).reduce((m,[h,J])=>({...m,[h]:J}),{});a.value=P,T.value=P,D.value=Object.values(t).reduce((m,h)=>m+h,0)}else console.error("Error en la respuesta de la API")}async function F(){await fetch(`https://api-configuracion.vercel.app/web/baja-suscriptores?from=${Y.value}&to=${w.value}`).then(e=>e.json()).then(e=>{const a=e.resultForChart.mounts,l=Object.entries(a).sort((t,o)=>o[1]-t[1]).reduce((t,[o,j])=>({...t,[o]:j}),{});f.value=l,T.value=l,D.value=Object.values(a).reduce((t,o)=>t+o,0),g.value=!1})}async function W(){const a=await(await fetch("https://ecuavisa-modulos.vercel.app/paquete")).json();a.resp&&a.data&&a.data.length>0?C.value=a.data.map(l=>l.nombre):console.error("Error en la respuesta de la API")}te(async()=>{await F(),await X(),await W()});const G=async e=>{if(e.length>1){_.value=e;let a=Array.from(_.value);Y.value=u(a[0]).format("YYYY-MM-DD"),w.value=u(a[1]).format("YYYY-MM-DD"),await F()}},O=se(()=>{let e;Array.from(_.value).length>0,e=f.value;const l={name:"Total",data:[]};var t=[];return t=Object.keys(e),l.data=Object.values(e),{series:[l],options:{chart:{parentHeightOffset:0,toolbar:{show:!1}},dataLabels:{enabled:!0},plotOptions:{bar:{borderRadius:8,barHeight:"60%",horizontal:!0,distributed:!0}},grid:{borderColor:V,xaxis:{lines:{show:!1}},padding:{top:-10}},yaxis:{labels:{style:{colors:M}}},xaxis:{axisBorder:{show:!1},axisTicks:{color:V},categories:t,labels:{style:{colors:M}}}}}});return(e,a)=>{const l=de;return r(g)?(i(),d("div",me,"Cargando...")):(i(),d("div",he,[c(B,{class:"pt-4 pl-6"},{default:b(()=>[oe("Baja de suscriptores por paquete de suscripci\xF3n")]),_:1}),c(B,{class:"pt-4 pl-6"},{default:b(()=>[c(re,null,{default:b(()=>[c(R,{cols:"4"},{default:b(()=>[c(l,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:r(y),"onUpdate:modelValue":a[0]||(a[0]=t=>q(y)?y.value=t:null),"show-current":"true",onOnChange:G,config:{mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",maxDate:new Date,position:"auto right",reactive:!0}},null,8,["modelValue","config"])]),_:1}),c(R,{cols:"8"},{default:b(()=>[c(le,{style:{width:"100%"},modelValue:r(x),"onUpdate:modelValue":a[1]||(a[1]=t=>q(x)?x.value=t:null),items:r(C),label:"Paquetes"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),s("div",ve,[s("div",{class:A(["",{active:e.selectedTab===0}]),onClick:a[2]||(a[2]=t=>e.selectTab(0))},[c(I,{size:22,icon:"tabler-chart-bar"})],2),s("div",{onClick:a[3]||(a[3]=t=>e.selectTab(1)),class:A({active:e.selectedTab===1})},[c(I,{size:22,icon:"tabler-chart-pie"})],2)]),s("div",fe,[e.selectedTab===0?(i(),d("div",_e,[c(r(L),{type:"bar",height:"500",options:r(O).options,series:r(O).series},null,8,["options","series"])])):N("",!0),e.selectedTab===1?(i(),d("div",ye,[c(r(L),{type:"donut",height:"500",options:r(S),series:r($)},null,8,["options","series"])])):N("",!0)]),r(g)?(i(),d("div",ge,"Cargando...")):(i(),ne(ue,{key:1,hover:"true",class:"text-no-wrap tableNavegacion mx-5 my-5"},{default:b(()=>[Te,s("tbody",null,[(i(!0),d(ce,null,ie(r(T),(t,o)=>(i(),d("tr",{key:o},[s("td",null,k(o),1),s("td",null,k(t),1)]))),128)),s("tr",null,[Ye,s("td",null,k(r(D)),1)])])]),_:1}))]))}}}),je=K(xe,[["__scopeId","data-v-6e470f2a"]]);export{je as default};
