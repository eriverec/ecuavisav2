import{R as da,S as ua,U as pa,bG as va,r as i,I as _a,bH as he,v as fa,z as ha,o as v,x as R,a as s,w as n,F as Ie,C as Te,e as z,g as me,h as W,b as t,t as w,q as c,X as ge,V as Be,aT as we,u as o,i as L,a2 as ye,n as ma,p as C,L as k,a$ as ga,aW as wa,c as m,N as f,d as ya,aM as ba,Y as xa,Z as Ca,$ as Ne,b0 as Aa,aQ as Ze,aR as ka,aX as Va,bc as Ma}from"./index.88d3c7f5.js";import{_ as Ha}from"./AddNewUserDrawer.d14432f5.js";import{a as Ya}from"./formatters.a9a9bf7f.js";import{V as Da}from"./VSpacer.2a3e77c9.js";import{V as La}from"./VTooltip.2d0a8708.js";import{V as Sa}from"./VPagination.9412c3b8.js";import"./validators.b5f8ddc5.js";import"./VNavigationDrawer.44422f4c.js";const Ea={class:"d-flex align-center gap-2 my-1"},Fa=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 256 256"},[t("path",{fill:"currentColor",d:"M245.11 60.68c-7.65-13.19-27.84-16.16-58.5-8.66A95.93 95.93 0 0 0 32 128a98 98 0 0 0 .78 12.31C5.09 169 5.49 186 10.9 195.32C16 204.16 26.64 208 40.64 208a124.11 124.11 0 0 0 28.79-4A95.93 95.93 0 0 0 224 128a97.08 97.08 0 0 0-.77-12.25c12.5-13 20.82-25.35 23.65-35.92c1.95-7.32 1.36-13.76-1.77-19.15ZM128 48a80.11 80.11 0 0 1 78 62.2c-17.06 16.06-40.15 32.53-62.07 45.13c-27.55 15.81-51.45 25.67-70.51 31.07A79.94 79.94 0 0 1 128 48ZM24.74 187.29c-1.46-2.51-.65-7.24 2.22-13a79.05 79.05 0 0 1 10.29-15.05a96 96 0 0 0 18 31.32c-17.25 2.9-28.01 1.05-30.51-3.27ZM128 208a79.45 79.45 0 0 1-38.56-9.94a370 370 0 0 0 62.43-28.86c21.58-12.39 40.68-25.82 56.07-39.08A80.07 80.07 0 0 1 128 208ZM231.42 75.69c-1.7 6.31-6.19 13.53-12.63 21.13a95.69 95.69 0 0 0-18-31.35c14.21-2.35 27.37-2.17 30.5 3.24c.9 1.57.95 3.92.13 6.98Z"})],-1),Ua=t("label",{class:"text-primary"},"Web:",-1),Ia=["hidden"],Ta={class:"d-flex align-center gap-2 my-1"},Ba=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"m17.578 4.432l-2-1.05C13.822 2.461 12.944 2 12 2s-1.822.46-3.578 1.382l-.321.169l8.923 5.099l4.016-2.01c-.646-.732-1.688-1.279-3.462-2.21Zm4.17 3.532l-3.998 2V13a.75.75 0 0 1-1.5 0v-2.287l-3.5 1.75v9.441c.718-.179 1.535-.607 2.828-1.286l2-1.05c2.151-1.129 3.227-1.693 3.825-2.708c.597-1.014.597-2.277.597-4.8v-.117c0-1.893 0-3.076-.252-3.978ZM11.25 21.904v-9.44l-8.998-4.5C2 8.866 2 10.05 2 11.941v.117c0 2.525 0 3.788.597 4.802c.598 1.015 1.674 1.58 3.825 2.709l2 1.049c1.293.679 2.11 1.107 2.828 1.286ZM2.96 6.641l9.04 4.52l3.411-1.705l-8.886-5.078l-.103.054c-1.773.93-2.816 1.477-3.462 2.21Z"})],-1),Na=t("label",{class:"text-primary"},"App:",-1),Za=["hidden"],Pa={class:"d-flex align-center gap-2 my-1"},za=t("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#7367F0",width:"18",height:"18",viewBox:"0 0 26 26"},[t("path",{fill:"currentColor",d:"M12.906-.031a1 1 0 0 0-.125.031A1 1 0 0 0 12 1v1H3a3 3 0 0 0-3 3v13c0 1.656 1.344 3 3 3h9v.375l-5.438 2.719a1.006 1.006 0 0 0 .875 1.812L12 23.625V24a1 1 0 1 0 2 0v-.375l4.563 2.281a1.006 1.006 0 0 0 .875-1.812L14 21.375V21h9c1.656 0 3-1.344 3-3V5a3 3 0 0 0-3-3h-9V1a1 1 0 0 0-1.094-1.031zM2 5h22v13H2V5zm18.875 1a1 1 0 0 0-.594.281L17 9.563L14.719 7.28a1 1 0 0 0-1.594.219l-2.969 5.188l-1.219-3.063a1 1 0 0 0-1.656-.344l-3 3a1.016 1.016 0 1 0 1.439 1.44l1.906-1.906l1.438 3.562a1 1 0 0 0 1.812.125l3.344-5.844l2.062 2.063a1 1 0 0 0 1.438 0l4-4A1 1 0 0 0 20.875 6z"})],-1),Oa=t("label",{class:"text-primary"},"Total:",-1),Ga={class:"date-picker-wrapper",style:{width:"auto"}},$a={class:"me-3",style:{width:"80px"}},Ra={class:"d-flex align-center flex-wrap gap-2"},ja={style:{width:"10rem"}},qa=t("span",null,"Exportar Todo",-1),Ja=t("span",null,"Esta carga puede demorar hasta 12 minutos, espere por favor",-1),Qa=["sort-by","sort-desc"],Wa={class:"row-cr"},Xa=t("div",null," Nombres ",-1),Ka={class:"row-cr"},et=t("div",null,"Proveedor",-1),at={class:"row-cr"},tt=t("div",null,"Creaci\xF3n",-1),lt={class:"row-cr"},ot=t("div",null,"\xDAltima sesi\xF3n",-1),st={class:"row-cr"},nt=t("div",null,"Pa\xEDs",-1),it={class:"row-cr"},rt=t("div",null,"Tel\xE9fono",-1),ct={class:"row-cr"},dt=t("div",null,"Newsletter",-1),ut=t("th",{scope:"col"},"Acciones",-1),pt={class:"d-flex align-center"},vt={key:1},_t={class:"d-flex flex-column"},ft={class:"text-base"},ht={class:"text-sm text-disabled"},mt={class:"d-flex align-center"},gt={class:"d-flex flex-column"},wt={class:"text-capitalize text-base vamosss"},yt={class:"d-flex align-center"},bt={class:"d-flex flex-column"},xt={class:"text-capitalize text-base"},Ct={class:"d-flex align-center"},At={class:"d-flex flex-column"},kt={class:"text-capitalize text-base"},Vt={class:"text-sm"},Mt={class:"text-base"},Ht={class:"itemListado"},Yt={class:"lis_true",style:{display:"none"}},Dt=t("span",{class:"lis_false"},"Cargando...",-1),Lt={class:"text-center",style:{width:"5rem"}},St={class:"text-sm text-disabled"},Et=t("span",null,"\xBF Est\xE1 seguro que desea eliminar",-1),Ft=t("br",null,null,-1),jt={__name:"index_old",setup(Ut){const y=da.exports.extendMoment(ua);y.locale("es",[pa]);const S=va(),E=i(""),F=i(""),U=i(),V=i(10),Pe=i(2200),b=i(1),A=i(1),be=i(0),X=i(0),xe=i(0),K=i(0),ee=i(0),ae=i(0),te=i(0),le=i(0),oe=i(0),se=i(0),ne=i(0),ie=i(0),re=i(0),ce=i(0),de=i(0),Ce=i(0),Ae=i(0),ke=i(0),Ve=i(0),x=i([]),Me=i([]),He=i(0),Ye=i(0),De=i(0),Le=i(0),j=i(""),ue=i(!0),pe=i(!1),_=i("created_at"),g=i(!0),ve=i([]);i(0);const M=i(""),H=i(""),q=i(""),J=i(!1),Se=()=>{ue.value=!1,pe.value=!0},Ee=()=>{ue.value=!0,pe.value=!1},I=i(!1),T=i(JSON.parse(localStorage.getItem("userData"))),O=i(y().format("DD/MM/YYYY HH:mm:ss").toString()),Y=i({}),G=i(!1),ze=_a(),B=()=>{try{Se(),S.fetchUsers({pageSize:V.value,page:b.value,query:j.value,provider:F.value,news:U.value,sort:g.value?-1:1,columnSort:_.value,fechai:M.value&&H.value?M.value:"",fechaf:M.value&&H.value?H.value:""}).then(a=>{x.value=a.data.users,Me.value=a.data.totalUsers;const l=JSON.stringify(x.value),r=JSON.parse(l),h=JSON.stringify(x.value.map(u=>u.email),null,2);fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/sendpulse/token.php").then(function(u){return u.text()}).then(function(u){fetch("https://api.sendpulse.com/emails",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+u},body:JSON.stringify({emails:h}),redirect:"follow"}).then(e=>e.json()).then(e=>{const d=x.value;d.forEach(fe=>{const ca=fe.email;fe.newsletter_opt_in=!1,Object.keys(e).forEach(Ue=>{const Bt=e[Ue];Ue.toLowerCase()==ca.toLowerCase()&&(fe.newsletter_opt_in=!0)})}),x.value=d;const p=document.querySelectorAll(".listadoGen .itemListado .lis_true"),N=document.querySelectorAll(".listadoGen .itemListado .lis_false");for(var Z of p)Z.style.display="block";for(var P of N)P.style.display="none"}).catch(e=>console.log("error",e))}).catch(function(u){console.log(u)}),A.value=a.data.totalPage,Ee()}).catch(a=>{console.error(a)})}catch(a){console.error(a)}};(()=>{let a=localStorage.getItem("role");a!=="administrador"&&a!=="webmaster"&&ze.push({path:"/pages/errors/not-authorized"})})(),(()=>{S.countUsers().then(a=>{const l=i(0),r=i(0),h=i(0),u=i(0),e=i(0),d=i(0),p=i(0),N=i(0),Z=a.data.totalEmail+a.data.totalFacebook+a.data.totalGoogle;se.value=a.data.totalEmail,le.value=a.data.totalFacebook,oe.value=a.data.totalGoogle,ne.value=a.data.totalApple,be.value=a.data.totalEmail+a.data.totalFacebook+a.data.totalGoogle+a.data.totalApple,X.value=a.data.totalAppEmail+a.data.totalAppGoogle+a.data.totalAppFacebook+a.data.totalAppApple,ce.value=a.data.totalAppEmail,ie.value=a.data.totalAppFacebook,re.value=a.data.totalAppGoogle,de.value=a.data.totalAppApple;let P=X.value;K.value=a.data.totalEmail+a.data.totalAppEmail,ee.value=a.data.totalFacebook+a.data.totalAppFacebook,ae.value=a.data.totalGoogle+a.data.totalAppGoogle,te.value=a.data.totalApple+a.data.totalAppApple,xe.value=K.value+ee.value+ae.value+te.value,l.value=se.value*100/Z,He.value=Math.round((l.value+Number.EPSILON)*100)/100,r.value=le.value*100/Z,Ye.value=Math.round((r.value+Number.EPSILON)*100)/100,h.value=oe.value*100/Z,De.value=Math.round((h.value+Number.EPSILON)*100)/100,u.value=ne.value*100/Z,Le.value=Math.round((u.value+Number.EPSILON)*100)/100,e.value=ce.value*100/P,Ce.value=Math.round((e.value+Number.EPSILON)*100)/100,d.value=ie.value*100/P,Ae.value=Math.round((d.value+Number.EPSILON)*100)/100,p.value=re.value*100/P,ke.value=Math.round((p.value+Number.EPSILON)*100)/100,N.value=de.value*100/P,Ve.value=Math.round((N.value+Number.EPSILON)*100)/100}).catch(a=>{console.error(a)})})();const Oe=()=>{E.value&&(b.value=1,A.value=1,j.value=E.value,B())},Ge=()=>{b.value=1,A.value=1,U.value="",F.value=void 0,j.value="",E.value="",M.value="",H.value="",q.value="",B()};he(B),he(()=>{b.value>A.value&&(b.value=A.value)});async function $(a){if(T.value.email!=="admin@demo.com"){var l=new Headers;l.append("Content-Type","application/json");var r=JSON.stringify(a),h={method:"POST",headers:l,body:r,redirect:"follow"};await fetch("https://servicio-logs.vercel.app/accion",h).then(u=>{}).catch(u=>console.log("error",u))}}$({usuario:T.value.email,pagina:"lista-usuarios",fecha:O.value});const $e=[{title:"Facebook",value:"facebook"},{title:"Google",value:"google"},{title:"Email",value:"email"},{title:"Apple",value:"apple"},{title:"Email desde app",value:"app-client-email"},{title:"Google desde app",value:"app-client-google"},{title:"Facebook desde app",value:"app-client-facebook"},{title:"Apple desde app",value:"app-client-apple"}],Re=[{title:"True",value:"true"},{title:"False",value:"false"}],je=a=>a==="google"||a==="app-client-google"?{color:"warning",icon:'<svg aria-hidden="true" class="native svg-icon iconGoogle" width="18" height="18" viewBox="0 0 18 18"><path d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18Z" fill="#4285F4"></path><path d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17Z" fill="#34A853"></path><path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07Z" fill="#FBBC05"></path><path d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3Z" fill="#EA4335"></path></svg>'}:a==="facebook"||a==="app-client-facebook"?{color:"success",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 9C18 4.02944 13.9706 0 9 0C4.02944 0 0 4.02944 0 9C0 13.4922 3.29117 17.2155 7.59375 17.8906V11.6016H5.30859V9H7.59375V7.01719C7.59375 4.76156 8.9374 3.51562 10.9932 3.51562C11.9779 3.51562 13.0078 3.69141 13.0078 3.69141V5.90625H11.8729C10.7549 5.90625 10.4062 6.6 10.4062 7.31175V9H12.9023L12.5033 11.6016H10.4062V17.8906C14.7088 17.2155 18 13.4922 18 9Z" fill="#1877F2"/></svg>'}:a==="apple"||a==="app-client-apple"?{color:"success",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"><path d="M11.6734 7.2221C10.7974 7.2221 9.44138 6.2261 8.01338 6.2621C6.12938 6.2861 4.40138 7.3541 3.42938 9.0461C1.47338 12.4421 2.92538 17.4581 4.83338 20.2181C5.76938 21.5621 6.87338 23.0741 8.33738 23.0261C9.74138 22.9661 10.2694 22.1141 11.9734 22.1141C13.6654 22.1141 14.1454 23.0261 15.6334 22.9901C17.1454 22.9661 18.1054 21.6221 19.0294 20.2661C20.0974 18.7061 20.5414 17.1941 20.5654 17.1101C20.5294 17.0981 17.6254 15.9821 17.5894 12.6221C17.5654 9.8141 19.8814 8.4701 19.9894 8.4101C18.6694 6.4781 16.6414 6.2621 15.9334 6.2141C14.0854 6.0701 12.5374 7.2221 11.6734 7.2221ZM14.7934 4.3901C15.5734 3.4541 16.0894 2.1461 15.9454 0.850098C14.8294 0.898098 13.4854 1.5941 12.6814 2.5301C11.9614 3.3581 11.3374 4.6901 11.5054 5.9621C12.7414 6.0581 14.0134 5.3261 14.7934 4.3901Z" fill="rgba(0,0,0,1)"></path></svg>'}:{color:"primary",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33.39 14" width="33.39" height="14"><g id="Capa_2" data-name="Capa 2"><g id="logo"><path d="M14.19,12.16a1.66,1.66,0,0,0-1.66-1.66H1.66a1.66,1.66,0,0,0,0,3.32H12.53A1.66,1.66,0,0,0,14.19,12.16Z" style="fill:#7367f0"/><path d="M32.52.19a1.68,1.68,0,0,0-2.25.68L25.09,9.14,20.23.77A1.72,1.72,0,0,0,18.77.08H7.82a1.66,1.66,0,0,0,0,3.32h9.53a1,1,0,0,1,.78.36l5.39,9.3a1.71,1.71,0,0,0,.71.75,1.66,1.66,0,0,0,2.25-.68L33.19,2.44A1.67,1.67,0,0,0,32.52.19Z" style="fill:#7367f0"/><path d="M19.25,13.83a1.65,1.65,0,0,0,.79-2.2s-2.38-4-3.24-5.74a1.12,1.12,0,0,0-1-.63H4.48a1.66,1.66,0,0,0,0,3.32H14a.65.65,0,0,1,.58.29C15.41,10.55,17,13,17,13.05A1.65,1.65,0,0,0,19.25,13.83Z" style="fill:#7367f0"/></g></g></svg>'},qe=a=>a==="false"?"error":a==="true"?"success":a==="inactive"?"secondary":"primary",Q=i(!1);he(()=>{b.value>A.value&&(b.value=A.value)});const Je=fa(()=>{const a=x.value.length?(b.value-1)*V.value+1:0,l=x.value.length+(b.value-1)*V.value;return`Showing ${a} to ${l} of ${Me.value} entries`});async function Qe(a){await $({usuario:T.value.email,pagina:"lista-usuarios",accion:"agregar",data:a,fecha:O.value}),S.addUser(a),B()}const We=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" style="width: 1rem; height: 1rem;" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="#7367f0" d="M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4Z"/></svg>',color:"primary",title:"Total de Usuarios",stats:be,percentage:null,percentageApp:null,subtitle:X,total:xe},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33.39 14" width="1rem" height="1rem"><g id="Capa_2" data-name="Capa 2"><g id="logo"><path d="M14.19,12.16a1.66,1.66,0,0,0-1.66-1.66H1.66a1.66,1.66,0,0,0,0,3.32H12.53A1.66,1.66,0,0,0,14.19,12.16Z" style="fill:#7367f0"/><path d="M32.52.19a1.68,1.68,0,0,0-2.25.68L25.09,9.14,20.23.77A1.72,1.72,0,0,0,18.77.08H7.82a1.66,1.66,0,0,0,0,3.32h9.53a1,1,0,0,1,.78.36l5.39,9.3a1.71,1.71,0,0,0,.71.75,1.66,1.66,0,0,0,2.25-.68L33.19,2.44A1.67,1.67,0,0,0,32.52.19Z" style="fill:#7367f0"/><path d="M19.25,13.83a1.65,1.65,0,0,0,.79-2.2s-2.38-4-3.24-5.74a1.12,1.12,0,0,0-1-.63H4.48a1.66,1.66,0,0,0,0,3.32H14a.65.65,0,0,1,.58.29C15.41,10.55,17,13,17,13.05A1.65,1.65,0,0,0,19.25,13.83Z" style="fill:#7367f0"/></g></g></svg>',color:"error",title:"Total con Email",stats:se,percentage:He,percentageApp:Ce,subtitle:ce,total:K},{icon:'<svg width="1rem" height="1rem" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 9C18 4.02944 13.9706 0 9 0C4.02944 0 0 4.02944 0 9C0 13.4922 3.29117 17.2155 7.59375 17.8906V11.6016H5.30859V9H7.59375V7.01719C7.59375 4.76156 8.9374 3.51562 10.9932 3.51562C11.9779 3.51562 13.0078 3.69141 13.0078 3.69141V5.90625H11.8729C10.7549 5.90625 10.4062 6.6 10.4062 7.31175V9H12.9023L12.5033 11.6016H10.4062V17.8906C14.7088 17.2155 18 13.4922 18 9Z" fill="#1877F2"/></svg>',color:"success",title:"Total con Facebook",stats:le,percentage:Ye,percentageApp:Ae,subtitle:ie,total:ee},{icon:'<svg aria-hidden="true" class="native svg-icon iconGoogle" width="1rem" height="1rem" viewBox="0 0 18 18"><path d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18Z" fill="#4285F4"></path><path d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17Z" fill="#34A853"></path><path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07Z" fill="#FBBC05"></path><path d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3Z" fill="#EA4335"></path></svg>',color:"warning",title:"Total con Google",stats:oe,percentage:De,percentageApp:ke,subtitle:re,total:ae},{icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1rem" height="1rem"><path d="M11.6734 7.2221C10.7974 7.2221 9.44138 6.2261 8.01338 6.2621C6.12938 6.2861 4.40138 7.3541 3.42938 9.0461C1.47338 12.4421 2.92538 17.4581 4.83338 20.2181C5.76938 21.5621 6.87338 23.0741 8.33738 23.0261C9.74138 22.9661 10.2694 22.1141 11.9734 22.1141C13.6654 22.1141 14.1454 23.0261 15.6334 22.9901C17.1454 22.9661 18.1054 21.6221 19.0294 20.2661C20.0974 18.7061 20.5414 17.1941 20.5654 17.1101C20.5294 17.0981 17.6254 15.9821 17.5894 12.6221C17.5654 9.8141 19.8814 8.4701 19.9894 8.4101C18.6694 6.4781 16.6414 6.2621 15.9334 6.2141C14.0854 6.0701 12.5374 7.2221 11.6734 7.2221ZM14.7934 4.3901C15.5734 3.4541 16.0894 2.1461 15.9454 0.850098C14.8294 0.898098 13.4854 1.5941 12.6814 2.5301C11.9614 3.3581 11.3374 4.6901 11.5054 5.9621C12.7414 6.0581 14.0134 5.3261 14.7934 4.3901Z" fill="rgba(0,0,0,1)"></path></svg>',color:"warning",title:"Total con Apple",stats:ne,percentage:Le,percentageApp:Ve,subtitle:de,total:te}];function Xe(a){for(var l=typeof a!="object"?JSON.parse(a):a,r="",h=0;h<l.length;h++){var u="";for(var e in l[h])u!=""&&(u+=","),u+=l[h][e];r+=u+`\r
`}return r}function _e(a,l,r){a&&l[0].wylexId!=="wylexId"&&l.unshift(a);var h=JSON.stringify(l),u=Xe(h),e=r+".csv"||"export.csv",d=new Blob([u],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(d,e);else{var p=document.createElement("a");if(p.download!==void 0){var N=URL.createObjectURL(d);p.setAttribute("href",N),p.setAttribute("download",e),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)}}}async function Ke(){await S.countPageUsers().then(async a=>{let l=Number(a.data);for(let r=1;r<l+1;r++)await S.fetchFullUsers(r).then(h=>{console.log("res",h.data),Array.from(h.data).forEach(e=>{ve.value.push({_id:e._id,wylexId:e.wylexId,site:e.site,site_id:e.site_id,email:e.email,first_name:e.first_name,last_name:e.last_name,avatar:e.avatar,created_at:y(e.created_at).format("DD/MM/YYYY-HH:mm:ss"),logged_at:y(e.logged_at).format("DD/MM/YYYY-HH:mm:ss"),logged_at_site:e.logged_at_site,updated_at:e.updated_at,validated_at:e.validated_at,banned_at:e.banned_at,country:e.country,phone_prefix:e.phone_prefix,phone_number:e.phone_number,gender:e.gender,birth_date:e.birth_date,identification_type:e.identification_type,identification_number:e.identification_number,newsletter_opt_in:e.newsletter_opt_in,provider:e.provider})}),ve.value.sort((e,d)=>y(d.created_at,"DD/MM/YYYY-HH:mm:ss").diff(y(e.created_at,"DD/MM/YYYY-HH:mm:ss")))});I.value=!1}).catch(a=>{console.error(a)})}async function ea(){I.value=!0,await Ke(),I.value=!1;let a={_id:"_id",wylexId:"wylexId",site:"site",site_id:"site_id",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created_at",logged_at:"logged_at",logged_at_site:"logged_at_site",updated_at:"updated_at",validated_at:"validated_at",banned_at:"banned_at",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider"},l=[];l=ve.value;let r="users_full";await $({usuario:T.value.email,pagina:"lista-usuarios",accion:"descarga-completa",fecha:O.value}),_e(a,l,r)}async function aa(){let a={wylexId:"wylexId",site:"site",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created",logged_at:"last_session",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider"},l=[],r=Array.from(x.value),h=x.value.length?(b.value-1)*V.value+1:0,u=x.value.length+(b.value-1)*V.value,e="users_section_"+h+"_"+u;r.forEach(d=>{l.push({wylexId:d.wylexId,site:d.site,email:d.email,first_name:d.first_name,last_name:d.last_name,avatar:d.avatar,created_at:y(d.created_at).format("DD/MM/YYYY-HH:mm:ss"),logged_at:y(d.logged_at).format("DD/MM/YYYY-HH:mm:ss"),country:d.country,phone_prefix:d.phone_prefix,phone_number:d.phone_number,gender:d.gender,birth_date:d.birth_date,identification_type:d.identification_type,identification_number:d.identification_number,newsletter_opt_in:d.newsletter_opt_in,provider:d.provider})}),await $({usuario:T.value.email,pagina:"lista-usuarios",accion:"descarga-seccion",fecha:O.value}),_e(a,l,e)}async function ta(){J.value=!0;let a={wylexId:"wylexId",site:"site",email:"email",first_name:"first_name",last_name:"last_name",avatar:"avatar",created_at:"created",logged_at:"last_session",country:"country",phone_prefix:"phone_prefix",phone_number:"phone_number",gender:"gender",birth_date:"birth_date",identification_type:"identification_type",identification_number:"identification_number",newsletter_opt_in:"newsletter_opt_in",provider:"provider"},l=[];var r=A.value;for(let u=1;u<r+1;u++)await S.fetchUsers({pageSize:Pe.value,page:u,query:j.value,provider:F.value,news:U.value,sort:g.value?-1:1,columnSort:_.value,fechai:M.value&&H.value?M.value:"",fechaf:M.value&&H.value?H.value:""}).then(e=>{let d=e.data.users;u==1&&(r=e.data.totalPage+1,console.log(r)),d.length<1&&(u=A.value+1),d.forEach(p=>{l.push({wylexId:p.wylexId,site:p.site,email:p.email,first_name:p.first_name,last_name:p.last_name,avatar:p.avatar,created_at:y(p.created_at).format("DD/MM/YYYY-HH:mm:ss"),logged_at:y(p.logged_at).format("DD/MM/YYYY-HH:mm:ss"),country:p.country,phone_prefix:p.phone_prefix,phone_number:p.phone_number,gender:p.gender,birth_date:p.birth_date,identification_type:p.identification_type,identification_number:p.identification_number,newsletter_opt_in:p.newsletter_opt_in,provider:p.provider})})}).catch(e=>{console.error(e)});let h="users_busqueda";await $({usuario:T.value.email,pagina:"lista-usuarios",accion:"descarga-busqueda",fecha:O.value}),_e(a,l,h),J.value=!1}const D=a=>{_.value===a?g.value=!g.value:(_.value=a,g.value=!1),B()},la=a=>{a.value=a},oa=a=>{a.value=a};async function sa(a){if(!a)return null;await fetch("https://data.mongodb-api.com/app/backoffice1-usyys/endpoint/id?id="+a).then(l=>l.json()).then(l=>{Y.value=l}).catch(l=>l),G.value=!0}async function na(){Se();let a=Y.value.wylexId;var l={method:"DELETE",redirect:"follow"};await fetch("https://data.mongodb-api.com/app/backoffice1-usyys/endpoint/delete/wylex?id="+a,l).then(r=>r.json()).then(r=>!0).catch(r=>r),await fetch("https://servicio-delete.vercel.app/delete?id="+a,l).then(r=>r.json()).then(r=>!0).catch(r=>r),G.value=!1,Y.value={},B(),Ee()}const Fe=a=>{a===!1&&(Y.value={}),G.value=a},ia=()=>{Y.value={},G.value=!1},ra=a=>{a.length>1&&(M.value=`${y(a[0]).format("YYYY-MM-DD")}T00:00:00Z`,H.value=`${y(a[1]).format("YYYY-MM-DD")}T23:59:59Z`,console.log("fechas",a))};return(a,l)=>{const r=Va,h=ha("RouterLink"),u=Ma;return v(),R("section",null,[s(Be,null,{default:n(()=>[(v(),R(Ie,null,Te(We,e=>s(z,{class:"mr-6",key:e.title,cols:"12",sm:"12",lg:"2"},{default:n(()=>[s(me,{class:"col-12 col-sm- col-lg-2 tarjeta"},{default:n(()=>[s(W,{class:"d-flex justify-space-between",style:{"font-size":"11px"}},{default:n(()=>[t("div",null,[t("span",null,w(e.title),1),t("div",null,[t("div",Ea,[Fa,Ua,c(" "+w(e.stats)+" ",1),t("span",{class:"text-success",hidden:!e.percentage},"("+w(e.percentage)+"%) ",9,Ia)]),t("div",Ta,[Ba,Na,c(" "+w(e.subtitle)+" ",1),t("span",{class:"text-success",hidden:!e.percentageApp},"("+w(e.percentageApp)+"%) ",9,Za)]),t("div",Pa,[za,Oa,c(" "+w(e.total),1)])])]),s(ge,{rounded:"",variant:"tonal",color:e.color,innerHTML:e.icon,"max-width":"100%"},null,8,["color","innerHTML"])]),_:2},1024)]),_:2},1024)]),_:2},1024)),64)),s(z,{cols:"12"},{default:n(()=>[s(me,{title:"Filtro de b\xFAsqueda"},{default:n(()=>[s(W,null,{default:n(()=>[s(Be,null,{default:n(()=>[s(z,{cols:"12",sm:"4"},{default:n(()=>[s(we,{modelValue:o(F),"onUpdate:modelValue":l[0]||(l[0]=e=>L(F)?F.value=e:null),label:"Proveedor",items:$e,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),s(z,{cols:"12",sm:"4",style:{display:"none"}},{default:n(()=>[s(we,{modelValue:o(U),"onUpdate:modelValue":l[1]||(l[1]=e=>L(U)?U.value=e:null),label:"Bolet\xEDn",items:Re,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),s(z,{cols:"12",sm:"4"},{default:n(()=>[t("div",Ga,[s(r,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:o(q),"onUpdate:modelValue":l[2]||(l[2]=e=>L(q)?q.value=e:null),"show-current":"true",onOnChange:ra,config:{position:"auto right",mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",maxDate:new Date,reactive:!0,clearable:!0}},null,8,["modelValue","config"])])]),_:1})]),_:1})]),_:1}),s(ye),s(W,{class:"d-flex flex-wrap py-4 gap-4"},{default:n(()=>[t("div",$a,[s(we,{modelValue:o(V),"onUpdate:modelValue":l[3]||(l[3]=e=>L(V)?V.value=e:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),s(Da),t("div",Ra,[t("div",ja,[s(ma,{modelValue:o(E),"onUpdate:modelValue":l[4]||(l[4]=e=>L(E)?E.value=e:null),placeholder:"Buscar...",density:"compact"},null,8,["modelValue"])]),s(C,{"prepend-icon":"tabler-search",onClick:Oe}),s(C,{color:"secondary",onClick:Ge},{default:n(()=>[c(" Reiniciar ")]),_:1}),s(C,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:ea,loading:o(I),disabled:o(I)},{default:n(()=>[qa,s(La,{"open-on-click":"","open-on-hover":!1,location:"top",activator:"parent","no-click-animation":"",disabled:!o(I)},{default:n(()=>[Ja]),_:1},8,["disabled"])]),_:1},8,["loading","disabled"]),s(C,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:aa},{default:n(()=>[c(" Exportar secci\xF3n ")]),_:1}),s(C,{variant:"tonal",color:"success","prepend-icon":"tabler-screen-share",onClick:ta,loading:o(J),disabled:o(J)},{default:n(()=>[c(" Exportar b\xFAsqueda ")]),_:1},8,["loading","disabled"]),s(C,{"prepend-icon":"tabler-plus",onClick:l[5]||(l[5]=e=>Q.value=!0)},{default:n(()=>[c(" Agregar usuario ")]),_:1})])]),_:1}),s(ye),t("div",{class:k(["loader-section",{loaded:o(ue)}])},[s(ga,{indeterminate:"",color:"primary"})],2),s(wa,{class:k(["text-no-wrap",{loaded:o(pe)}])},{default:n(()=>[t("thead",{"sort-by":o(_),"sort-desc":o(g),"onUpdate:sortBy":la,"onUpdate:sortDesc":oa},[t("tr",null,[t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[6]||(l[6]=e=>D("first_name"))},[t("div",Wa,[Xa,t("span",{class:k(["sort-icon",{active:o(_)==="first_name"}])},[o(g)&&o(_)=="first_name"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="first_name"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[7]||(l[7]=e=>D("provider"))},[t("div",Ka,[et,t("span",{class:k(["sort-icon",{active:o(_)==="provider"}])},[o(g)&&o(_)=="provider"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="provider"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[8]||(l[8]=e=>D("created_at"))},[t("div",at,[tt,t("span",{class:k(["sort-icon",{active:o(_)==="created_at"}])},[o(g)&&o(_)=="created_at"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="created_at"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[9]||(l[9]=e=>D("logged_at"))},[t("div",lt,[ot,t("span",{class:k(["sort-icon",{active:o(_)==="logged_at"}])},[o(g)&&o(_)=="logged_at"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="logged_at"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[10]||(l[10]=e=>D("country"))},[t("div",st,[nt,t("span",{class:k(["sort-icon",{active:o(_)==="country"}])},[o(g)&&o(_)=="country"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="country"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[11]||(l[11]=e=>D("phone_number"))},[t("div",it,[rt,t("span",{class:k(["sort-icon",{active:o(_)==="phone_number"}])},[o(g)&&o(_)=="phone_number"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="phone_number"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),t("th",{scope:"col",class:"col-cr",title:"click para ordenar",onClick:l[12]||(l[12]=e=>D("newsletter_opt_in"))},[t("div",ct,[dt,t("span",{class:k(["sort-icon",{active:o(_)==="newsletter_opt_in"}])},[o(g)&&o(_)=="newsletter_opt_in"?(v(),m(f,{key:0},{default:n(()=>[c("mdi-chevron-down")]),_:1})):!o(g)&&o(_)=="newsletter_opt_in"?(v(),m(f,{key:1},{default:n(()=>[c("mdi-chevron-up")]),_:1})):(v(),m(f,{key:2},{default:n(()=>[c("mdi-chevron-up-down")]),_:1}))],2)])]),ut])],40,Qa),t("tbody",null,[(v(!0),R(Ie,null,Te(o(x),e=>(v(),R("tr",{class:"listadoGen",key:e.wylexId,style:{height:"3.75rem"}},[t("td",null,[t("div",pt,[s(ge,{variant:"tonal",class:"me-3",size:"38"},{default:n(()=>[e.avatar?(v(),m(ya,{key:0,src:e.avatar},null,8,["src"])):(v(),R("span",vt,w(o(Ya)(e.first_name)),1))]),_:2},1024),t("div",_t,[t("h6",ft,[s(h,{to:{name:"apps-user-view-id",params:{id:e.wylexId}},class:"font-weight-medium user-list-name"},{default:n(()=>[c(w(e.first_name)+" "+w(e.last_name),1)]),_:2},1032,["to"])]),t("span",ht,w(e.email),1)])])]),t("td",null,[t("div",mt,[s(ge,{class:"me-3",innerHTML:je(e.provider).icon,variant:"tonal",size:"30"},null,8,["innerHTML"]),t("div",gt,[t("span",wt,w(e.provider.replace("app-client-email","App-Email").replace("app-client-google","App-Google").replace("app-client-facebook","App-Facebook").replace("app-client-apple","App-Apple")),1)])])]),t("td",null,[t("div",yt,[t("div",bt,[t("span",xt,w(e.created_at!=""?o(y)(e.created_at).format("DD/MM/YYYY, HH:mm:ss"):""),1)])])]),t("td",null,[t("div",Ct,[t("div",At,[t("span",kt,w(e.logged_at!=""?o(y)(e.logged_at).format("DD/MM/YYYY, HH:mm:ss"):""),1)])])]),t("td",null,[t("span",Vt,w(e.country),1)]),t("td",null,[t("span",Mt,w(e.phone_number),1)]),t("td",Ht,[s(ba,{label:"",color:qe(e.newsletter_opt_in),size:"small",class:"text-capitalize"},{default:n(()=>[t("span",Yt,w(e.newsletter_opt_in),1),Dt]),_:2},1032,["color"])]),t("td",Lt,[s(C,{icon:"",size:"x-small",color:"default",variant:"text"},{default:n(()=>[s(h,{to:{name:"apps-user-view-id",params:{id:e.wylexId}},class:"font-weight-medium user-list-name"},{default:n(()=>[s(f,{size:"22",icon:"tabler-eye"})]),_:2},1032,["to"])]),_:2},1024),s(C,{icon:"",size:"x-small",color:"default",variant:"text",onClick:d=>sa(e.wylexId)},{default:n(()=>[s(f,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),s(C,{icon:"",size:"x-small",color:"default",variant:"text",style:{display:"none"}},{default:n(()=>[s(f,{size:"22",icon:"tabler-dots-vertical"}),s(xa,{activator:"parent"},{default:n(()=>[s(Ca,null,{default:n(()=>[s(Ne,{title:"View",to:{name:"apps-user-view-id",params:{id:e.wylexId}}},null,8,["to"]),s(Ne,{title:"Suspend",href:"javascript:void(0)"})]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1},8,["class"]),s(ye),s(W,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:n(()=>[t("span",St,w(o(Je)),1),s(Sa,{modelValue:o(b),"onUpdate:modelValue":l[13]||(l[13]=e=>L(b)?b.value=e:null),size:"small","total-visible":5,length:o(A)},null,8,["modelValue","length"])]),_:1}),s(Aa,{persistent:"","no-click-animation":"",width:a.$vuetify.display.smAndDown?"auto":600,"model-value":o(G),"onUpdate:modelValue":Fe},{default:n(()=>[s(u,{onClick:l[14]||(l[14]=e=>Fe(!1))}),s(me,{class:"pa-sm-14 pa-5"},{default:n(()=>[s(Ze,{class:"text-center"},{default:n(()=>[s(ka,{class:"text-h5 mb-3 p-5"},{default:n(()=>[Et,Ft,t("span",null,[c("el usuario "),t("i",null,w(o(Y).first_name)+" "+w(o(Y).last_name),1),c(" ?")])]),_:1})]),_:1}),s(Ze,null,{default:n(()=>[s(z,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:n(()=>[s(C,{color:"error",onClick:na},{default:n(()=>[c(" Aceptar ")]),_:1}),s(C,{onClick:ia},{default:n(()=>[c(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])]),_:1})]),_:1})]),_:1}),s(Ha,{isDrawerOpen:o(Q),"onUpdate:isDrawerOpen":l[15]||(l[15]=e=>L(Q)?Q.value=e:null),onUserData:Qe},null,8,["isDrawerOpen"])])}}};export{jt as default};
