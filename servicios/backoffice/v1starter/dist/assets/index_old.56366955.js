import{R as ve,S as pe,U as _e,r as i,as as ge,v as Ve,z as he,o as k,x as L,a as e,w as a,q as f,t as _,u as s,f as be,h as N,a$ as ye,i as v,b0 as J,e as p,g as O,aR as K,aQ as E,b as u,p as g,c as z,aW as we,F as Z,C as ee,N as ae,V as A,l as xe,m as De,n as $,aT as Ce,$ as ke,aU as Ye,aV as Se,a1 as je,bc as Pe,aX as Me}from"./index.88d3c7f5.js";/* empty css              */import{V as Te}from"./VCheckbox.50e352e3.js";const Fe={class:"d-flex flex-wrap gap-4 mt-10"},Ue=u("thead",null,[u("tr",null,[u("th",{scope:"col"},"T\xEDtulo"),u("th",{scope:"col"},"Fecha de inicio"),u("th",{scope:"col"},"Fecha de fin"),u("th",{scope:"col"},"Acciones")])],-1),Le={class:"text-medium-emphasis"},Ne={class:"text-medium-emphasis"},Ee={class:"text-medium-emphasis"},$e={class:"text-medium-emphasis"},Re={class:"d-flex align-center justify-space-between botonescurrentPage"},Be=u("div",{class:"mb-3"},"Seleccione el rango de fecha para la semana",-1),Ie={class:"date-picker-wrapper",style:{width:"100%"}},Je=u("span",null,"Seleccione los desaf\xEDos para la semana",-1),He={__name:"index_old",setup(Oe){const b=ve.exports.extendMoment(pe);b.locale("es",[_e]);const T=i([]),R=i(!1),d=i(!1),le=i(!1),F=i([]);async function B(){try{R.value=!0;const l=await(await fetch("https://servicio-desafios.vercel.app/semana/all/get")).json();let r=Array.from(l.data);T.value=r.map(n=>({...n,fecha_inicio:b(n.fecha_inicio).utc().format("DD/MM/YYYY"),fecha_fin:b(n.fecha_fin).utc().format("DD/MM/YYYY")})),R.value=!1}catch(o){console.error(o.message)}}async function te(){try{le.value=!0;const l=await(await fetch("https://servicio-desafios.vercel.app/desafios")).json();F.value=l.data.map(({tituloDesafio:r,_id:n})=>({title:r,value:n}))}catch(o){console.error(o.message)}}ge(async()=>{d.value=!0,await B(),await te(),d.value=!1});const U=8,V=i(1),se=Ve(()=>{const o=(V.value-1)*U,l=o+U;return T.value.slice(o,l)}),oe=()=>{V.value*U<T.value.length&&V.value++},ne=()=>{V.value>1&&V.value--},y=i(!1),Y=i(""),q=i(""),w=i(""),x=i(""),D=i(""),c=i([]),S=i(""),j=i(""),C=i(""),M=i(""),m=i({message:"Datos guardados",type:"success",model:!1});function I(){w.value="",x.value="",D.value="",c.value=[],S.value="",j.value="",C.value="",M.value=""}function H(){I(),y.value=!1}function ie(o,l,r){o.length>1&&(S.value=b(o[0]).format("DD-MM-YYYY"),j.value=b(o[1]).format("DD-MM-YYYY"))}async function ue(){d.value=!0,I(),Y.value="add",y.value=!0,d.value=!1}const G=i("");function re(o,l){return o.filter(n=>l.includes(n.value)).map(n=>n.value)}async function de(o){d.value=!0,I(),Y.value="edit";const n=(await(await fetch("https://servicio-desafios.vercel.app/semana/get/"+o)).json()).data;q.value=n.titulo,G.value=n._id,w.value=n.titulo,x.value=n.descripcion,D.value=n.imagen_descriptiva,C.value=n.urlPremio,c.value=re(F.value,n.desafios),S.value=b(n.fecha_inicio).utc().format("DD/MM/YYYY"),j.value=b(n.fecha_fin).utc().format("DD/MM/YYYY"),M.value=String(S.value+" a "+j.value),d.value=!1,y.value=!0}async function ce(){c.value.length==0&&(m.value={message:"Debe ingresar almenos 1 desaf\xEDo",type:"error",model:!0});var o=new Headers;if(o.append("Content-Type","application/json"),Y.value==="add"){let n={titulo:w.value,descripcion:x.value,imagen_descriptiva:D.value,urlPremio:C.value,desafios:c.value,fecha_inicio:S.value,fecha_fin:j.value};var l=JSON.stringify(n),r={method:"POST",headers:o,body:l,redirect:"follow"};const t=await(await fetch("https://servicio-desafios.vercel.app/semana/create",r)).json();if(t.resp)m.value={message:"Semana de desaf\xEDos creada correctamente",type:"success",model:!0};else return m.value={message:t.mensaje,type:"error",model:!0},console.error(t.error),!1}else if(Y.value==="edit"){console.log(c.value);let n={_id:G.value,titulo:w.value,descripcion:x.value,imagen_descriptiva:D.value,urlPremio:C.value,desafios:c.value,fecha_inicio:S.value,fecha_fin:j.value};var l=JSON.stringify(n),r={method:"PUT",headers:o,body:l,redirect:"follow"};const X=await(await fetch("https://servicio-desafios.vercel.app/semana/update",r)).json();X.resp?m.value={message:"Semana de desaf\xEDos actualizada correctamente",type:"success",model:!0}:m.value={message:X.mensaje,type:"error",model:!0}}await B(),y.value=!1}const h=i(!1),Q=i("");function me(o){d.value=!0,h.value=!0,Q.value=o,d.value=!1}async function fe(){d.value=!0;var o={method:"DELETE",redirect:"follow"};const r=await(await fetch("https://servicio-desafios.vercel.app/semana/delete/"+Q.value,o)).json();r.resp?m.value={message:"Semana de desaf\xEDo eliminada correctamente",type:"success",model:!0}:m.value={message:r.mensaje,type:"error",model:!0},await B(),h.value=!1,d.value=!1}return(o,l)=>{const r=Pe,n=Me,W=he("v-list-item-content");return k(),L("section",null,[e(be,{modelValue:s(m).model,"onUpdate:modelValue":l[0]||(l[0]=t=>s(m).model=t),location:"top end",variant:"flat",timeout:s(m).timeout||2e3,color:s(m).type},{default:a(()=>[f(_(s(m).message),1)]),_:1},8,["modelValue","timeout","color"]),e(J,{modelValue:s(d),"onUpdate:modelValue":l[1]||(l[1]=t=>v(d)?d.value=t:null),persistent:"","no-click-animation":"",width:"300"},{default:a(()=>[e(N,{class:"pt-3 text-center"},{default:a(()=>[e(ye,{indeterminate:"",color:"primary"})]),_:1})]),_:1},8,["modelValue"]),e(A,null,{default:a(()=>[e(p,{cols:"12",sm:"12",lg:"12"},{default:a(()=>[e(O,null,{default:a(()=>[e(K,{class:"pt-4 pl-6"},{default:a(()=>[f("Listado de semanas de desaf\xEDos")]),_:1}),e(E,{style:{"margin-bottom":"-2rem"}},{default:a(()=>[u("div",Fe,[e(g,{"prepend-icon":"tabler-plus",color:"success",variant:"tonal",class:"ml-auto",onClick:ue},{default:a(()=>[f(" Nueva semana ")]),_:1})])]),_:1}),s(R)?(k(),z(E,{key:0},{default:a(()=>[f(" Cargando datos... ")]),_:1})):(k(),z(E,{key:1},{default:a(()=>[e(we,{class:"text-no-wrap tableNavegacion mb-5"},{default:a(()=>[Ue,u("tbody",null,[(k(!0),L(Z,null,ee(s(se),t=>(k(),L("tr",null,[u("td",Le,_(t.titulo),1),u("td",Ne,_(t.fecha_inicio),1),u("td",Ee,_(t.fecha_fin),1),u("td",$e,[e(g,{color:"success",variant:"text",icon:"",onClick:P=>de(t._id)},{default:a(()=>[e(ae,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(g,{icon:"",color:"error",variant:"text",onClick:P=>me(t._id)},{default:a(()=>[e(ae,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),u("div",Re,[e(g,{icon:"tabler-arrow-big-left-lines",onClick:ne,disabled:s(V)===1},null,8,["disabled"]),f(" P\xE1gina "+_(s(V))+" ",1),e(g,{icon:"tabler-arrow-big-right-lines",onClick:oe,disabled:s(V)*U>=s(T).length},null,8,["disabled"])])]),_:1}))]),_:1})]),_:1})]),_:1}),e(J,{modelValue:s(y),"onUpdate:modelValue":l[9]||(l[9]=t=>v(y)?y.value=t:null),persistent:"","no-click-animation":"","max-width":"800"},{default:a(()=>[e(r,{onClick:H}),e(O,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(E,{class:"text-center"},{default:a(()=>[e(K,{class:"text-h5 mb-3"},{default:a(()=>[f(_(s(Y)==="add"||s(Y)==="duplicate"?"Nueva semana":"Editar "+s(q)),1)]),_:1})]),_:1}),e(N,null,{default:a(()=>[e(xe,{class:"mt-6",onSubmit:De(ce,["prevent"])},{default:a(()=>[e(A,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(A,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[e($,{modelValue:s(w),"onUpdate:modelValue":l[2]||(l[2]=t=>v(w)?w.value=t:null),label:"T\xEDtulo",placeholder:"Nombre de la trivia"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[e($,{modelValue:s(x),"onUpdate:modelValue":l[3]||(l[3]=t=>v(x)?x.value=t:null),label:"Descripci\xF3n",placeholder:"Descripci\xF3n de la trivia"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[e($,{modelValue:s(D),"onUpdate:modelValue":l[4]||(l[4]=t=>v(D)?D.value=t:null),label:"Im\xE1gen descriptiva",placeholder:"Im\xE1gen descriptiva"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[e($,{modelValue:s(C),"onUpdate:modelValue":l[5]||(l[5]=t=>v(C)?C.value=t:null),label:"Link del premio para la semana",placeholder:"Link del premio para la semana"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[Be,u("div",Ie,[e(n,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:s(M),"onUpdate:modelValue":l[6]||(l[6]=t=>v(M)?M.value=t:null),"show-current":"true",onOnChange:ie,config:{position:"auto right",mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",reactive:!0}},null,8,["modelValue"])])]),_:1}),e(p,{class:"mb-2",cols:"12"},{default:a(()=>[Je]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(Ce,{clearable:"",chips:"",multiple:"",modelValue:s(c),"onUpdate:modelValue":l[7]||(l[7]=t=>v(c)?c.value=t:null),items:s(F),label:"Seleccione el desaf\xEDo vinculado","menu-props":{maxHeight:"400"}},{selection:a(({item:t})=>[u("div",null,_(t.title)+" - "+_(t.value),1)]),item:a(({item:t,props:P})=>[e(ke,Ye(Se(P)),{default:a(()=>[e(W,null,{default:a(()=>[e(je,null,{default:a(()=>[u("p",null,"_id: "+_(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),(k(!0),L(Z,null,ee(s(F),t=>(k(),z(p,{style:{"margin-top":"-1.5rem"},cols:"12"},{default:a(()=>[e(Te,{modelValue:s(c),"onUpdate:modelValue":l[8]||(l[8]=P=>v(c)?c.value=P:null),label:t.title,value:t.value},null,8,["modelValue","label","value"])]),_:2},1024))),256))]),_:1}),e(p,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(g,{type:"submit"},{default:a(()=>[f(" Guardar ")]),_:1}),e(g,{color:"secondary",variant:"tonal",onClick:H},{default:a(()=>[f(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(J,{modelValue:s(h),"onUpdate:modelValue":l[12]||(l[12]=t=>v(h)?h.value=t:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(r,{onClick:l[10]||(l[10]=t=>h.value=!s(h))}),e(O,{title:"Eliminar registro"},{default:a(()=>[e(N,null,{default:a(()=>[f(" \xBFDesea eliminar la trivia? ")]),_:1}),e(N,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(g,{color:"secondary",variant:"tonal",onClick:l[11]||(l[11]=t=>h.value=!1)},{default:a(()=>[f(" No, Cerrar ")]),_:1}),e(g,{onClick:fe},{default:a(()=>[f(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{He as default};
