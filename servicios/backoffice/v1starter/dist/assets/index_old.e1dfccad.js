import{R as tt,U as at,r as v,bA as ae,bB as st,as as Fe,v as A,Q as E,ak as ot,bP as x,bQ as lt,o as b,x as _,a as s,w as i,e as F,b7 as Oe,b8 as se,q as h,g as L,h as it,b9 as Ee,ba as oe,aQ as U,b as d,aR as O,t as p,b2 as le,a2 as Pe,bC as P,u as m,a3 as H,V as ie,N as B,c as ne,Z as ve,$ as me,a0 as he,aT as nt,aW as rt,F as N,C as q,aM as be,aq as ze,p as ge,ao as Ie,ap as je,a1 as dt,bx as Q}from"./index.88d3c7f5.js";import{M as ct}from"./index.50982b4e.js";import{V as ut}from"./VPagination.9412c3b8.js";const ft={class:"d-flex"},pt={class:"descripcion"},vt={class:"bg-ecuavisa py-4 d-flex gap-4 flex-wrap"},mt={class:"date-picker-wrappe",style:{width:"190px"}},ht={style:{"min-width":"230px",width:"auto"}},bt={key:0,style:{"min-width":"230px",width:"auto"}},gt={key:1,style:{"min-width":"230px",width:"auto"}},yt={class:"d-flex flex-wrap py-0 gap-4 align-items-center",style:{"justify-content":"space-between"}},_t={style:{display:"none"}},xt={class:"px-4"},wt=d("br",null,null,-1),Yt=d("div",{class:"loading"},"Cargando informaci\xF3n",-1),St={class:"item-limit"},Dt=d("label",null,"Mostrar",-1),Vt=d("label",null,"registros",-1),Ct={key:0},$t=d("thead",{class:"text-uppercase"},[d("tr",null,[d("th",{scope:"col"}," P\xE1gina "),d("th",{scope:"col"}," Secci\xF3n "),d("th",{scope:"col",class:"text-center"}," Tiempo promedio "),d("th",{scope:"col",class:"text-center"}," Visitas "),d("th",{scope:"col"}," Acci\xF3n ")])],-1),Mt={style:{"min-width":"17rem","max-width":"17rem"}},Tt={class:"text-center"},kt={class:"text-center"},At={class:"text-center",style:{width:"5rem"}},Ft=d("tr",null,[d("td",{colspan:"8",class:"text-center text-body-1"}," No data available ")],-1),Ot=[Ft],Et={key:1},Pt={class:"text-xs text-primary pl-2"},zt={class:"espacio-right-2"},It={class:"d-flex pr-0",style:{"justify-content":"space-between"}},jt={class:"descripcion"},Rt=d("br",null,null,-1),Lt={class:"mt-3"},Ut={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Ht={class:"descripcion"},Bt=d("br",null,null,-1),Nt=d("br",null,null,-1),Xt={class:"mt-3"},Gt={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Wt={class:"descripcion"},Zt={class:"mt-3"},qt={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},Qt={class:"d-flex pr-0",style:{"justify-content":"space-between"}},Jt={class:"descripcion"},Kt={class:"mt-3"},ea={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},ta={class:"d-flex pr-0",style:{"justify-content":"space-between"}},aa={class:"descripcion"},sa={class:"mt-3"},oa={class:"date-picker-wrapper",style:{"min-width":"200px",width:"auto","max-width":"100%"}},la={key:0},ia=["onClick"],na={class:"list-group"},pa={__name:"index_old",setup(ra){const g=tt.exports.extendMoment(ct);g.tz.setDefault("America/Guayaquil"),g.locale("es",[at]);const re=a=>g.tz(a,"America/Guayaquil"),J=v("tab-lista"),S=v([]),K=v([]),ye=v([]),Re=v(!1),ee=v(1),z=v(15),y=v(!1),X=ae(),$=v({i:X.i,f:X.f,title:"hoy"}),D=v({i:X.i,f:X.f,title:"hoy"}),G=v("Hoy"),w=v("Ayer"),te=st(),M=v(X.limit),T=v(0),I=v(""),V=v(""),W=v(""),_e=v([]),xe=v([]),we=v([]),Ye=[{title:"Ordenar ASC por nombre de usuario",value:1},{title:"Ordenar DESC por nombre de usuario",value:2},{title:"Ordenar ASC por fecha de registro",value:3},{title:"Ordenar DESC por fecha de registro",value:4},{title:"Ordenar ASC por tiempo de permanencia",value:5},{title:"Ordenar DESC por tiempo de permanencia",value:6}],Le=[{title:"Ordenar ASC por nombre de p\xE1gina",value:7},{title:"Ordenar DESC por nombre de p\xE1gina",value:8},{title:"Ordenar ASC por tiempo promedio",value:9},{title:"Ordenar DESC por tiempo promedio",value:10},{title:"Ordenar ASC por visitas",value:11},{title:"Ordenar DESC por visitas",value:12}],j=v({title:z.value,value:z.value}),Ue=[{title:"10",value:10},{title:"30",value:30},{title:"50",value:50},{title:"100",value:100},{title:"200",value:200}],de=v(Ye),He=v([{title:"Agrupar por p\xE1gina",value:1}]);Fe(ce),Fe(async()=>{let a=ae("Ayer");D.value={i:a.i,f:a.f,title:w.value},y.value=!0,await Ce({fechai:D.value.i.format("YYYY-MM-DD"),fechaf:D.value.f.format("YYYY-MM-DD")}),y.value=!1,T.value="1"});function Be(a){const t=new Set;return a.data.map(e=>e.section).filter(e=>t.has(e)?!1:(t.add(e),!0)).map(e=>e.includes("-1")?{title:"Otros",value:e}:{title:e,value:e})}function Ne(a){const t=a.data.reduce((o,l)=>{const n=l.section,u=o.findIndex(f=>f.section===n);return u===-1?o.push({section:n,total:1,sumSeconds:l.seconds,porcentaje:0,promedio:0}):(o[u].total+=1,o[u].sumSeconds+=l.seconds),o},[]),e=a.data.length;return t.forEach(o=>{o.porcentaje=parseFloat(o.total/e*100).toFixed(2),o.promedio=o.sumSeconds/o.total}),t}function Xe(a){const t=a.data.reduce((o,l)=>{const n=l.subsection,u=o.findIndex(f=>f.subsection===n);return u===-1?o.push({subsection:n,total:1,sumSeconds:l.seconds,porcentaje:0,promedio:0}):(o[u].total+=1,o[u].sumSeconds+=l.seconds),o},[]).reduce((o,l)=>{if(l.subsection){const n={porcentaje:l.porcentaje,promedio:l.promedio,subsection:l.subsection,sumSeconds:l.sumSeconds,total:l.total};o.push(n)}return o},[]),e=t.reduce((o,l)=>o+l.total,0);return t.forEach(o=>{o.porcentaje=parseFloat(o.total/e*100).toFixed(2),o.promedio=o.sumSeconds/o.total}),t}async function ce(a={}){try{const{tipo:e="fecha",section:o="",fechai:l=g().format("YYYY-MM-DD"),fechaf:n=g().format("YYYY-MM-DD"),limit:u=2e3}=a;var t=await fetch(`https://servicio-permanencia.vercel.app/get/section/${l}/${n}?section=${o}&limit=${u}`);const f=await t.json();f.data.forEach(r=>{r.date=g(r.timestamp,"dd/mm/YYYY, HH:mm:ss").format("YYYY-MM-DD")}),S.value=f.data,ye.value=f.data;const c=Be(f);we.value=Xe(f),xe.value=Ne(f),e=="fecha"&&(_e.value=c,W.value="",I.value="")}catch(e){return console.error(e.message)}}const ue=A(()=>{const a=(ee.value-1)*z.value,t=ee.value*z.value;return S.value.slice(a,t)}),Ge=A(()=>Math.ceil(S.value.length/z.value));function We(a){a<0&&(a+=24*3600);const t=Math.floor(a/3600),e=Math.floor(a%3600/60),o=a%60;return`${t} horas, ${e} minutos y ${o} segundos`}E(async()=>G.value,async()=>{let a=ae(G.value);$.value={i:a.i,f:a.f,title:G.value},M.value=a.limit,y.value=!0,await ce({limit:10,fechai:$.value.i.format("YYYY-MM-DD"),fechaf:$.value.f.format("YYYY-MM-DD"),tipo:"fecha",limit:M.value}),y.value=!1,V.value=null}),E(async()=>W.value,async()=>{const a=W.value,e=[...new Set(a.map(o=>o.value))].join(", ");y.value=!0,await ce({limit:10,fechai:$.value.i.format("YYYY-MM-DD"),fechaf:$.value.f.format("YYYY-MM-DD"),section:e,limit:M.value,tipo:"section"}),y.value=!1,V.value=null}),E(async()=>w.value,async()=>{let a=ae(w.value);D.value={i:a.i,f:a.f,title:w.value},M.value=a.limit,y.value=!0,await Ce({fechai:D.value.i.format("YYYY-MM-DD"),fechaf:D.value.f.format("YYYY-MM-DD")}),y.value=!1,V.value=null});function Se(a){switch(a){case 1:return(t,e)=>t.user.first_name>e.user.first_name?1:-1;case 2:return(t,e)=>e.user.first_name>t.user.first_name?1:-1;case 3:return(t,e)=>new Date(t.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"))-new Date(e.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"));case 4:return(t,e)=>new Date(e.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"))-new Date(t.timestamp.replace(/(\d{2})\/(\d{1,2})\/(\d{4}), (\d{2}:\d{2}:\d{2})/,"$2/$1/$3 $4"));case 5:return(t,e)=>t.seconds-e.seconds;case 6:return(t,e)=>e.seconds-t.seconds;case 7:return(t,e)=>t.title>e.title?1:-1;case 8:return(t,e)=>e.title>t.title?1:-1;case 9:return(t,e)=>t.promedio-e.promedio;case 10:return(t,e)=>e.promedio-t.promedio;case 11:return(t,e)=>t.total-e.total;case 12:return(t,e)=>e.total-t.total;default:return null}}E(async()=>I.value,async()=>{const a=S.value;if(I.value){const e=I.value.value,o=[...a].sort(Se(e));S.value=o}else{V.value=null;const t=[...a].sort(Se(4));S.value=t}});const Ze=a=>{const t={};return a.filter(e=>{const o=e.date;return t[o]?(t[o]++,!1):(t[o]=1,!0)}).map(e=>({date:e.date,total:t[e.date]}))};function qe(a){const t=Array.from(S.value);switch(a){case 1:return t.reduce((l,n)=>{const u=l.findIndex(f=>f.title===n.title);return u===-1?l.push({title:n.title,promedio:n.seconds,section:n.section,total:1,url:n.url,sumSeconds:n.seconds,data:[n]}):(l[u].promedio=(l[u].promedio*l[u].data.length+n.seconds)/(l[u].data.length+1),l[u].sumSeconds+=n.seconds,l[u].data.push(n),l[u].total+=1),l},[]);case 2:const o=t.reduce((l,n)=>{const u=l.findIndex(f=>f.section===n.section);return u===-1?l.push({title:n.title,date:n.date,promedio:n.seconds,section:n.section,total:1,url:n.url,sumSeconds:n.seconds,data:[n]}):(l[u].promedio=(l[u].promedio*l[u].data.length+n.seconds)/(l[u].data.length+1),l[u].sumSeconds+=n.seconds,l[u].data.push(n),l[u].total+=1),l},[]);return o.forEach(l=>{l.data&&(l.data.sort((n,u)=>{const f=new Date(n.date),c=new Date(u.date);return f-c}),l.data=Ze(l.data))}),o;default:return null}}E(async()=>V.value,async()=>{if(V.value,V.value){const t=V.value.value,e=qe(t);S.value=e,de.value=Le}else S.value=ye.value,de.value=Ye});const Qe=a=>{const t=`rgba(${x(a.colors["on-surface"])},${a.variables["medium-emphasis-opacity"]})`,e=`rgba(${x(a.colors["on-surface"])},${a.variables["disabled-opacity"]})`,o=`rgba(${x(String(a.variables["border-color"]))},${a.variables["border-opacity"]})`,l=`rgba(${x(a.colors["on-surface"])},${a.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:t,themeDisabledTextColor:e,themeBorderColor:o,themePrimaryTextColor:l}},C=ot(),{themeBorderColor:da,themeDisabledTextColor:Je}=Qe(C.current.value);function fe(a){if(typeof a!="number"||isNaN(a))return"El valor no es un n\xFAmero v\xE1lido.";if(a<0)return console.log(a),"El valor no es un n\xFAmero v\xE1lido.";let t,e;return a<60?(t=a,e="segundos"):a<3600?(t=a/60,e="minutos"):(t=a/3600,e="horas"),`${parseInt(t)} ${e}`}const De=A(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let l=Array.from(xe.value);const n={name:"Device",data:[]},u=[];for(let c in l){let r=parseFloat(l[c].porcentaje);n.data.push(r),u.push(l[c].section)}const f={chart:{parentHeightOffset:0,type:"donut",events:{dataPointSelection:function(c,r,Y){}}},labels:u,colors:["#7365ed","#9d92f2","#ff7f50","#EE2E31","#ff6347","#00fa9a","#ffa500","#1D7874","#ff4500","#32cd32","#ff1493","#00fa9a","#ff69b4","#9932cc","#ff8c00","#8b008b","#8a2be2"],stroke:{width:0},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:k}){const Z=k.config.series[r];return Z>5?`${Z}%`:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"11px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:"bold",colors:void 0},background:{enabled:!0,foreColor:"#fff",padding:4,borderRadius:2,borderWidth:1,borderColor:"#fff",opacity:1,dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},legend:{position:"bottom",horizontalAlign:"center",offsetX:0,markers:{width:7,height:7},show:!0,formatter:function(c,r){return[c," <br> ",`<div style="margin-top:10px;font-size:17px;color:rgba(var(--v-theme-on-background),var(--v-high-emphasis-opacity))">${r.w.globals.series[r.seriesIndex]}%<small style="font-size:14px"></small></div>`]},labels:{colors:Je,useSeriesColors:!1}},tooltip:{theme:!1,custom:function({series:c,seriesIndex:r,dataPointIndex:Y,w:k}){return`<div class="tooltip-content">
          <div class="tooltip-body">
            <div class="tooltip-title">
              Permanencia de ${$.value.title}<br>
              <small>Muestra de ${M.value} registros</small>
            </div>
            <div class="tooltip-subtitle">
              Secci\xF3n
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                ${k.config.labels[r]}
              </div>
              <div class="tooltip-data-value">
                ${c[r]}%
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Visitas
              </div>
              <div class="tooltip-data-value">
                ${l[r].total}
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Tiempo promedio
              </div>
              <div class="tooltip-data-value">
                ${fe(l[r].promedio)} 
              </div>
            </div>
          </div>
        </div>`}},grid:{padding:{top:15,right:-20,left:-20}},states:{hover:{filter:{type:"none"}}},plotOptions:{pie:{donut:{size:"60%",labels:{show:!1,value:{fontSize:"1.375rem",fontFamily:"Public Sans",color:o,fontWeight:600,offsetY:-15,formatter(c){return`${parseInt(c)}%`}},name:{offsetY:20,fontFamily:"Public Sans"},total:{show:!1,showAlways:!1,color:a.success,fontSize:".8125rem",label:"Total",fontFamily:"Public Sans",formatter(){return"184"}}}}}}};return{series:n.data,options:f}}),Ve=A(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let l=Array.from(we.value);const n={name:"Device",data:[]},u=[];for(let c in l){let r=parseFloat(l[c].porcentaje);n.data.push(r),u.push(l[c].subsection)}const f={chart:{parentHeightOffset:0,type:"donut"},labels:u,colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],stroke:{width:0},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:k}){const Z=k.config.series[r];return Z>5?`${Z}%`:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"11px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:"bold",colors:void 0},background:{enabled:!0,foreColor:"#fff",padding:4,borderRadius:2,borderWidth:1,borderColor:"#fff",opacity:1,dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},legend:{position:"bottom",horizontalAlign:"center",offsetX:0,markers:{width:7,height:7},show:!0,formatter:function(c,r){return[c," <br> ",`<div style="margin-top:10px;font-size:17px;color:rgba(var(--v-theme-on-background),var(--v-high-emphasis-opacity))">${r.w.globals.series[r.seriesIndex]}%<small style="font-size:14px"></small></div>`]},labels:{colors:o,useSeriesColors:!1}},tooltip:{theme:!1,custom:function({series:c,seriesIndex:r,dataPointIndex:Y,w:k}){return`<div class="tooltip-content">
          <div class="tooltip-body">
            <div class="tooltip-title">
              Permanencia de ${$.value.title}<br>
              <small>Muestra de ${M.value} registros</small>
            </div>
            <div class="tooltip-subtitle">
              Secci\xF3n
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                ${k.config.labels[r]}
              </div>
              <div class="tooltip-data-value">
                ${c[r]}%
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Visitas
              </div>
              <div class="tooltip-data-value">
                ${l[r].total}
              </div>
            </div>
            <div class="tooltip-data-flex">
              <div class="tooltip-data-title">
                Tiempo promedio
              </div>
              <div class="tooltip-data-value">
                ${fe(l[r].promedio)} 
              </div>
            </div>
          </div>
        </div>`}},grid:{padding:{top:15,right:-20,left:-20}},states:{hover:{filter:{type:"none"}}},plotOptions:{pie:{donut:{size:"60%",labels:{show:!1,value:{fontSize:"1.375rem",fontFamily:"Public Sans",color:o,fontWeight:600,offsetY:-15,formatter(c){return`${parseInt(c)}%`}},name:{offsetY:20,fontFamily:"Public Sans"},total:{show:!1,showAlways:!1,color:a.success,fontSize:".8125rem",label:"Total",fontFamily:"Public Sans",formatter(){return"184"}}}}}}};return{series:n.data,options:f}});E(async()=>j.value,async()=>{if(j.value,j.value){const a=j.value.value;z.value=a}}),E(async()=>T.value,async()=>{console.log(T.value)});async function Ce(a={}){try{const{fechai:e=g().format("YYYY-MM-DD"),fechaf:o=g().format("YYYY-MM-DD")}=a;var t=await fetch(`https://servicio-permanencia.vercel.app/chart/agrupacion/dias?fechai=${e}&?fechaf=${o}`);const l=await t.json();l.resp&&(K.value=l.data)}catch(e){return console.error(e.message)}}function pe(){return g().add(1,"day").format("YYYY-MM-DD")}const $e=A(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let l=Array.from(K.value);const n={};l.forEach(c=>{c.data.forEach(r=>{n[r.section]||(n[r.section]={name:r.section,data:[]}),n[r.section].data.push([g(c.fecha).add(1,"days").valueOf(),r.totalVistas])})});const u=Object.values(n);w.value=="Hoy"&&u.forEach(c=>{const r=pe();c.data.push([g(r).valueOf(),0])});const f={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Visitas",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return c.toFixed(0)}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return re(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:f}}),Me=A(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let l=Array.from(K.value);const n={};l.forEach(c=>{c.data.forEach(r=>{n[r.section]||(n[r.section]={name:r.section,data:[]}),n[r.section].data.push([g(c.fecha).add(1,"days").valueOf(),parseFloat((r.promedioSegundos/60).toFixed(2))])})});const u=Object.values(n);w.value=="Hoy"&&u.forEach(c=>{const r=pe();c.data.push([g(r).valueOf(),0])});const f={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:k}){return`${c} min`}},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Tiempo promedio en minutos",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return`${c.toFixed(2)} min`}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return re(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:f}}),Te=A(()=>{const a=C.current.value.colors,t=C.current.value.variables,e=`rgba(${x(a.success)},0.2)`,o=`rgba(${x(a["on-background"])},${t["high-emphasis-opacity"]})`;a.success;let l=Array.from(K.value);const n={};l.forEach(c=>{c.data.forEach(r=>{const Y=g(c.fecha).add(1,"days").valueOf();n[Y]||(n[Y]=0),n[Y]+=r.totalVistas})});const u=[{name:"Total de visitas",data:Object.entries(n).map(([c,r])=>[parseInt(c),r])}];w.value=="Hoy"&&u.forEach(c=>{const r=pe();c.data.push([g(r).valueOf(),0])});const f={chart:{parentHeightOffset:0,type:"area",stacked:!1,height:350,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,formatter:function(c,{seriesIndex:r,dataPointIndex:Y,w:k}){return`${c} visitas`}},colors:["#173F5F","#00fa9a","#7365ed","#ff69b4","#000f08","#32cd32","#136f63","#ffd700","#ff4500","#ff0000","#ff8c00","#ffff00","#8b4513","#0000ff","#8a2be2","#ffa500","#ffd800","#ff1493","#9932cc","#ff8c00","#8b008b","#8a2be2"],fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.45,opacityTo:.05,stops:[20,100,100,100]}},yaxis:{title:{text:"Visitas totales",style:{color:o,useSeriesColors:!1}},labels:{style:{colors:o,useSeriesColors:!1},offsetX:0,formatter:function(c){return`${c.toFixed(0)} visitas`}},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{type:"datetime",tickAmount:u[0].data.length-1,labels:{style:{colors:o,useSeriesColors:!1},rotate:-15,rotateAlways:!0,formatter:function(c,r){return re(r).format("DD MMM YYYY")}}},tooltip:{shared:!0},legend:{labels:{colors:o,useSeriesColors:!1},position:"top",horizontalAlign:"right",offsetX:-10}};return{series:u,options:f}}),ke=v([]);fetch("https://servicio-permanencia.vercel.app/get/document/2024-01-12/2024-01-12").then(a=>a.json()).then(a=>{ke.value=a.data});const Ke=A(()=>{const a={"0 a 30 segundos":{total:0,urls:{}},"30 segundos a 1 minuto":{total:0,urls:{}},"1 a 5 minutos":{total:0,urls:{}},"5 a 10 minutos":{total:0,urls:{}},"10 a 30 minutos":{total:0,urls:{}},"30 minutos en adelante":{total:0,urls:{}}};return ke.value.forEach(t=>{let e;const o=t.seconds;o<=30?e="0 a 30 segundos":o<=60?e="30 segundos a 1 minuto":o<=300?e="1 a 5 minutos":o<=600?e="5 a 10 minutos":o<=1800?e="10 a 30 minutos":e="30 minutos en adelante",a[e].urls[t.url]||(a[e].urls[t.url]=[]),a[e].urls[t.url].push(t),a[e].total++}),a}),R=lt({}),Ae=a=>{R[a]===void 0?R[a]=!0:R[a]=!R[a]};return(a,t)=>(b(),_("section",null,[s(ie,null,{default:i(()=>[s(F,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:i(()=>[s(Oe,{modelValue:J.value,"onUpdate:modelValue":t[0]||(t[0]=e=>J.value=e),class:"v-tabs-pill d-none"},{default:i(()=>[s(se,{value:"tab-lista",class:""},{default:i(()=>[h(" Listado ")]),_:1}),s(se,{value:"tab-agregar",class:""},{default:i(()=>[h(" Estad\xEDsticas ")]),_:1})]),_:1},8,["modelValue"]),s(L,{class:"mt-5"},{default:i(()=>[s(it,null,{default:i(()=>[s(Ee,{modelValue:J.value,"onUpdate:modelValue":t[12]||(t[12]=e=>J.value=e)},{default:i(()=>[s(oe,{value:"tab-lista"},{default:i(()=>[s(U,{class:"header_card_item px-3"},{append:i(()=>[]),default:i(()=>[d("div",ft,[d("div",pt,[s(O,{class:"pb-2"},{default:i(()=>[h("Permanencia de usuarios, "+p($.value.title),1)]),_:1}),s(le,null,{default:i(()=>[h("*Muestra el tiempo que ha permanecido un usuario registrado en las p\xE1ginas de ecuavisa.com.")]),_:1}),s(le,null,{default:i(()=>[h("*Mostrando data desde, "+p($.value.i.format("YYYY-MM-DD"))+" hasta "+p($.value.f.format("YYYY-MM-DD")),1)]),_:1}),s(le,null,{default:i(()=>[h("*Este informe se basa en una muestra de "+p(M.value)+" registros",1)]),_:1})])]),s(Pe,{class:"my-5"}),d("div",vt,[d("div",mt,[s(P,{disabled:y.value,modelValue:G.value,"onUpdate:modelValue":t[1]||(t[1]=e=>G.value=e),items:m(te),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])]),d("div",ht,[s(P,{clearable:"",multiple:"",density:"compact",disabled:y.value,modelValue:W.value,"onUpdate:modelValue":t[2]||(t[2]=e=>W.value=e),items:_e.value,variant:"outlined",label:"Seleccionar secciones","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])]),T.value!=1?(b(),_("div",bt,[s(P,{clearable:"",density:"compact",disabled:y.value,modelValue:I.value,"onUpdate:modelValue":t[3]||(t[3]=e=>I.value=e),items:de.value,variant:"outlined",label:"Ordenar registros","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])):H("",!0),T.value!=1?(b(),_("div",gt,[s(P,{clearable:"",density:"compact",disabled:y.value,modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=e=>V.value=e),items:He.value,variant:"outlined",label:"Agrupar registros","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])):H("",!0)])]),_:1}),d("div",yt,[d("div",_t,[s(O,null,{default:i(()=>[h(" Permanencia de usuarios del d\xEDa de hoy ")]),_:1}),s(le,null,{default:i(()=>[h("Muestra el tiempo que ha permanecido un usuario registrado en las p\xE1ginas de ecuavisa.com ")]),_:1})])]),d("div",xt,[s(ie,null,{default:i(()=>[s(F,{cols:"12",sm:"12",class:""},{default:i(()=>[s(Oe,{modelValue:T.value,"onUpdate:modelValue":t[5]||(t[5]=e=>T.value=e),class:"v-tabs-pill"},{default:i(()=>[s(se,{key:"1",value:"1"},{default:i(()=>[s(B,{start:"",icon:"mdi-chart-scatterplot-hexbin"}),h(" Estadisticas ")]),_:1}),s(se,{key:"2",value:"2"},{default:i(()=>[s(B,{start:"",icon:"mdi-clock-time-eight-outline"}),h(" Agrupaci\xF3n por tiempo ")]),_:1})]),_:1},8,["modelValue"]),wt,s(Ee,{modelValue:T.value,"onUpdate:modelValue":t[11]||(t[11]=e=>T.value=e)},{default:i(()=>[s(oe,{class:"d-none",key:"0",value:"0"},{default:i(()=>[S.value.length<1?(b(),ne(ve,{key:0,lines:"two",border:""},{default:i(()=>[s(me,null,{default:i(()=>[s(he,null,{default:i(()=>[Yt]),_:1})]),_:1})]),_:1})):H("",!0),s(ie,null,{default:i(()=>[s(F,{cols:"12",sm:"12",class:""},{default:i(()=>[d("div",St,[Dt,s(nt,{style:{"min-width":"90px"},modelValue:j.value,"onUpdate:modelValue":t[6]||(t[6]=e=>j.value=e),items:Ue,"item-title":"title","item-value":"value",label:"","persistent-hint":"","return-object":"","single-line":""},null,8,["modelValue"]),Vt]),V.value?(b(),_("div",Ct,[s(rt,{class:"text-no-wrap invoice-list-table"},{default:i(()=>[$t,d("tbody",null,[(b(!0),_(N,null,q(m(ue),(e,o)=>(b(),_("tr",{key:o,style:{height:"3.75rem"}},[d("td",Mt,[s(O,{title:e.title,style:{"font-size":"18px"}},{default:i(()=>[d("small",null,p(e.title),1)]),_:2},1032,["title"])]),d("td",null,p(e.section),1),d("td",Tt,[s(be,ze({label:""},{status:"Paid",chip:{color:"success"}},{size:"small"}),{default:i(()=>[h(p(fe(parseInt(e.promedio))),1)]),_:2},1040)]),d("td",kt,[s(be,ze({label:""},{status:"Paid",chip:{color:"success"}},{size:"small"}),{default:i(()=>[h(p(e.total)+" visitas ",1)]),_:2},1040)]),d("td",At,[s(ge,{icon:"",size:"x-small",color:"info",variant:"text",href:e.url,target:"_blank"},{default:i(()=>[s(B,{size:"22",icon:"mdi-link-variant"})]),_:2},1032,["href"])])]))),128))]),Ie(d("tfoot",null,Ot,512),[[je,!m(ue).length]])]),_:1})])):(b(),_("div",Et,[S.value.length>0?(b(),ne(ve,{key:0,lines:"two",border:""},{default:i(()=>[(b(!0),_(N,null,q(m(ue),(e,o)=>(b(),_(N,{key:o},[s(me,{disabled:Re.value},{append:i(()=>[d("div",zt,[s(ge,{icon:"",size:"x-small",color:"info",variant:"text",href:e.url,target:"_blank"},{default:i(()=>[s(B,{size:"22",icon:"mdi-link-variant"})]),_:2},1032,["href"]),s(ge,{icon:"",size:"x-small",color:"info",variant:"text",href:"/apps/user/view/"+e.user.userId,target:"_blank"},{default:i(()=>[s(B,{size:"22",icon:"mdi-account-outline"})]),_:2},1032,["href"])])]),default:i(()=>[s(he,null,{default:i(()=>[h(p(e.user.first_name||"Not Found")+" "+p(e.user.last_name||"")+" ",1),s(be,null,{default:i(()=>[h(" estuvo "+p(We(e.seconds)),1)]),_:2},1024)]),_:2},1024),s(dt,{class:"mt-1",title:"Estado de campa\xF1a"},{default:i(()=>[d("span",Pt,[s(B,{icon:"mdi-web"}),h(": "+p(e.title),1)])]),_:2},1024)]),_:2},1032,["disabled"]),o!==S.value.length-1?(b(),ne(Pe,{key:0})):H("",!0)],64))),128))]),_:1})):H("",!0)])),s(ut,{class:"mt-5",modelValue:ee.value,"onUpdate:modelValue":t[7]||(t[7]=e=>ee.value=e),length:m(Ge),"total-visible":7},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),s(oe,{key:"1",value:"1"},{default:i(()=>[s(ie,null,{default:i(()=>[s(F,{cols:"12",sm:"12",class:""},{default:i(()=>[s(L,{class:"px-0 py-0 pb-4 v-card--flat mb-4 v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:i(()=>[s(U,{class:"header_card_item pb-0"},{default:i(()=>[d("div",It,[d("div",jt,[s(O,null,{default:i(()=>[h("Tiempo de permanencia"),Rt,h(" por secci\xF3n")]),_:1}),d("small",Lt,"Este informe se basa en una muestra de "+p(M.value)+" registros",1)])])]),_:1}),s(m(Q),{options:m(De).options,series:m(De).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(F,{cols:"12",sm:"12",class:""},{default:i(()=>[s(L,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:i(()=>[s(U,{class:"header_card_item pb-0"},{default:i(()=>[d("div",Ut,[d("div",Ht,[s(O,null,{default:i(()=>[h("Tiempo de permanencia "),Bt,h("por subsecci\xF3n"),Nt]),_:1}),d("small",Xt,"Este informe se basa en una muestra de "+p(M.value)+" registros",1)])])]),_:1}),s(m(Q),{options:m(Ve).options,series:m(Ve).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(F,{cols:"12",sm:"12",class:"",style:{}},{default:i(()=>[s(L,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:i(()=>[s(U,{class:"header_card_item pb-0"},{append:i(()=>[d("div",qt,[s(P,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[8]||(t[8]=e=>w.value=e),items:m(te),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:i(()=>[d("div",Gt,[d("div",Wt,[s(O,null,{default:i(()=>[h("Totales por visitas")]),_:1}),d("small",Zt,"Mostrando data desde, "+p(D.value.i.format("YYYY-MM-DD"))+" hasta "+p(D.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(m(Q),{options:m(Te).options,series:m(Te).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(F,{cols:"12",sm:"12",class:"",style:{}},{default:i(()=>[s(L,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:i(()=>[s(U,{class:"header_card_item pb-0"},{append:i(()=>[d("div",ea,[s(P,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=e=>w.value=e),items:m(te),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:i(()=>[d("div",Qt,[d("div",Jt,[s(O,null,{default:i(()=>[h("Visitas por secci\xF3n")]),_:1}),d("small",Kt,"Mostrando data desde, "+p(D.value.i.format("YYYY-MM-DD"))+" hasta "+p(D.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(m(Q),{options:m($e).options,series:m($e).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1}),s(F,{cols:"12",sm:"12",class:"",style:{}},{default:i(()=>[s(L,{class:"px-0 py-0 pb-4 v-card--flat v-theme--light v-card--border v-card--density-default v-card--variant-elevated"},{default:i(()=>[s(U,{class:"header_card_item pb-0"},{append:i(()=>[d("div",oa,[s(P,{disabled:y.value,modelValue:w.value,"onUpdate:modelValue":t[10]||(t[10]=e=>w.value=e),items:m(te),variant:"outlined",label:"Fecha","persistent-hint":"","hide-selected":"",hint:""},null,8,["disabled","modelValue","items"])])]),default:i(()=>[d("div",ta,[d("div",aa,[s(O,null,{default:i(()=>[h("Tiempo promedio por secci\xF3n")]),_:1}),d("small",sa,"Mostrando data desde, "+p(D.value.i.format("YYYY-MM-DD"))+" hasta "+p(D.value.f.format("YYYY-MM-DD")),1)])])]),_:1}),s(m(Q),{options:m(Me).options,series:m(Me).series,height:475,width:"100%"},null,8,["options","series"])]),_:1})]),_:1})]),_:1})]),_:1}),s(oe,{key:"2",value:"2"},{default:i(()=>[(b(!0),_(N,null,q(m(Ke),(e,o)=>(b(),ne(ve,{lines:"two",border:"",key:o},{default:i(()=>[s(me,null,{default:i(()=>[s(he,{onClick:l=>Ae(o)},{default:i(()=>[h(p(o)+": "+p(e.total)+" usuario(s) ",1)]),_:2},1032,["onClick"]),R[o]?(b(),_("div",la,[(b(!0),_(N,null,q(e.urls,(l,n)=>(b(),_("div",{key:n},[d("button",{class:"btn btn-secondary my-2",type:"button",onClick:u=>Ae(n)},p(n)+" ("+p(l.length)+" usuario(s)) ",9,ia),Ie(d("ul",na,[(b(!0),_(N,null,q(l,u=>(b(),_("li",{class:"list-group-item",key:u.id},p(u.user.first_name)+" - "+p(u.seconds)+" segundos ",1))),128))],512),[[je,R[n]]])]))),128))])):H("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{pa as default};
