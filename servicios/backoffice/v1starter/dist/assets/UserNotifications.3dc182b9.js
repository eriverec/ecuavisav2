import{r as _,o,c as U,w as t,a as e,g as se,aQ as pe,aR as Ve,q as d,h as z,l as De,u as s,i as J,m as he,V as le,e as P,n as te,c7 as He,p as C,b0 as ke,bc as $e,M as je,bG as Ce,cy as Ye,as as Ne,x as i,f as ge,t as n,X as fe,d as ze,b as a,a2 as Ae,Z as Fe,$ as L,a0 as S,F as O,C as G,aM as we,a3 as me,bd as Le,be as Se,R as qe,S as Re,U as Be,v as ae,b7 as Ee,b8 as X,N as Q,b9 as Ze,ba as K,aW as ee,bV as Oe}from"./index.88d3c7f5.js";import{r as xe}from"./validators.b5f8ddc5.js";import{a as Qe}from"./formatters.a9a9bf7f.js";import{V as Ge,a as _e}from"./VTimelineItem.36b36f8a.js";import{V as ye}from"./VCheckbox.50e352e3.js";const Je={__name:"UserInfoEditDialog",props:{userData:{type:Object,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["update:modelValue","submit","update:isDialogVisible"],setup(H,{emit:b}){const l=H,k=_(!1),g=_(),m=_({first_name:l.userData.first_name,last_name:l.userData.last_name,contrase\u00F1a:"",newsletter_opt_in:l.userData.newsletter_opt_in});console.log("sin",m),console.log("value",m._rawValue);const y=()=>{var p;(p=g.value)==null||p.validate().then(({valid:v})=>{v&&(b("update:modelValue",!1),b("update:isDialogVisible",!1),b("submit",m._rawValue))})},x=()=>{b("update:isDialogVisible",!1)},$=p=>{b("update:isDialogVisible",p)};return(p,v)=>{const D=$e;return o(),U(ke,{width:p.$vuetify.display.smAndDown?"auto":700,"model-value":l.isDialogVisible,"onUpdate:modelValue":$},{default:t(()=>[e(D,{onClick:v[0]||(v[0]=u=>$(!1))}),e(se,{class:"pa-sm-14 pa-5"},{default:t(()=>[e(pe,{class:"text-center"},{default:t(()=>[e(Ve,{class:"text-h5 mb-3"},{default:t(()=>[d(" Editar la informaci\xF3n del usuario ")]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(De,{ref_key:"refForm",ref:g,modelValue:s(k),"onUpdate:modelValue":v[5]||(v[5]=u=>J(k)?k.value=u:null),class:"mt-6",onSubmit:he(y,["prevent"])},{default:t(()=>[e(le,null,{default:t(()=>[e(P,{cols:"12",md:"6"},{default:t(()=>[e(te,{modelValue:s(m).first_name,"onUpdate:modelValue":v[1]||(v[1]=u=>s(m).first_name=u),rules:[s(xe)],label:"Nombres"},null,8,["modelValue","rules"])]),_:1}),e(P,{cols:"12",md:"6"},{default:t(()=>[e(te,{modelValue:s(m).last_name,"onUpdate:modelValue":v[2]||(v[2]=u=>s(m).last_name=u),rules:[s(xe)],label:"Apellidos"},null,8,["modelValue","rules"])]),_:1}),e(P,{cols:"12",md:"6"},{default:t(()=>[e(te,{modelValue:s(m).contrase\u00F1a,"onUpdate:modelValue":v[3]||(v[3]=u=>s(m).contrase\u00F1a=u),label:"Contrase\xF1a"},null,8,["modelValue"])]),_:1}),e(P,{cols:"12"},{default:t(()=>[e(He,{modelValue:s(m).newsletter_opt_in,"onUpdate:modelValue":v[4]||(v[4]=u=>s(m).newsletter_opt_in=u),density:"compact",label:"Suscribirse al bolet\xEDn"},null,8,["modelValue"])]),_:1}),e(P,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(C,{type:"submit"},{default:t(()=>[d(" Enviar ")]),_:1}),e(C,{color:"secondary",variant:"tonal",onClick:x},{default:t(()=>[d(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};const ve=H=>(Le("data-v-81fe6b20"),H=H(),Se(),H),We={key:1,class:"text-5xl font-weight-semibold"},Xe={class:"text-h6 mt-4"},Ke={class:"d-flex align-center me-4 mb-2"},et=ve(()=>a("h6",{class:"text-base font-weight-semibold"}," Newsletter ",-1)),tt={id:"newsletter_list_user",class:"text-body-2"},at={class:"d-flex align-center me-4 mb-2"},st=ve(()=>a("h6",{class:"text-base font-weight-semibold"}," Proveedor ",-1)),lt={class:"text-sm"},ot=ve(()=>a("p",{class:"text-sm text-uppercase text-disabled"}," Detalles ",-1)),nt={class:"text-base font-weight-semibold"},it={class:"text-body-2"},rt={key:1},dt={class:"text-base font-weight-semibold"},ct={class:"text-body-2"},ut={class:"text-base font-weight-semibold"},ft={class:"text-body-2"},_t={class:"text-base font-weight-semibold"},mt={key:0,class:"text-capitalize text-body-2"},pt={key:1,class:"text-body-2",label:"",color:"warning"},ht={class:"text-base font-weight-semibold"},vt={key:0,class:"text-capitalize text-body-2"},bt={key:1,class:"text-body-2",label:"",color:"warning"},gt={class:"text-base font-weight-semibold"},wt={key:0,class:"text-body-2"},xt={key:1,class:"text-body-2",label:"",color:"warning"},yt={class:"text-base font-weight-semibold"},Vt={key:0,class:"text-body-2"},Dt={key:1,class:"text-body-2",label:"",color:"warning"},kt={class:"text-base font-weight-semibold"},$t={key:0,class:"text-body-2"},Ct={key:1,class:"text-body-2",label:"",color:"warning"},Yt={class:"text-base font-weight-semibold"},Nt={key:0,class:"text-body-2"},Tt={key:1,class:"text-body-2",label:"",color:"warning"},It={__name:"UserBioPanel",props:{userData:{type:Object,required:!0}},emits:["reload"],setup(H,{emit:b}){const l=H,k=Ce(),g=Ye(),m="No configurado",y=w=>w==="google"?{color:"warning",icon:'<svg aria-hidden="true" class="native svg-icon iconGoogle" width="2rem" height="2rem" viewBox="0 0 18 18"><path d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18Z" fill="#4285F4"></path><path d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17Z" fill="#34A853"></path><path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07Z" fill="#FBBC05"></path><path d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3Z" fill="#EA4335"></path></svg>'}:w==="facebook"?{color:"success",icon:'<svg width="2rem" height="2rem" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M18 9C18 4.02944 13.9706 0 9 0C4.02944 0 0 4.02944 0 9C0 13.4922 3.29117 17.2155 7.59375 17.8906V11.6016H5.30859V9H7.59375V7.01719C7.59375 4.76156 8.9374 3.51562 10.9932 3.51562C11.9779 3.51562 13.0078 3.69141 13.0078 3.69141V5.90625H11.8729C10.7549 5.90625 10.4062 6.6 10.4062 7.31175V9H12.9023L12.5033 11.6016H10.4062V17.8906C14.7088 17.2155 18 13.4922 18 9Z" fill="#1877F2"/></svg>'}:{color:"primary",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33.39 14" width="2rem" height="2rem"><g id="Capa_2" data-name="Capa 2"><g id="logo"><path d="M14.19,12.16a1.66,1.66,0,0,0-1.66-1.66H1.66a1.66,1.66,0,0,0,0,3.32H12.53A1.66,1.66,0,0,0,14.19,12.16Z" style="fill:#7367f0"/><path d="M32.52.19a1.68,1.68,0,0,0-2.25.68L25.09,9.14,20.23.77A1.72,1.72,0,0,0,18.77.08H7.82a1.66,1.66,0,0,0,0,3.32h9.53a1,1,0,0,1,.78.36l5.39,9.3a1.71,1.71,0,0,0,.71.75,1.66,1.66,0,0,0,2.25-.68L33.19,2.44A1.67,1.67,0,0,0,32.52.19Z" style="fill:#7367f0"/><path d="M19.25,13.83a1.65,1.65,0,0,0,.79-2.2s-2.38-4-3.24-5.74a1.12,1.12,0,0,0-1-.63H4.48a1.66,1.66,0,0,0,0,3.32H14a.65.65,0,0,1,.58.29C15.41,10.55,17,13,17,13.05A1.65,1.65,0,0,0,19.25,13.83Z" style="fill:#7367f0"/></g></g></svg>'},x=_(!1);_(!1);const $=_(!1),p=_({new:"",confirm:""}),v=_(!1),D=_(""),u=_(!1),I='<svg xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="#7367f0" d="M4 20q-.825 0-1.412-.587Q2 18.825 2 18V6q0-.825.588-1.412Q3.175 4 4 4h16q.825 0 1.413.588Q22 5.175 22 6v12q0 .825-.587 1.413Q20.825 20 20 20Zm8-7.175q.125 0 .262-.038q.138-.037.263-.112L19.6 8.25q.2-.125.3-.312q.1-.188.1-.413q0-.5-.425-.75T18.7 6.8L12 11L5.3 6.8q-.45-.275-.875-.013Q4 7.05 4 7.525q0 .25.1.437q.1.188.3.288l7.075 4.425q.125.075.263.112q.137.038.262.038Z"/></svg>',q=w=>{console.log("datos a enviar",w),console.log("id",g.params.id),k.updateUser(w,g.params.id),b("reload")};async function oe(){try{if(p.value.new&&p.value.confirm){if(p.value.new!==p.value.confirm)return v.value=!0,D.value="Las contrase\xF1as no coinciden";var w=new Headers;w.append("Content-Type","application/json");var h=JSON.stringify({email:l.userData.email,password:p.value.new}),Z={method:"PUT",headers:w,body:h,redirect:"follow"};await fetch("https://ecuavisa-login-service.onrender.com/changePassword",Z).then(T=>T.json()).then(T=>{D.value=T.mensaje,u.value=!0,ie()}).catch(T=>console.log("error",T))}}catch(T){console.error(T.message)}}const ne=w=>{$.value=w,w===!1&&(p.value.new="",p.value.confirm="")},ie=()=>{p.value.new="",p.value.confirm="",$.value=!1},Y=_(""),A=_("");return Ne(async()=>{try{const h=await(await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/sendpulse/token.php")).text(),Z=l.userData.email,W=(await(await fetch(`https://api.sendpulse.com/emails/${Z}/details`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+h},redirect:"follow"})).json()).map(de=>de.list_name);if(Y.value=W,Y.value.length>=1)A.value="True";else return A.value="False",!1}catch(w){console.error("Error:",w)}}),(w,h)=>{const Z=Je,T=$e;return o(),i(O,null,[e(le,null,{default:t(()=>[e(ge,{modelValue:s(v),"onUpdate:modelValue":h[0]||(h[0]=V=>J(v)?v.value=V:null),color:"error",transition:"scale-transition",location:"top center"},{default:t(()=>[d(n(s(D)),1)]),_:1},8,["modelValue"]),e(ge,{modelValue:s(u),"onUpdate:modelValue":h[1]||(h[1]=V=>J(u)?u.value=V:null),color:"success",transition:"scale-transition",location:"top center"},{default:t(()=>[d(n(s(D)),1)]),_:1},8,["modelValue"]),e(P,{cols:"12"},{default:t(()=>[l.userData?(o(),U(se,{key:0},{default:t(()=>[e(z,{class:"text-center pt-15"},{default:t(()=>[e(fe,{rounded:"",size:120,color:"primary",variant:"tonal"},{default:t(()=>[l.userData.avatar?(o(),U(ze,{key:0,src:l.userData.avatar},null,8,["src"])):(o(),i("span",We,n(s(Qe)(l.userData.first_name+" "+l.userData.last_name)),1))]),_:1}),a("h6",Xe,n(l.userData.first_name+" "+l.userData.last_name),1)]),_:1}),e(z,{class:"d-flex justify-center flex-wrap mt-3"},{default:t(()=>[a("div",Ke,[e(fe,{innerHTML:I,rounded:"",color:"primary",variant:"tonal",class:"me-3"}),a("div",null,[et,a("span",tt,n(s(A)),1)])]),a("div",at,[e(fe,{innerHTML:y(l.userData.provider).icon,size:"38",rounded:"",color:"primary",variant:"tonal",class:"me-3"},null,8,["innerHTML"]),a("div",null,[st,a("span",lt,n(l.userData.provider),1)])])]),_:1}),e(Ae),e(z,null,{default:t(()=>[ot,e(Fe,{class:"card-list mt-2"},{default:t(()=>[e(L,null,{default:t(()=>[e(S,{class:"item_news"},{default:t(()=>[a("h6",nt,[d(" Newsletter: "),a("span",it,[s(Y).length?(o(!0),i(O,{key:0},G(s(Y),(V,W)=>(o(),U(we,{class:"block_news",key:W},{default:t(()=>[d(n(V),1)]),_:2},1024))),128)):(o(),i("div",rt,[e(we,null,{default:t(()=>[d("Cargando...")]),_:1})]))])])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",dt,[d(" Nombre: "),a("span",ct,n(l.userData.first_name+" "+l.userData.last_name),1)])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",ut,[d(" Email: "),a("span",ft,n(l.userData.email),1)])]),_:1})]),_:1}),e(L,{style:{display:"none"}},{default:t(()=>[e(S,null,{default:t(()=>[a("h6",_t,[d(" Prefijo tel\xE9fono: "),l.userData.phone_prefix.length>0?(o(),i("span",mt,n(l.userData.phone_prefix),1)):(o(),i("span",pt,n(m)))])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",ht,[d(" Tel\xE9fono: "),l.userData.phone_number.length>0?(o(),i("span",vt,n(l.userData.phone_number),1)):(o(),i("span",bt,n(m)))])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",gt,[d(" G\xE9nero: "),l.userData.gender.length>0?(o(),i("span",wt,n(l.userData.gender),1)):(o(),i("span",xt,n(m)))])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",yt,[d(" Nacimiento: "),l.userData.birth_date.length>0?(o(),i("span",Vt,n(l.userData.birth_date),1)):(o(),i("span",Dt,n(m)))])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",kt,[d(" Tipo de ID: "),l.userData.identification_type.length>0?(o(),i("span",$t,n(l.userData.identification_type),1)):(o(),i("span",Ct,n(m)))])]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(S,null,{default:t(()=>[a("h6",Yt,[d(" N\xFAmero de ID: "),l.userData.identification_number.length>0?(o(),i("span",Nt,n(l.userData.identification_number||""),1)):(o(),i("span",Tt,n(m)))])]),_:1})]),_:1})]),_:1})]),_:1}),e(z,{class:"d-flex justify-center"},{default:t(()=>[e(C,{variant:"elevated",class:"me-3",onClick:h[2]||(h[2]=V=>$.value=!0)},{default:t(()=>[d(" Actualizar contrase\xF1a ")]),_:1}),e(C,{variant:"elevated",class:"me-3 d-none",onClick:h[3]||(h[3]=V=>x.value=!0)},{default:t(()=>[d(" Editar ")]),_:1}),e(C,{variant:"tonal",class:"d-none",color:"error"},{default:t(()=>[d(" Suspender ")]),_:1})]),_:1})]),_:1})):me("",!0)]),_:1})]),_:1}),e(Z,{isDialogVisible:s(x),"onUpdate:isDialogVisible":h[4]||(h[4]=V=>J(x)?x.value=V:null),"user-data":l.userData,onSubmit:q},null,8,["isDialogVisible","user-data"]),e(ke,{width:w.$vuetify.display.smAndDown?"auto":700,"model-value":s($),"onUpdate:modelValue":ne},{default:t(()=>[e(T,{onClick:h[5]||(h[5]=V=>ne(!1))}),e(se,{class:"pa-sm-14 pa-5"},{default:t(()=>[e(pe,{class:"text-center"},{default:t(()=>[e(Ve,{class:"text-h5 mb-3"},{default:t(()=>[d(" Actualizar contrase\xF1a ")]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(De,{class:"mt-6",onSubmit:h[8]||(h[8]=he(V=>oe(),["prevent"]))},{default:t(()=>[e(le,{class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(P,{cols:"8"},{default:t(()=>[e(te,{modelValue:s(p).new,"onUpdate:modelValue":h[6]||(h[6]=V=>s(p).new=V),label:"Contrase\xF1a nueva"},null,8,["modelValue"])]),_:1}),e(P,{cols:"8"},{default:t(()=>[e(te,{modelValue:s(p).confirm,"onUpdate:modelValue":h[7]||(h[7]=V=>s(p).confirm=V),label:"Confirmar contrase\xF1a"},null,8,["modelValue"])]),_:1}),e(P,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(C,{type:"submit"},{default:t(()=>[d(" Enviar ")]),_:1}),e(C,{color:"secondary",variant:"tonal",onClick:ie},{default:t(()=>[d(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])],64)}}},Ya=je(It,[["__scopeId","data-v-81fe6b20"]]),Mt={class:"pt-4 pl-4"},Ut={class:"d-flex justify-space-between align-center flex-wrap"},Pt=a("h4",{class:"text-base font-weight-semibold me-1"}," \xDAltimo inicio de sesi\xF3n ",-1),Ht={class:"text-sm text-disabled text-no-wrap"},jt={class:"mb-1"},zt={class:"d-flex justify-space-between align-center flex-wrap"},At=a("h4",{class:"text-base font-weight-semibold me-1"}," \xDAltima modificaci\xF3n del usuario ",-1),Ft={class:"text-sm text-disabled text-no-wrap"},Lt={class:"mb-0"},St={class:"d-flex justify-space-between align-center flex-wrap"},qt=a("h4",{class:"text-base font-weight-semibold me-1"}," Creaci\xF3n del usuario ",-1),Rt={class:"text-sm text-disabled text-no-wrap"},Bt={class:"mb-0"},Et=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"T\xEDtulo")])],-1),Zt={style:{height:"3rem"}},Ot={key:1},Qt={key:0},Gt=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"P\xE1gina"),a("th",{scope:"col"},"Cantidad")])],-1),Jt={class:"clickable"},Wt={class:"text-high-emphasis"},Xt={class:"text-medium-emphasis"},Kt={class:"d-flex align-center justify-space-between botonescurrentPage"},ea={key:2},ta={key:0},aa=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"T\xEDtulo")])],-1),sa={class:"clickable"},la={class:"text-high-emphasis"},oa={class:"d-flex align-center justify-space-between botonescurrentPage"},na={key:2},ia={key:0},ra=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"T\xEDtulo")])],-1),da={class:"clickable"},ca={class:"text-high-emphasis"},ua={class:"d-flex align-center justify-space-between botonescurrentPage"},fa={key:2},Na={__name:"UserTabOverview",props:{userData:{type:Object,required:!0}},setup(H){const b=H,l=qe.exports.extendMoment(Re);l.locale("es",[Be]),_(0),_(0),_(0);const k=_(""),g=_([]),m=_([]),y=8,x=_(1),$=_(!1);async function p(){await fetch(`https://sugerencias-ecuavisa.vercel.app/interes/all?userId=${b.userData.wylexId}`).then(f=>f.json()).then(f=>{let r=f.data,c=Array.from(f.dataInteresSeguido);const j=[];for(let R in c){let F=r.find(B=>B.interesId==c[R].interesId);j.push(F)}g.value=j})}async function v(){$.value=!0;const r=await(await fetch("https://servicio-de-actividad.vercel.app/actividad/usuario/"+b.userData.wylexId)).json();if(r.resp===!1&&($.value=!1),r.resp===!0){const R=r.data;console.log("trazabilidad ",R);const F=[];for(let N of R.navigationRecord){var c=["DD/MM/YYYY","DD/M/YYYY","M/DD/YYYY","YYYY-MM-DD","DD-MM-YYYY","D/M/YYYY"],j=["DD/MM/YYYY HH:mm:ss","DD/MM/YYYY H:mm:ss","DD/MM/YYYY H:mm:ss a","DD/MM/YYYY HH:mm:ss a"];let M=l(N.fecha,c,!0).format("DD/MM/YYYY"),E=N.hora.split(":");if(E[2].indexOf(" ")>=0){let Pe=E[2].split(" ");E[2]=Pe[0]}let re=E[0]+":"+E[1]+":"+E[2],Ie=M+" "+re,Me=l(Ie,j,!0).format(),Ue={url:N.url,title:N.title,fecha:M,fechaRaw:N.fecha,fullFecha:Me,hora:re};F.push(Ue)}F.sort((N,M)=>{var E=new Date(N.fullFecha),re=new Date(M.fullFecha);return re-E});let B={};F.forEach(N=>{let M=N.title;B.hasOwnProperty(M)?B[M].cantidad=(B[M].cantidad||1)+1:(N.cantidad=1,B[M]=N)});let be=Object.values(B);be.sort((N,M)=>M.cantidad-N.cantidad),m.value=be,$.value=!1}}const D=_(1),u=_([]),I=_(!1);async function q(){try{I.value=!0;const r=await(await fetch("https://servicio-de-actividad.vercel.app/recomendadas/"+b.userData.wylexId)).json();r.resp&&(u.value=r.data),I.value=!1}catch(f){console.error(f)}}const oe=ae(()=>{const f=(D.value-1)*y,r=f+y;return u.value.slice(f,r)}),ne=()=>{D.value*y<u.value.length&&D.value++},ie=()=>{D.value>1&&D.value--},Y=_(1),A=_([]),w=_(!1);async function h(){try{w.value=!0;const r=await(await fetch("https://servicio-de-actividad.vercel.app/recomendadasIntereses/"+b.userData.wylexId)).json();r.resp&&(A.value=r.data),w.value=!1}catch(f){console.error(f)}}const Z=ae(()=>{const f=(Y.value-1)*y,r=f+y;return A.value.slice(f,r)}),T=()=>{Y.value*y<A.value.length&&Y.value++},V=()=>{Y.value>1&&Y.value--};Ne(async()=>{await p(),await v(),await q(),await h()});const W=ae(()=>{const f=(x.value-1)*y,r=f+y;return m.value.slice(f,r)}),de=()=>{x.value*y<m.value.length&&x.value++},Te=()=>{x.value>1&&x.value--},ce=function(f){let r;if(f.includes("T")){let c=f.split("T");if(c[1].includes("-")){let j=c[1].split("-");r=c[0]+" "+j[0]}else r=c[0]+" "+c[1]}else r=f;return r};var ue=function(f){if(f){const r=l(),c=l(f,"YYYY-MM-DD HH:mm:ss"),j=r.diff(c,"seconds");if(j<60&&j>-1)return"Hace "+j+" segundos";{const R=r.diff(c,"minutes");if(R<60&&R>-1)return"Hace "+R+" minutos";{const F=r.diff(c,"hours");return F<24&&F>-1?"Hace "+F+" horas":"Hace "+r.diff(c,"days")+" d\xEDas"}}}else return null};return(f,r)=>(o(),U(le,null,{default:t(()=>[e(P,{cols:"12"},{default:t(()=>[e(se,null,{default:t(()=>[a("div",Mt,[e(Ee,{modelValue:s(k),"onUpdate:modelValue":r[0]||(r[0]=c=>J(k)?k.value=c:null),class:"v-tabs-pill"},{default:t(()=>[e(X,{value:"tab-actividad"},{default:t(()=>[e(Q,{size:"16",class:"me-2",icon:"tabler-activity-heartbeat"}),d(" Actividad ")]),_:1}),e(X,{value:"tab-intereses"},{default:t(()=>[e(Q,{size:"16",class:"me-2",icon:"tabler-eye-star"}),d(" Intereses ")]),_:1}),e(X,{value:"tab-trazabilidad"},{default:t(()=>[e(Q,{size:"16",class:"me-2",icon:"tabler-binary-tree-2"}),d(" Trazabilidad ")]),_:1}),e(X,{value:"tab-notasRecomendadas"},{default:t(()=>[e(Q,{size:"16",class:"me-2",icon:"tabler-binary-tree-2"}),d(" Notas recomendadas ")]),_:1}),e(X,{value:"tab-notasIntereses"},{default:t(()=>[e(Q,{size:"16",class:"me-2",icon:"tabler-binary-tree-2"}),d(" Notas por intereses ")]),_:1})]),_:1},8,["modelValue"])]),e(pe,null,{default:t(()=>[e(Ze,{modelValue:s(k),"onUpdate:modelValue":r[1]||(r[1]=c=>J(k)?k.value=c:null)},{default:t(()=>[e(K,{value:"tab-actividad"},{default:t(()=>[e(Ge,{density:"compact",align:"start","truncate-line":"both",class:"v-timeline-density-compact"},{default:t(()=>[e(_e,{"dot-color":"primary",size:"x-small"},{default:t(()=>[a("div",Ut,[Pt,a("span",Ht,n(s(ue)(b.userData.logged_at)),1)]),a("p",jt,n(ce(b.userData.logged_at)),1)]),_:1}),e(_e,{"dot-color":"info",size:"x-small"},{default:t(()=>[a("div",zt,[At,a("span",Ft,n(s(ue)(b.userData.updated_at)),1)]),a("p",Lt,n(ce(b.userData.updated_at)||"No se han realizado modificaciones"),1)]),_:1}),e(_e,{"dot-color":"success",size:"x-small"},{default:t(()=>[a("div",St,[qt,a("span",Rt,n(s(ue)(b.userData.created_at)),1)]),a("p",Bt,n(ce(b.userData.created_at)),1)]),_:1})]),_:1})]),_:1}),e(K,{value:"tab-intereses"},{default:t(()=>[s(g).length?(o(),U(ee,{key:0,class:"text-no-wrap"},{default:t(()=>[Et,a("tbody",null,[(o(!0),i(O,null,G(s(g),c=>(o(),i("tr",Zt,[a("td",null,n(c.title),1)]))),256))])]),_:1})):(o(),i("div",Ot,"No hay intereses que mostrar."))]),_:1}),e(K,{value:"tab-trazabilidad"},{default:t(()=>[s($)?(o(),i("div",Qt,"Cargando datos..")):s(m).length>0?(o(),U(z,{key:1},{default:t(()=>[e(ee,{class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:t(()=>[Gt,a("tbody",null,[(o(!0),i(O,null,G(s(W),c=>(o(),i("tr",Jt,[a("td",Wt,n(c.title?c.title:c.url),1),a("td",Xt,n(c.cantidad),1)]))),256))])]),_:1}),a("div",Kt,[e(C,{icon:"tabler-arrow-big-left-lines",onClick:Te,disabled:s(x)===1},null,8,["disabled"]),d(" P\xE1gina "+n(s(x))+" ",1),e(C,{icon:"tabler-arrow-big-right-lines",onClick:de,disabled:s(x)*y>=s(m).length},null,8,["disabled"])])]),_:1})):(o(),i("div",ea,"No existen datos de trazabilidad"))]),_:1}),e(K,{value:"tab-notasRecomendadas"},{default:t(()=>[s(I)?(o(),i("div",ta,"Cargando datos..")):s(u).length>0?(o(),U(z,{key:1},{default:t(()=>[e(ee,{class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:t(()=>[aa,a("tbody",null,[(o(!0),i(O,null,G(s(oe),c=>(o(),i("tr",sa,[a("td",la,n(c.title),1)]))),256))])]),_:1}),a("div",oa,[e(C,{icon:"tabler-arrow-big-left-lines",onClick:ie,disabled:s(D)===1},null,8,["disabled"]),d(" P\xE1gina "+n(s(D))+" ",1),e(C,{icon:"tabler-arrow-big-right-lines",onClick:ne,disabled:s(D)*y>=s(u).length},null,8,["disabled"])])]),_:1})):(o(),i("div",na,"No ha navegado lo suficiente para recomendar notas"))]),_:1}),e(K,{value:"tab-notasIntereses"},{default:t(()=>[s(w)?(o(),i("div",ia,"Cargando datos..")):s(A).length>0?(o(),U(z,{key:1},{default:t(()=>[e(ee,{class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:t(()=>[ra,a("tbody",null,[(o(!0),i(O,null,G(s(Z),c=>(o(),i("tr",da,[a("td",ca,n(c.title),1)]))),256))])]),_:1}),a("div",ua,[e(C,{icon:"tabler-arrow-big-left-lines",onClick:V,disabled:s(Y)===1},null,8,["disabled"]),d(" P\xE1gina "+n(s(Y))+" ",1),e(C,{icon:"tabler-arrow-big-right-lines",onClick:T,disabled:s(Y)*y>=s(A).length},null,8,["disabled"])])]),_:1})):(o(),i("div",fa,"No existen notas para mostrar"))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}))}},_a={scope:"col"},ma=a("th",{scope:"col"},[a("h6",{class:"text-base"},"Nombre")],-1),pa={scope:"col"},ha={style:{"text-align":"right"}},va={class:"d-flex align-center"},ba={class:"d-flex flex-column"},ga={class:"d-flex align-center"},wa={class:"d-flex flex-column"},xa=a("td",null,[a("div",{class:"d-flex align-center"},[a("div",{class:"d-flex flex-column"})])],-1),ya={key:1},Ta={__name:"UserNotifications",setup(H){const b=Ce(),l=_([]),k=Ye(),g=_([]),m=()=>{b.fetchNotification(Number(k.params.id)).then(u=>{l.value=u.data.usuario.Notificaciones,console.log("Notificaciones",l.value)})};m();const y=u=>{const I=g.value.indexOf(u);I===-1?g.value.push(u):g.value.splice(I,1)},x=ae(()=>l.value.length&&l.value.length===g.value.length),$=ae(()=>Boolean(g.value.length)&&l.value.length!==g.value.length),p=()=>{g.value=x.value?[]:l.value.map(u=>u.title)},v=()=>{g.value=[],m()},D=()=>{b.deleteNotification(Number(k.params.id),g.value),window.setTimeout(v,900)};return(u,I)=>(o(),U(le,null,{default:t(()=>[e(P,{cols:"12"},{default:t(()=>[e(se,{title:"Notificaciones del usuario"},{prepend:t(()=>[e(Q,{size:"1.5rem",icon:"tabler-bell-ringing"})]),default:t(()=>[e(z,null,{default:t(()=>[s(l).length?(o(),U(ee,{key:0,class:"text-no-wrap"},{default:t(()=>[a("thead",null,[a("tr",null,[a("th",_a,[e(ye,{"model-value":s(x),indeterminate:s($),"onUpdate:modelValue":p},null,8,["model-value","indeterminate"])]),ma,a("th",pa,[a("div",ha,[e(C,{"prepend-icon":"tabler-trash",color:"error",style:Oe({visibility:s($)||s(x)?void 0:"hidden"}),onClick:D},{default:t(()=>[d(" Eliminar ")]),_:1},8,["style"])])])])]),a("tbody",null,[(o(!0),i(O,null,G(s(l),q=>(o(),i("tr",{key:q.title,style:{height:"3.75rem"}},[a("td",null,[a("div",va,[a("div",ba,[e(ye,{"model-value":s(g).includes(q.title),"onUpdate:modelValue":oe=>y(q.title),onClick:I[0]||(I[0]=he(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])])])]),a("td",null,[a("div",ga,[a("div",wa,n(q.title),1)])]),xa]))),128))])]),_:1})):me("",!0),s(l).length?me("",!0):(o(),i("div",ya,"No hay notificaciones que mostrar."))]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Ya as U,Na as _,Ta as a};
