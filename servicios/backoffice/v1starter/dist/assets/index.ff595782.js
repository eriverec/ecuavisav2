import{r as d,I as pe,as as me,v as fe,z as ve,o as p,x as k,u as r,c as y,w as l,a,N as S,p as v,a3 as D,b as o,a2 as J,Z as G,F as U,C as R,$ as ge,a0 as he,q as m,t as E,a1 as be,i as z,f as _e,b8 as j,b7 as ye,ba as q,g as F,h as I,V as L,e as h,aT as Ve,b3 as we,b4 as xe,b5 as Ce,aM as X,c7 as $,b6 as Te,aW as ke,n as B,aq as Z,b9 as He,aX as Se}from"./index.88d3c7f5.js";import{V as ze}from"./VBadge.0df54a63.js";import{V as Pe}from"./VNavigationDrawer.44422f4c.js";import{V as K}from"./VTooltip.2d0a8708.js";import{V as De}from"./VTextarea.86fae113.js";const Ue={class:"custom-heading d-flex align-center justify-space-between"},Ee=o("div",null,[o("h6",{class:"text-h6 py-4 pl-4"}," Usuarios activos en configuraci\xF3n "),o("span",{class:"text-body-1"})],-1),Ie={style:{padding:"1rem"}},Oe=o("span",{class:"ms-4"},"Online",-1),Ne=o("h3",null,"Se ha guardado la configuraci\xF3n exitosamente",-1),Ae={style:{padding:"1rem",border:"1px solid rgba(var(--v-theme-on-background), var(--v-disabled-opacity))","border-radius":"7px"}},Re={scope:"col",class:"d-flex gap-4 pb-4"},je=o("tr",null,[o("th",{scope:"col",style:{width:"300px"}},"T\xEDtulo"),o("th",{scope:"col",style:{width:"170px"}},"Hora de inicio"),o("th",{scope:"col",style:{width:"170px"}},"Hora de fin"),o("th",{scope:"col",class:"d-flex gap-4 pb-4"})],-1),qe={class:"py-4"},Fe={class:"py-4"},Le={class:"py-4"},$e={class:"py-4"},Be={class:"d-flex gap-4 py-4"},Me={style:{width:"650px","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-3"},We=o("span",null,"Este titular aparecer\xE1 en lugar del t\xEDtulo del programa sobre el reproductor",-1),Je={style:{width:"650px","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-3"},Ge=o("span",null,"Este texto es el que aparece en el indicador que parpadea sobre el header",-1),Xe={style:{display:"flex",margin:"1rem"}},Ze={style:{"margin-left":"2rem"}},Ke=o("div",null,[o("span",null,"Estado del player: ")],-1),Qe={style:{"margin-left":"2rem"}},Ye={style:{width:"100%","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-2"},ra={__name:"index",setup(ea){d(!1);const Q=d(!1),c=d(!1),Y=pe(),O=d(!1),V=d("tab-detalles"),b=d(""),f=d([]),N=d([]);d(""),d("");const ee=d(""),ae=d(!1),w=d(!1),M=[{title:"Lunes",value:1},{title:"Martes",value:2},{title:"Mi\xE9rcoles",value:3},{title:"Jueves",value:4},{title:"Viernes",value:5},{title:"S\xE1bado",value:6},{title:"Domingo",value:0}];async function P(){O.value=!0;const t=await(await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=web&key=horarioRadio")).json();console.log("dataRAW: ",t),Q.value=t.forzado,c.value=t.forzado,f.value=Array.from(t.horarios),N.value=Array.from(t.horarios),ee.value=t.html.value,ae.value=t.html.estadoHtml,w.value=t.html,O.value=!1}me(()=>{ce(),ie(),P()});const A=fe(()=>{if(f.value.length>0){f.value=f.value.sort(function(n,u){return n.dia-u.dia});const s=f.value.map(n=>n.dia);return M.filter(n=>!s.includes(n.value))}});function le(s){return M.filter(n=>s===n.value)[0].title}const te=()=>{if(b.value){let s={dia:b.value,estadoDia:!0,horas:[{tituloPrograma:"",estadoHorario:!0,inicio:"12:00",fin:"14:00"}]};f.value.push(s),b.value=""}},oe=s=>{f.value.splice(s,1)},se=s=>{let t={tituloPrograma:"",estadoHorario:!0,inicio:"12:00",fin:"14:00"};f.value[s].horas.push(t)},re=(s,t)=>{f.value[s].horas.splice(t,1)},ie=()=>{let s=localStorage.getItem("role");s!=="administrador"&&s!=="webmaster"&&Y.push({path:"/pages/errors/not-authorized"})},x=d(!1);async function ne(){let s={key:"horarioRadio",estructura:{html:w.value,forzado:c.value,horarios:f.value}};console.log("datos a enviar ",s);var t=new Headers;t.append("Content-Type","application/json");var n=JSON.stringify(s),u={method:"POST",headers:t,body:n,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",u).then(e=>e.json()).then(async e=>{console.log("respuesta POST ",e),e=="Configuraci\xF3n actualizada correctamente"&&(x.value=!0,await P())}).catch(e=>console.error("error",e))}async function de(){let s={key:"horarioRadio",estructura:{html:w.value,forzado:c.value,horarios:N.value}};console.log("datos a enviar ",s);var t=new Headers;t.append("Content-Type","application/json");var n=JSON.stringify(s),u={method:"POST",headers:t,body:n,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",u).then(e=>e.json()).then(async e=>{console.log("respuesta POST ",e),e=="Configuraci\xF3n actualizada correctamente"&&(x.value=!0,await P())}).catch(e=>console.error("error",e))}async function ue(){let s={key:"horarioRadio",estructura:{html:w.value,forzado:c.value,horarios:N.value}};console.log("datos a enviar ",s);var t=new Headers;t.append("Content-Type","application/json");var n=JSON.stringify(s),u={method:"POST",headers:t,body:n,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",u).then(e=>e.json()).then(async e=>{console.log("respuesta POST ",e),e=="Configuraci\xF3n actualizada correctamente"&&(x.value=!0,await P())}).catch(e=>console.error("error",e))}const H=d(!1),W=localStorage.getItem("role"),C=d([]),ce=()=>{let t=JSON.parse(localStorage.getItem("userData")).email;const u=new Pusher("69f5e107f97ef8dcc25f",{cluster:"us2",forceTLS:!0,channelAuthorization:{paramsProvider:()=>({param1:t}),endpoint:"https://pusher-auth-mocha.vercel.app/pusher/auth"}}).subscribe("presence-configuracion");u.bind("pusher:subscription_succeeded",()=>u.members.each(e=>C.value.push({email:e.id}))),u.bind("pusher:member_added",e=>{C.value.push({email:e.id})}),u.bind("pusher:member_removed",e=>{const i=Array.from(C.value).findIndex(T=>T.email===e.id);i!==-1&&C.value.splice(i,1)})};return(s,t)=>{const n=ve("PerfectScrollbar"),u=Se;return p(),k("section",null,[r(W)=="administrador"?(p(),y(v,{key:0,icon:"",size:"small",class:"app-custom-toggler rounded-s-lg rounded-0",style:{"z-index":"1001"},onClick:t[0]||(t[0]=e=>H.value=!0)},{default:l(()=>[a(S,{icon:"tabler-users"})]),_:1})):D("",!0),r(W)=="administrador"?(p(),y(Pe,{key:1,modelValue:r(H),"onUpdate:modelValue":t[2]||(t[2]=e=>z(H)?H.value=e:null),temporary:"",location:"end",width:"400",scrim:!1,class:"app-customizer"},{default:l(()=>[o("div",Ue,[Ee,a(v,{icon:"",variant:"text",color:"secondary",size:"x-small",onClick:t[1]||(t[1]=e=>H.value=!1)},{default:l(()=>[a(S,{icon:"tabler-x",size:"20"})]),_:1})]),a(J),o("div",Ie,[a(n,{tag:"ul",options:{wheelPropagation:!1}},{default:l(()=>[a(G,{lines:"two",border:""},{default:l(()=>[(p(!0),k(U,null,R(r(C),(e,_)=>(p(),k(U,{key:e.email},[a(ge,null,{default:l(()=>[a(he,null,{default:l(()=>[m(E(e.email),1)]),_:2},1024),a(be,{class:"mt-1"},{default:l(()=>[a(ze,{dot:"",location:"start center","offset-x":"2",color:"success",class:"me-3"},{default:l(()=>[Oe]),_:1})]),_:1})]),_:2},1024),_!==r(C).length-1?(p(),y(J,{key:0})):D("",!0)],64))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])):D("",!0),a(_e,{modelValue:r(x),"onUpdate:modelValue":t[3]||(t[3]=e=>z(x)?x.value=e:null),color:"success",transition:"scale-transition",location:"top center"},{default:l(()=>[Ne]),_:1},8,["modelValue"]),a(ye,{modelValue:r(V),"onUpdate:modelValue":t[4]||(t[4]=e=>z(V)?V.value=e:null),class:"v-tabs-pill"},{default:l(()=>[a(j,{value:"tab-config"},{default:l(()=>[m("Configuraci\xF3n de Horarios")]),_:1}),a(j,{value:"tab-forzado"},{default:l(()=>[m("Player Forzado")]),_:1}),a(j,{value:"tab-embed"},{default:l(()=>[m("C\xF3digo del reproductor")]),_:1})]),_:1},8,["modelValue"]),a(He,{modelValue:r(V),"onUpdate:modelValue":t[12]||(t[12]=e=>z(V)?V.value=e:null)},{default:l(()=>[a(q,{value:"tab-config"},{default:l(()=>[a(F,{class:"mt-5",title:"Configuraci\xF3n de los horarios"},{default:l(()=>[r(O)?(p(),y(I,{key:0},{default:l(()=>[m(" Cargando configuraci\xF3n... ")]),_:1})):(p(),y(I,{key:1,class:"py-4 gap-0 w-100"},{default:l(()=>[a(L,null,{default:l(()=>[a(h,{cols:"12",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:l(()=>[a(h,{cols:"4"},{default:l(()=>[a(Ve,{modelValue:r(b),"onUpdate:modelValue":t[5]||(t[5]=e=>z(b)?b.value=e:null),items:r(A),disabled:r(A).length===0,label:"D\xEDa de la semana"},null,8,["modelValue","items","disabled"])]),_:1}),a(h,{cols:"6",class:"d-flex gap-4"},{default:l(()=>[a(v,{color:"primary",onClick:t[6]||(t[6]=e=>te()),disabled:r(A).length===0||!r(b)},{default:l(()=>[m(" A\xF1adir d\xEDa ")]),_:1},8,["disabled"]),a(v,{color:"primary",onClick:t[7]||(t[7]=e=>ne())},{default:l(()=>[m(" Guardar Horarios ")]),_:1})]),_:1})]),_:1}),a(h,{cols:"12"},{default:l(()=>[a(G,{class:"card-list"},{default:l(()=>[a(we,{variant:"accordion",multiple:""},{default:l(()=>[(p(!0),k(U,null,R(r(f),(e,_)=>(p(),y(xe,{key:_},{default:l(()=>[a(Ce,{class:"d-flex flex-wrap justify-space-between gap-4"},{default:l(()=>[o("h3",null,E(le(e.dia)),1),a(X,{color:e.estadoDia==!0?"success":"warning",class:"mr-4"},{default:l(()=>[m(E(e.estadoDia==!0?"Activo":"Inactivo"),1)]),_:2},1032,["color"]),a($,{modelValue:e.estadoDia,"onUpdate:modelValue":i=>e.estadoDia=i,color:"success",label:e.estadoDia==!0?"D\xEDa activo":"D\xEDa inactivo"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(Te,{class:"d-flex flex-wrap justify-space-between"},{default:l(()=>[o("div",Ae,[a(ke,{class:"w-full"},{default:l(()=>[o("thead",null,[o("tr",null,[o("th",Re,[a(v,{color:"primary",onClick:i=>se(_)},{default:l(()=>[m(" A\xF1adir hora ")]),_:2},1032,["onClick"]),a(v,{style:{"margin-left":"0.5rem"},color:"error",onClick:i=>oe(_)},{default:l(()=>[m(" Eliminar d\xEDa ")]),_:2},1032,["onClick"])])]),je]),o("tbody",null,[(p(!0),k(U,null,R(e.horas.sort((i,T)=>i.inicio.localeCompare(T.inicio)),(i,T)=>(p(),k("tr",{key:T},[o("td",qe,[a(B,{modelValue:i.tituloPrograma,"onUpdate:modelValue":g=>i.tituloPrograma=g,label:"T\xEDtulo del horario",placeholder:"Escriba el t\xEDtulo...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Fe,[a(u,{modelValue:i.inicio,"onUpdate:modelValue":g=>i.inicio=g,label:"Hora Inicio",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Le,[a(u,{modelValue:i.fin,"onUpdate:modelValue":g=>i.fin=g,label:"Hora Fin",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue","onUpdate:modelValue"])]),o("td",$e,[o("div",Be,[a($,{modelValue:i.estadoHorario,"onUpdate:modelValue":g=>i.estadoHorario=g,color:"success",label:i.estadoHorario==!0?"Horario activo":"Horario inactivo"},null,8,["modelValue","onUpdate:modelValue","label"]),e.horas.length>1?(p(),y(v,{key:0,color:"error",onClick:g=>re(_,T)},{default:l(()=>[a(S,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):D("",!0)])])]))),128))])]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1}),a(q,{value:"tab-forzado"},{default:l(()=>[a(F,{class:"mt-5",title:"Player Forzado",subtitle:"Para transmisiones emergentes, este m\xF3dulo permitir\xE1 activar el reproductor de forma forzada"},{default:l(()=>[a(I,{class:"py-4 gap-0 w-100"},{default:l(()=>[a(L,null,{default:l(()=>[a(h,{cols:"8",style:{}},{default:l(()=>[o("div",Me,[a(B,{modelValue:r(c).titulo,"onUpdate:modelValue":t[8]||(t[8]=e=>r(c).titulo=e),label:"T\xEDtulo sobre el player",placeholder:"Escriba el t\xEDtulo que mostrar\xE1 sobre el reproductor...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue"]),a(K,{location:"top"},{activator:l(({props:e})=>[a(S,Z(e,{size:"30",icon:"tabler-alert-circle"}),null,16)]),default:l(()=>[We]),_:1})]),o("div",Je,[a(B,{modelValue:r(c).label,"onUpdate:modelValue":t[9]||(t[9]=e=>r(c).label=e),label:"Texto del Indicador",placeholder:"Escriba el texto que deseas en el indicador parpadeante...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue"]),a(K,{location:"top"},{activator:l(({props:e})=>[a(S,Z(e,{size:"30",icon:"tabler-alert-circle"}),null,16)]),default:l(()=>[Ge]),_:1})])]),_:1}),a(h,{cols:"4",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:l(()=>[o("div",Xe,[o("div",null,[a($,{modelValue:r(c).estado,"onUpdate:modelValue":t[10]||(t[10]=e=>r(c).estado=e),color:"success",label:r(c).estado==!0?"Activo":"Inactivo"},null,8,["modelValue","label"])]),o("div",Ze,[a(v,{color:"primary",onClick:de},{default:l(()=>[m(" Enviar ")]),_:1})])])]),_:1}),a(h,{cols:"12",style:{display:"flex","align-items":"center"}},{default:l(()=>[Ke,o("div",Qe,[a(X,{color:r(c).estado==!0?"success":"warning",class:"mr-4"},{default:l(()=>[m(E(r(c).estado==!0?"Activo":"Inactivo"),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(q,{value:"tab-embed"},{default:l(()=>[a(F,{class:"mt-5",title:"Embed player",subtitle:"Proporciona el c\xF3digo HTML del reproductor que presentar\xE1 embebido en la seccion de audio"},{default:l(()=>[a(I,{class:"py-4 gap-0 w-100"},{default:l(()=>[a(L,null,{default:l(()=>[a(h,{cols:"12",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:l(()=>[o("div",Ye,[a(De,{modelValue:r(w).value,"onUpdate:modelValue":t[11]||(t[11]=e=>r(w).value=e),label:"C\xF3digo",placeholder:"Escriba el c\xF3digo html del reproductor...",class:"ms-0 me-1 chat-list-search","auto-grow":""},null,8,["modelValue"])]),a(v,{color:"primary",onClick:ue},{default:l(()=>[m(" Enviar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ra as default};
