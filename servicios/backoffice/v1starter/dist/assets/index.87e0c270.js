import{r as u,as as _e,v as ve,o as i,x as C,a as e,w as a,q as d,t as g,u as c,f as ge,e as r,g as N,aR as R,h as T,b as o,p as m,c as y,aQ as U,aW as W,F as S,C as E,N as $,d as be,Z as Ve,a3 as Z,V as F,l as he,m as ye,n as B,i as q,a2 as K,aT as we,b0 as X,bc as Ce}from"./index.88d3c7f5.js";/* empty css              */import{V as Y}from"./VTextarea.86fae113.js";const ke={class:"d-flex flex-wrap gap-4 mt-10"},xe=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Id"),o("th",{scope:"col"},"Nombre"),o("th",{scope:"col"},"Acciones")])],-1),Pe=["onClick"],De={class:"text-medium-emphasis"},Ue={class:"text-medium-emphasis"},je={class:"text-medium-emphasis"},Ne={class:"d-flex align-center justify-space-between botonescurrentPage"},Te=o("thead",null,[o("tr",null,[o("th",{scope:"col"},"Nombre"),o("th",{scope:"col"},"Precio"),o("th",{scope:"col"},"Im\xE1gen"),o("th",{scope:"col"},"Descripci\xF3n"),o("th",{scope:"col"},"Condiciones"),o("th",{scope:"col"},"Frecuencia")])],-1),Se={class:"text-medium-emphasis"},Ee={class:"text-medium-emphasis"},$e={class:"text-medium-emphasis"},Fe={class:"text-medium-emphasis"},Be={class:"text-medium-emphasis"},Ie={class:"text-medium-emphasis"},Ae=o("h4",{class:"mt-4"},"Planes",-1),Je=o("span",{class:"mt-4"},"Descripci\xF3n",-1),ze={__name:"index",setup(Le){const x=u([]),I=u(!1);async function A(){try{I.value=!0;const s=await(await fetch("https://ecuavisa-pricing.vercel.app/pricing/get/all/producto")).json();x.value=s.data,I.value=!1}catch(t){console.error(t.message)}}_e(async()=>{await A()});const j=8,V=u(1),ee=ve(()=>{const t=(V.value-1)*j,s=t+j;return x.value.slice(t,s)}),ae=()=>{V.value*j<x.value.length&&V.value++},le=()=>{V.value>1&&V.value--},te=[{title:"Mensual",value:"mensual"},{title:"Anual",value:"anual"}],J=u([]),L=u(!1),M=u(""),oe=u("");function se(t="",s){let f=x.value.find(l=>l._id==t);J.value=f.planes,oe.value=t,M.value=s,L.value=!0}const w=u(!1),P=u(""),b=u(""),_=u([]),p=u({message:"Datos guardados",type:"success",model:!1});function ne(){let t={nombre_plan:"",precio:0,url_imagen:"",descripcion:[],condiciones:"",frecuencia:""};_.value.push(t)}const ce=t=>{_.value.splice(t,1)};function re(t){_.value[t].descripcion.push("")}const ue=(t,s)=>{_.value[t].descripcion.splice(s,1)};function O(){b.value="",_.value=[]}function z(){O(),w.value=!1}async function ie(){O(),P.value="add";let t={nombre_plan:"",precio:0,url_imagen:"",descripcion:[],condiciones:"",frecuencia:""};_.value.push(t),w.value=!0}const H=u("");async function de(t){O(),P.value="edit";const l=(await(await fetch("https://ecuavisa-pricing.vercel.app/pricing/get/producto/"+t)).json()).data;H.value=l._id,b.value=l.nombre,_.value=l.planes,w.value=!0}async function pe(){let t=b.value,s=_.value;if(!t||t=="")return p.value={message:"Debe a\xF1adir un nombre",type:"error",model:!0},!1;if(s.length==0)return p.value={message:"Debe ingresar almenos 1 plan",type:"error",model:!0},!1;for(let n of s)if(n.nombre_plan==""||n.precio==0||n.url_imagen==""||n.descripcion.length==0||n.condicion==""||n.frecuencia=="")return p.value={message:"Debe ingresar todos los datos del plan",type:"error",model:!0},!1;var f=new Headers;if(f.append("Content-Type","application/json"),P.value==="add"){let n={nombre:b.value,planes:_.value};var l=JSON.stringify(n),v={method:"POST",headers:f,body:l,redirect:"follow"};const D=await(await fetch("https://ecuavisa-pricing.vercel.app/pricing/producto/insert",v)).json();D.resp?p.value={message:"Producto creado correctamente",type:"success",model:!0}:p.value={message:D.mensaje,type:"error",model:!0}}else if(P.value==="edit"){let n={id:H.value,nombre:b.value,planes:_.value};var l=JSON.stringify(n),v={method:"PUT",headers:f,body:l,redirect:"follow"};const Q=await(await fetch("https://ecuavisa-pricing.vercel.app/pricing/update",v)).json();Q.resp?p.value={message:"Producto editado correctamente",type:"success",model:!0}:p.value={message:Q.mensaje,type:"error",model:!0}}await A(),w.value=!1,L.value=!1}const h=u(!1),G=u("");function me(t){h.value=!0,G.value=t}async function fe(){var t={method:"DELETE",redirect:"follow"};const f=await(await fetch("https://ecuavisa-pricing.vercel.app/pricing/delete?id="+G.value,t)).json();f.resp?p.value={message:"Producto eliminado correctamente",type:"success",model:!0}:p.value={message:f.mensaje,type:"error",model:!0},await A(),h.value=!1}return(t,s)=>{const f=Ce;return i(),C("section",null,[e(ge,{modelValue:c(p).model,"onUpdate:modelValue":s[0]||(s[0]=l=>c(p).model=l),location:"top end",variant:"flat",color:c(p).type},{default:a(()=>[d(g(c(p).message),1)]),_:1},8,["modelValue","color"]),e(F,null,{default:a(()=>[e(r,{cols:"5",sm:"12",lg:"5",class:"container"},{default:a(()=>[e(N,null,{default:a(()=>[e(R,{class:"pt-4 pl-6"},{default:a(()=>[d("Lista de productos")]),_:1}),e(T,{style:{"margin-bottom":"-2rem"}},{default:a(()=>[o("div",ke,[e(m,{"prepend-icon":"tabler-plus",color:"success",variant:"tonal",class:"ml-auto",onClick:ie},{default:a(()=>[d(" Crear producto ")]),_:1})])]),_:1}),c(I)?(i(),y(U,{key:0},{default:a(()=>[d(" Cargando datos... ")]),_:1})):(i(),y(U,{key:1},{default:a(()=>[e(W,{class:"text-no-wrap tableNavegacion mb-5",hover:"true"},{default:a(()=>[xe,o("tbody",null,[(i(!0),C(S,null,E(c(ee),l=>(i(),C("tr",{onClick:v=>se(l._id,l.nombre),class:"clickable"},[o("td",De,g(l._id),1),o("td",Ue,g(l.nombre),1),o("td",je,[e(m,{color:"success",variant:"text",icon:"",onClick:v=>de(l._id)},{default:a(()=>[e($,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(m,{icon:"",color:"error",variant:"text",onClick:v=>me(l._id)},{default:a(()=>[e($,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])],8,Pe))),256))])]),_:1}),o("div",Ne,[e(m,{icon:"tabler-arrow-big-left-lines",onClick:le,disabled:c(V)===1},null,8,["disabled"]),d(" P\xE1gina "+g(c(V))+" ",1),e(m,{icon:"tabler-arrow-big-right-lines",onClick:ae,disabled:c(V)*j>=c(x).length},null,8,["disabled"])])]),_:1}))]),_:1})]),_:1}),e(r,{cols:"7",sm:"12",lg:"7",class:"container"},{default:a(()=>[c(L)?(i(),y(N,{key:0},{default:a(()=>[e(R,{class:"pt-4 pl-6"},{default:a(()=>[d("Planes de "+g(c(M)),1)]),_:1}),c(J).length===0?(i(),y(U,{key:0},{default:a(()=>[d(" No existen datos para mostrar. ")]),_:1})):(i(),y(U,{key:1},{default:a(()=>[e(W,{class:"text-no-wrap tableNavegacion mb-5"},{default:a(()=>[Te,o("tbody",null,[(i(!0),C(S,null,E(c(J),l=>(i(),C("tr",null,[o("td",Se,g(l.nombre_plan),1),o("td",Ee,g(l.precio),1),o("td",$e,[e(be,{width:200,"aspect-ratio":"1/1",src:l.url_imagen},null,8,["src"])]),o("td",Fe,[e(Ve,{items:l.descripcion},null,8,["items"])]),o("td",Be,g(l.condiciones),1),o("td",Ie,g(l.frecuencia),1)]))),256))])]),_:1})]),_:1}))]),_:1})):Z("",!0)]),_:1})]),_:1}),e(X,{modelValue:c(w),"onUpdate:modelValue":s[2]||(s[2]=l=>q(w)?w.value=l:null),persistent:"","max-width":"900"},{default:a(()=>[e(f,{onClick:z}),e(N,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(U,{class:"text-center"},{default:a(()=>[e(R,{class:"text-h5 mb-3"},{default:a(()=>[d(g(c(P)==="add"?"Crear un producto":"Editar "+c(b)),1)]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(he,{class:"mt-6",onSubmit:ye(pe,["prevent"])},{default:a(()=>[e(F,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(F,null,{default:a(()=>[e(r,{cols:"12"},{default:a(()=>[e(B,{modelValue:c(b),"onUpdate:modelValue":s[1]||(s[1]=l=>q(b)?b.value=l:null),label:"Nombre del producto"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(r,{class:"d-flex",cols:"12"},{default:a(()=>[Ae,e(m,{style:{"margin-left":"auto"},"prepend-icon":"tabler-plus",onClick:ne},{default:a(()=>[d("A\xF1adir Plan")]),_:1})]),_:1}),e(K,{class:"my-2"})]),_:1}),(i(!0),C(S,null,E(c(_),(l,v)=>(i(),y(F,{class:"mt-2"},{default:a(()=>[v!==0?(i(),y(K,{key:0,class:"my-2"})):Z("",!0),e(r,{cols:"7"},{default:a(()=>[e(B,{modelValue:l.nombre_plan,"onUpdate:modelValue":n=>l.nombre_plan=n,label:"Nombre del plan"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{cols:"5"},{default:a(()=>[e(B,{modelValue:l.precio,"onUpdate:modelValue":n=>l.precio=n,label:"Precio"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{cols:"7"},{default:a(()=>[e(B,{modelValue:l.url_imagen,"onUpdate:modelValue":n=>l.url_imagen=n,label:"Url de im\xE1gen"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{cols:"5"},{default:a(()=>[e(we,{modelValue:l.frecuencia,"onUpdate:modelValue":n=>l.frecuencia=n,items:te,label:"Frecuencia"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{cols:"12"},{default:a(()=>[e(r,{class:"d-flex",cols:"12"},{default:a(()=>[Je,e(m,{style:{"margin-left":"auto"},onClick:n=>re(v)},{default:a(()=>[e($,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),(i(!0),C(S,null,E(l.descripcion,(n,k)=>(i(),y(r,{class:"d-flex",key:k,cols:"12"},{default:a(()=>[e(r,{cols:"10"},{default:a(()=>[e(Y,{rows:"1",modelValue:l.descripcion[k],"onUpdate:modelValue":D=>l.descripcion[k]=D,label:"Descripci\xF3n "+(k+1),"auto-grow":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(r,{cols:"2"},{default:a(()=>[e(m,{color:"error",onClick:D=>ue(v,k)},{default:a(()=>[e($,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),e(r,{cols:"12"},{default:a(()=>[e(Y,{rows:"2",modelValue:l.condiciones,"onUpdate:modelValue":n=>l.condiciones=n,label:"Condiciones","auto-grow":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{style:{position:"relative"},class:"my-4",cols:"12"},{default:a(()=>[e(m,{style:{position:"absolute",bottom:"0%",right:"0%"},class:"mr-2","prepend-icon":"tabler-trash",color:"error",onClick:n=>ce(v)},{default:a(()=>[d(" Eliminar plan ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(r,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(m,{type:"submit"},{default:a(()=>[d(" Guardar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:z},{default:a(()=>[d(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{modelValue:c(h),"onUpdate:modelValue":s[5]||(s[5]=l=>q(h)?h.value=l:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(f,{onClick:s[3]||(s[3]=l=>h.value=!c(h))}),e(N,{title:"Eliminar registro"},{default:a(()=>[e(T,null,{default:a(()=>[d(" \xBFDesea eliminar el producto? ")]),_:1}),e(T,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(m,{color:"secondary",variant:"tonal",onClick:s[4]||(s[4]=l=>h.value=!1)},{default:a(()=>[d(" No, Cerrar ")]),_:1}),e(m,{onClick:fe},{default:a(()=>[d(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ze as default};
