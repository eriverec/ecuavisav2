import{r as u,I as he,as as be,v as _e,z as ye,o as d,x as D,u as i,c as b,w as t,a as e,N as y,p as g,a3 as V,b as o,a2 as ae,Z as te,F as N,C as R,$ as Ve,a0 as we,q as m,t as A,a1 as xe,i as S,f as Ce,b8 as B,b7 as ke,g as $,h as E,b0 as Te,ba as M,V as W,e as x,aT as ze,b3 as Pe,b4 as De,b5 as Se,aM as le,c7 as J,b6 as Ee,aW as He,n as X,aq as q,b9 as Ue,bc as Oe,aX as je}from"./index.88d3c7f5.js";import{V as Ie}from"./VBadge.0df54a63.js";import{V as Ne}from"./VNavigationDrawer.44422f4c.js";import{V as F}from"./VTooltip.2d0a8708.js";import{V as oe}from"./VTextarea.86fae113.js";const Ae={class:"custom-heading d-flex align-center justify-space-between"},$e=o("div",null,[o("h6",{class:"text-h6 py-4 pl-4"},"Usuarios activos en configuraci\xF3n"),o("span",{class:"text-body-1"})],-1),qe={style:{padding:"1rem"}},Fe=o("span",{class:"ms-4"},"Online",-1),Le=o("h3",null,"Se ha guardado la configuraci\xF3n exitosamente",-1),Re={style:{padding:"1rem",border:`1px solid\r
															rgba(\r
																var(--v-theme-on-background),\r
																var(--v-disabled-opacity)\r
															)`,"border-radius":"7px"}},Be={scope:"col",class:"d-flex gap-4 pb-4"},Me=o("tr",null,[o("th",{scope:"col",style:{width:"300px"}},"T\xEDtulo"),o("th",{scope:"col",style:{width:"120px"}}," Hora de inicio "),o("th",{scope:"col",style:{width:"120px"}}," Hora de fin "),o("th",{scope:"col",class:"d-flex gap-4 pb-4"})],-1),We={class:"py-4"},Je={class:"py-4"},Xe={class:"py-4"},Ze={class:"py-4"},Ge={class:"d-flex align-center gap-4 py-4"},Ke=o("span",null," Agregar Player Personalizado a este horario espec\xEDfico",-1),Qe=o("span",null,"Modificar Player Personalizado - ",-1),Ye={style:{width:"650px","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-3"},ea=o("span",null,"Este titular aparecer\xE1 en lugar del t\xEDtulo del programa sobre el reproductor",-1),aa={style:{width:"650px","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-3"},ta=o("span",null,"Este texto es el que aparece en el indicador que parpadea sobre el header",-1),la={style:{display:"flex",margin:"1rem"}},oa={style:{"margin-left":"2rem"}},sa=o("div",null,[o("span",null,"Estado del player: ")],-1),ra={style:{"margin-left":"2rem"}},ia={style:{width:"100%","margin-top":"1rem","margin-bottom":"1rem"},class:"d-flex flex-row gap-2"},va={__name:"index",setup(na){u(!1);const Z=u(!1),p=u(!1),se=he(),H=u(!1),T=u("tab-detalles"),C=u(""),h=u([]),j=u([]);u(""),u("");const G=u(""),K=u(!1),k=u(!1),Q=[{title:"Lunes",value:1},{title:"Martes",value:2},{title:"Mi\xE9rcoles",value:3},{title:"Jueves",value:4},{title:"Viernes",value:5},{title:"S\xE1bado",value:6},{title:"Domingo",value:0}];async function I(){H.value=!0;const a=await(await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=web&key=horarioEnvivo")).json();Z.value=a.forzado,p.value=a.forzado,h.value=Array.from(a.horarios),j.value=Array.from(a.horarios),G.value=a.html.value,K.value=a.html.estadoHtml,k.value=a.html,H.value=!1}const w=u(!1);async function re(){H.value=!0;const a=await(await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/respaldoEnvivo/datareader.php")).json();Z.value=a.forzado,p.value=a.forzado,h.value=Array.from(a.horarios),j.value=Array.from(a.horarios),G.value=a.html.value,K.value=a.html.estadoHtml,k.value=a.html,H.value=!1,await Y(),w.value=!1}be(()=>{ge(),pe(),I()});const L=_e(()=>{if(h.value.length>0){h.value=h.value.sort(function(c,f){return c.dia-f.dia});const s=h.value.map(c=>c.dia);return Q.filter(c=>!s.includes(c.value))}});function ie(s){return Q.filter(c=>s===c.value)[0].title}const ne=()=>{if(C.value){let s={dia:C.value,estadoDia:!0,horas:[{tituloPrograma:"",estadoHorario:!0,inicio:"12:00",fin:"14:00"}]};h.value.push(s),C.value=""}},de=s=>{h.value.splice(s,1)},ue=s=>{let a={tituloPrograma:"",estadoHorario:!0,inicio:"12:00",fin:"14:00"};h.value[s].horas.push(a)},ce=(s,a)=>{h.value[s].horas[a].iframe="Pon tu html aqui"},me=(s,a)=>{h.value[s].horas.splice(a,1)},pe=()=>{let s=localStorage.getItem("role");s!=="administrador"&&s!=="webmaster"&&se.push({path:"/pages/errors/not-authorized"})},z=u(!1);async function Y(){let s={key:"horarioEnvivo",estructura:{html:k.value,forzado:p.value,horarios:h.value}};console.log("datos a enviar ",s);var a=new Headers;a.append("Content-Type","application/json");var c=JSON.stringify(s),f={method:"POST",headers:a,body:c,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",f).then(r=>r.json()).then(async r=>{console.log("respuesta POST ",r),r=="Configuraci\xF3n actualizada correctamente"&&(z.value=!0,await I())}).catch(r=>console.error("error",r))}async function fe(){let s={key:"horarioEnvivo",estructura:{html:k.value,forzado:p.value,horarios:j.value}};console.log("datos a enviar ",s);var a=new Headers;a.append("Content-Type","application/json");var c=JSON.stringify(s),f={method:"POST",headers:a,body:c,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",f).then(r=>r.json()).then(async r=>{console.log("respuesta POST ",r),r=="Configuraci\xF3n actualizada correctamente"&&(z.value=!0,await I())}).catch(r=>console.error("error",r))}async function ve(){let s={key:"horarioEnvivo",estructura:{html:k.value,forzado:p.value,horarios:j.value}};console.log("datos a enviar ",s);var a=new Headers;a.append("Content-Type","application/json");var c=JSON.stringify(s),f={method:"POST",headers:a,body:c,redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/envivo/config.php?api=update",f).then(r=>r.json()).then(async r=>{console.log("respuesta POST ",r),r=="Configuraci\xF3n actualizada correctamente"&&(z.value=!0,await I())}).catch(r=>console.error("error",r))}const U=u(!1),ee=localStorage.getItem("role"),P=u([]),ge=()=>{let a=JSON.parse(localStorage.getItem("userData")).email;const f=new Pusher("69f5e107f97ef8dcc25f",{cluster:"us2",forceTLS:!0,channelAuthorization:{paramsProvider:()=>({param1:a}),endpoint:"https://pusher-auth-mocha.vercel.app/pusher/auth"}}).subscribe("presence-configuracion");f.bind("pusher:subscription_succeeded",()=>f.members.each(r=>P.value.push({email:r.id}))),f.bind("pusher:member_added",r=>{P.value.push({email:r.id})}),f.bind("pusher:member_removed",r=>{const _=Array.from(P.value).findIndex(n=>n.email===r.id);_!==-1&&P.value.splice(_,1)})};return(s,a)=>{const c=ye("PerfectScrollbar"),f=Oe,r=je;return d(),D("section",null,[i(ee)=="administrador"?(d(),b(g,{key:0,icon:"",size:"small",class:"app-custom-toggler rounded-s-lg rounded-0",style:{"z-index":"1001"},onClick:a[0]||(a[0]=l=>U.value=!0)},{default:t(()=>[e(y,{icon:"tabler-users"})]),_:1})):V("",!0),i(ee)=="administrador"?(d(),b(Ne,{key:1,modelValue:i(U),"onUpdate:modelValue":a[2]||(a[2]=l=>S(U)?U.value=l:null),temporary:"",location:"end",width:"400",scrim:!1,class:"app-customizer"},{default:t(()=>[o("div",Ae,[$e,e(g,{icon:"",variant:"text",color:"secondary",size:"x-small",onClick:a[1]||(a[1]=l=>U.value=!1)},{default:t(()=>[e(y,{icon:"tabler-x",size:"20"})]),_:1})]),e(ae),o("div",qe,[e(c,{tag:"ul",options:{wheelPropagation:!1}},{default:t(()=>[e(te,{lines:"two",border:""},{default:t(()=>[(d(!0),D(N,null,R(i(P),(l,_)=>(d(),D(N,{key:l.email},[e(Ve,null,{default:t(()=>[e(we,null,{default:t(()=>[m(A(l.email),1)]),_:2},1024),e(xe,{class:"mt-1"},{default:t(()=>[e(Ie,{dot:"",location:"start center","offset-x":"2",color:"success",class:"me-3"},{default:t(()=>[Fe]),_:1})]),_:1})]),_:2},1024),_!==i(P).length-1?(d(),b(ae,{key:0})):V("",!0)],64))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])):V("",!0),e(Ce,{modelValue:i(z),"onUpdate:modelValue":a[3]||(a[3]=l=>S(z)?z.value=l:null),color:"success",transition:"scale-transition",location:"top center"},{default:t(()=>[Le]),_:1},8,["modelValue"]),e(ke,{modelValue:i(T),"onUpdate:modelValue":a[4]||(a[4]=l=>S(T)?T.value=l:null),class:"v-tabs-pill"},{default:t(()=>[e(B,{value:"tab-config"},{default:t(()=>[m("Configuraci\xF3n de Horarios")]),_:1}),e(B,{value:"tab-forzado"},{default:t(()=>[m("Player Forzado")]),_:1}),e(B,{value:"tab-embed"},{default:t(()=>[m("C\xF3digo del reproductor")]),_:1})]),_:1},8,["modelValue"]),e(Te,{modelValue:i(w),"onUpdate:modelValue":a[7]||(a[7]=l=>S(w)?w.value=l:null),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(f,{onClick:a[5]||(a[5]=l=>w.value=!i(w))}),e($,{title:"Reiniciar formato"},{default:t(()=>[e(E,null,{default:t(()=>[m(" \xBFEst\xE1 seguro que desea reiniciar el formato? ")]),_:1}),e(E,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(g,{color:"secondary",variant:"tonal",onClick:a[6]||(a[6]=l=>w.value=!1)},{default:t(()=>[m(" No, Cerrar ")]),_:1}),e(g,{onClick:re},{default:t(()=>[m(" Si, Reinciar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ue,{modelValue:i(T),"onUpdate:modelValue":a[16]||(a[16]=l=>S(T)?T.value=l:null)},{default:t(()=>[e(M,{value:"tab-config"},{default:t(()=>[e($,{class:"mt-5",title:"Configuraci\xF3n de los horarios"},{default:t(()=>[i(H)?(d(),b(E,{key:0},{default:t(()=>[m(" Cargando configuraci\xF3n... ")]),_:1})):(d(),b(E,{key:1,class:"py-4 gap-0 w-100"},{default:t(()=>[e(W,null,{default:t(()=>[e(x,{cols:"12",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:t(()=>[e(x,{cols:"4"},{default:t(()=>[e(ze,{modelValue:i(C),"onUpdate:modelValue":a[8]||(a[8]=l=>S(C)?C.value=l:null),items:i(L),disabled:i(L).length===0,label:"D\xEDa de la semana"},null,8,["modelValue","items","disabled"])]),_:1}),e(x,{cols:"6",class:"d-flex gap-4"},{default:t(()=>[e(g,{color:"primary",onClick:a[9]||(a[9]=l=>ne()),disabled:i(L).length===0||!i(C)},{default:t(()=>[m(" A\xF1adir d\xEDa ")]),_:1},8,["disabled"]),e(g,{rounded:"pill",color:"success",class:"boton-fija",onClick:a[10]||(a[10]=l=>Y())},{default:t(()=>[e(y,{size:"30",icon:"tabler-device-floppy"})]),_:1}),e(g,{rounded:"pill",class:"boton-reset",onClick:a[11]||(a[11]=l=>w.value=!0)},{default:t(()=>[e(y,{size:"30",icon:"tabler-refresh"})]),_:1})]),_:1})]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(te,{class:"card-list"},{default:t(()=>[e(Pe,{variant:"accordion",multiple:""},{default:t(()=>[(d(!0),D(N,null,R(i(h),(l,_)=>(d(),b(De,{key:_},{default:t(()=>[e(Se,{class:"d-flex flex-wrap justify-space-between gap-4"},{default:t(()=>[o("h3",null,A(ie(l.dia)),1),e(le,{color:l.estadoDia==!0?"success":"warning",class:"mr-4"},{default:t(()=>[m(A(l.estadoDia==!0?"Activo":"Inactivo"),1)]),_:2},1032,["color"]),e(J,{modelValue:l.estadoDia,"onUpdate:modelValue":n=>l.estadoDia=n,color:"success",label:l.estadoDia==!0?"D\xEDa activo":"D\xEDa inactivo"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(Ee,{class:"d-flex flex-wrap justify-space-between"},{default:t(()=>[o("div",Re,[e(He,{class:"w-full"},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",Be,[e(g,{color:"primary",onClick:n=>ue(_)},{default:t(()=>[m(" A\xF1adir hora ")]),_:2},1032,["onClick"]),e(g,{style:{"margin-left":"0.5rem"},color:"error",onClick:n=>de(_)},{default:t(()=>[m(" Eliminar d\xEDa ")]),_:2},1032,["onClick"])])]),Me]),o("tbody",null,[(d(!0),D(N,null,R(l.horas.sort((n,O)=>n.inicio.localeCompare(O.inicio)),(n,O)=>(d(),D("tr",{key:O},[o("td",We,[e(X,{modelValue:n.tituloPrograma,"onUpdate:modelValue":v=>n.tituloPrograma=v,label:"T\xEDtulo del horario",placeholder:"Escriba el t\xEDtulo...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Je,[e(r,{modelValue:n.inicio,"onUpdate:modelValue":v=>n.inicio=v,label:"Hora Inicio",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Xe,[e(r,{modelValue:n.fin,"onUpdate:modelValue":v=>n.fin=v,label:"Hora Fin",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}},null,8,["modelValue","onUpdate:modelValue"])]),o("td",Ze,[o("div",Ge,[e(J,{modelValue:n.estadoHorario,"onUpdate:modelValue":v=>n.estadoHorario=v,color:"success",label:n.estadoHorario==!0?"ON":"OFF"},null,8,["modelValue","onUpdate:modelValue","label"]),l.horas.length>1?(d(),b(g,{key:0,color:"error",onClick:v=>me(_,O)},{default:t(()=>[e(y,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):V("",!0),n.iframe?V("",!0):(d(),b(F,{key:1,location:"top"},{activator:t(({props:v})=>[l.horas.length>1?(d(),b(g,{key:0,color:"primary",onClick:da=>ce(_,O)},{default:t(()=>[e(y,q(v,{icon:"tabler-adjustments-horizontal"}),null,16)]),_:2},1032,["onClick"])):V("",!0)]),default:t(()=>[Ke]),_:2},1024)),n.iframe?(d(),b(F,{key:2,location:"top"},{activator:t(({props:v})=>[l.horas.length>1?(d(),b(g,{key:0,color:"success"},{default:t(()=>[e(y,q(v,{icon:"tabler-adjustments"}),null,16)]),_:2},1024)):V("",!0)]),default:t(()=>[Qe]),_:2},1024)):V("",!0),n.iframe?(d(),b(oe,{key:3,label:"c\xF3digo de custom player",modelValue:n.iframe,"onUpdate:modelValue":v=>n.iframe=v,rows:"3"},null,8,["modelValue","onUpdate:modelValue"])):V("",!0)])])]))),128))])]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1}),e(M,{value:"tab-forzado"},{default:t(()=>[e($,{class:"mt-5",title:"Player Forzado",subtitle:"Para transmisiones emergentes, este m\xF3dulo permitir\xE1 activar el reproductor de forma forzada"},{default:t(()=>[e(E,{class:"py-4 gap-0 w-100"},{default:t(()=>[e(W,null,{default:t(()=>[e(x,{cols:"8",style:{}},{default:t(()=>[o("div",Ye,[e(X,{modelValue:i(p).titulo,"onUpdate:modelValue":a[12]||(a[12]=l=>i(p).titulo=l),label:"T\xEDtulo sobre el player",placeholder:"Escriba el t\xEDtulo que mostrar\xE1 sobre el reproductor...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue"]),e(F,{location:"top"},{activator:t(({props:l})=>[e(y,q(l,{size:"30",icon:"tabler-alert-circle"}),null,16)]),default:t(()=>[ea]),_:1})]),o("div",aa,[e(X,{modelValue:i(p).label,"onUpdate:modelValue":a[13]||(a[13]=l=>i(p).label=l),label:"Texto del Indicador",placeholder:"Escriba el texto que deseas en el indicador parpadeante...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue"]),e(F,{location:"top"},{activator:t(({props:l})=>[e(y,q(l,{size:"30",icon:"tabler-alert-circle"}),null,16)]),default:t(()=>[ta]),_:1})])]),_:1}),e(x,{cols:"4",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:t(()=>[o("div",la,[o("div",null,[e(J,{modelValue:i(p).estado,"onUpdate:modelValue":a[14]||(a[14]=l=>i(p).estado=l),color:"success",label:i(p).estado==!0?"Activo":"Inactivo"},null,8,["modelValue","label"])]),o("div",oa,[e(g,{color:"primary",onClick:fe},{default:t(()=>[m(" Enviar ")]),_:1})])])]),_:1}),e(x,{cols:"12",style:{display:"flex","align-items":"center"}},{default:t(()=>[sa,o("div",ra,[e(le,{color:i(p).estado==!0?"success":"warning",class:"mr-4"},{default:t(()=>[m(A(i(p).estado==!0?"Activo":"Inactivo"),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(M,{value:"tab-embed"},{default:t(()=>[e($,{class:"mt-5",title:"Embed player",subtitle:"Proporciona el c\xF3digo HTML del reproductor que presentar\xE1 embebido en la seccion de audio"},{default:t(()=>[e(E,{class:"py-4 gap-0 w-100"},{default:t(()=>[e(W,null,{default:t(()=>[e(x,{cols:"12",style:{display:"flex","flex-wrap":"wrap","align-items":"center"}},{default:t(()=>[o("div",ia,[e(oe,{modelValue:i(k).value,"onUpdate:modelValue":a[15]||(a[15]=l=>i(k).value=l),label:"C\xF3digo",placeholder:"Escriba el c\xF3digo html del reproductor...",class:"ms-0 me-1 chat-list-search","auto-grow":""},null,8,["modelValue"])]),e(g,{color:"primary",onClick:ve},{default:t(()=>[m(" Enviar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{va as default};
