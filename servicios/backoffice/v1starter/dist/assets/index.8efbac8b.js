import{M as ue,r as c,as as de,v as ie,o as h,c as R,w as a,a as e,e as f,g as G,f as O,u as o,i as M,q as u,aQ as g,b as n,aR as E,p as m,h as A,aW as re,x as q,F as ce,C as fe,t as v,N as J,a2 as me,b0 as $,l as W,m as Q,V as C,n as k,aT as H,bc as pe,bd as ve,be as _e}from"./index.88d3c7f5.js";const P=N=>(ve("data-v-e1a01db5"),N=N(),_e(),N),Ve={class:"d-flex align-center flex-wrap gap-2"},be=P(()=>n("thead",null,[n("tr",null,[n("th",{scope:"col"},"Nombre"),n("th",{scope:"col"},"Email"),n("th",{scope:"col"},"Rol"),n("th",{scope:"col"},"Acciones")])],-1)),ge={class:"text-center",style:{width:"5rem"}},we={class:"px-4 py-4 mt-5"},ye={class:"px-2"},xe=P(()=>n("span",null,"\xBF Est\xE1 seguro que desea eliminar",-1)),he=P(()=>n("br",null,null,-1)),Ce={__name:"index",setup(N){const S=c([]),_=c(1),D=c(10),F=c(1),j=c(!0),d=c({}),w=c(!1),p=c(!1),r=c({}),y=c(!1),V=c(!1),b=c({}),x=c(!1),T=[{title:"Administrador",value:"administrador"},{title:"Redacci\xF3n",value:"redaccion"},{title:"Webmaster",value:"webmaster"},{title:"Visor",value:"visor"},{title:"Marketing",value:"marketing"},{title:"Audiencias",value:"audiencia"}];async function U(){j.value=!0,await fetch("https://gestores-flax.vercel.app/all").then(t=>t.json()).then(t=>{S.value=t,j.value=!1})}de(U);const K=ie(()=>{const t=(_.value-1)*D.value,l=t+D.value;let i=S.value.slice(t,l);return F.value=Math.ceil(S.value.length/D.value),i}),z=c("");async function X(t){await fetch("https://gestores-flax.vercel.app/id?"+new URLSearchParams({id:t})).then(l=>l.json()).then(l=>{d.value=l,z.value=l.email}).catch(l=>l),w.value=!0}async function Y(t){let l;d.value.email==z.value?l=JSON.stringify({id:t,fullName:d.value.fullName,role:d.value.role}):l=JSON.stringify({id:t,fullName:d.value.fullName,email:d.value.email,role:d.value.role}),await fetch("https://gestores-flax.vercel.app/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:l}).then(i=>i.json()).then(i=>i=="El email ya est\xE1 registrado"?(p.value=!0,!1):(w.value=!1,p.value=!1,U(),!0)).catch(i=>i)}const Z=()=>{d.value={},w.value=!1},B=t=>{t===!1&&(d.value={}),w.value=t};async function ee(){y.value=!0}async function le(){V.value=!1,p.value=!1;let t=JSON.stringify({fullName:r.value.fullName,email:r.value.email,password:r.value.password,role:r.value.role});await fetch("https://gestores-flax.vercel.app/add",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(l=>l.json()).then(l=>(console.log(l),l=="El email ya est\xE1 registrado"?(p.value=!0,!1):l=="Faltan datos"?(V.value=!0,!1):(y.value=!1,V.value=!1,p.value=!1,U(),!0))).catch(l=>l)}const ae=()=>{r.value={},y.value=!1},I=t=>{t===!1&&(r.value={}),y.value=t};async function te(t){x.value=!0,await fetch("https://gestores-flax.vercel.app/id?"+new URLSearchParams({id:t})).then(l=>l.json()).then(l=>{b.value=l}).catch(l=>l)}async function se(){let t=b.value._id;var l={method:"DELETE",redirect:"follow"};await fetch("https://gestores-flax.vercel.app/delete?"+new URLSearchParams({id:t}),l).then(i=>i.json()).then(i=>(x.value=!1,b.value={},U(),!0)).catch(i=>i)}const L=t=>{t===!1&&(b.value={}),x.value=t},oe=()=>{b.value={},x.value=!1};return(t,l)=>{const i=pe;return h(),R(C,null,{default:a(()=>[e(f,{cols:"12"},{default:a(()=>[e(G,null,{default:a(()=>[e(O,{modelValue:o(p),"onUpdate:modelValue":l[0]||(l[0]=s=>M(p)?p.value=s:null),color:"error",transition:"scale-transition",location:"top center"},{default:a(()=>[u(" El email ya est\xE1 registrado. ")]),_:1},8,["modelValue"]),e(O,{modelValue:o(V),"onUpdate:modelValue":l[1]||(l[1]=s=>M(V)?V.value=s:null),color:"error",transition:"scale-transition",location:"top center"},{default:a(()=>[u(" Porfavor ingresar todos los datos. ")]),_:1},8,["modelValue"]),e(g,{class:"pb-sm-0"},{default:a(()=>[n("div",Ve,[e(E,null,{default:a(()=>[u("Usuarios backoffice")]),_:1}),e(m,{"prepend-icon":"tabler-plus",onClick:ee},{default:a(()=>[u(" A\xF1adir usuario ")]),_:1})])]),_:1}),e(g,{class:"pb-sm-0"},{default:a(()=>[o(j)?(h(),R(A,{key:0},{default:a(()=>[u("Cargando informaci\xF3n...")]),_:1})):(h(),R(A,{key:1},{default:a(()=>[e(re,{class:"text-no-wrap tableNavegacion"},{default:a(()=>[be,n("tbody",null,[(h(!0),q(ce,null,fe(o(K),s=>(h(),q("tr",null,[n("td",null,v(s.fullName),1),n("td",null,v(s.email),1),n("td",null,v(s.role),1),n("td",ge,[e(m,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ne=>X(s._id)},{default:a(()=>[e(J,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(m,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ne=>te(s._id)},{default:a(()=>[e(J,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),e(me),n("div",we,[e(m,{disabled:o(_)===1,onClick:l[2]||(l[2]=s=>_.value-=1),size:"small",color:"primary"},{default:a(()=>[u(" Anterior ")]),_:1},8,["disabled"]),n("span",ye,v(o(_))+" de "+v(o(F))+" de un total de "+v(o(S).length)+" registros",1),e(m,{disabled:o(_)===o(F),onClick:l[3]||(l[3]=s=>_.value+=1),size:"small",color:"primary"},{default:a(()=>[u(" Siguiente ")]),_:1},8,["disabled"])]),e($,{persistent:"","no-click-animation":"",width:t.$vuetify.display.smAndDown?"auto":700,"model-value":o(w),"onUpdate:modelValue":B},{default:a(()=>[e(i,{onClick:l[4]||(l[4]=s=>B(!1))}),e(G,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(g,{class:"text-center"},{default:a(()=>[e(E,{class:"text-h5 mb-3"},{default:a(()=>[u(" Editar el usuario ")]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(W,{class:"mt-6",onSubmit:l[8]||(l[8]=Q(s=>Y(o(d)._id),["prevent"]))},{default:a(()=>[e(C,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(C,null,{default:a(()=>[e(f,{cols:"6"},{default:a(()=>[e(k,{modelValue:o(d).fullName,"onUpdate:modelValue":l[5]||(l[5]=s=>o(d).fullName=s),label:"Nombre completo"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:a(()=>[e(k,{modelValue:o(d).email,"onUpdate:modelValue":l[6]||(l[6]=s=>o(d).email=s),label:"Email"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:a(()=>[e(H,{modelValue:o(d).role,"onUpdate:modelValue":l[7]||(l[7]=s=>o(d).role=s),items:T,label:"role"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(m,{type:"submit"},{default:a(()=>[u(" Enviar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:Z},{default:a(()=>[u(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e($,{persistent:"","no-click-animation":"",width:t.$vuetify.display.smAndDown?"auto":700,"model-value":o(y),"onUpdate:modelValue":I},{default:a(()=>[e(i,{onClick:l[9]||(l[9]=s=>I(!1))}),e(G,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(g,{class:"text-center"},{default:a(()=>[e(E,{class:"text-h5 mb-3"},{default:a(()=>[u(" Agregar usuario ")]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(W,{class:"mt-6",onSubmit:Q(le,["prevent"])},{default:a(()=>[e(C,{class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(C,null,{default:a(()=>[e(f,{cols:"6"},{default:a(()=>[e(k,{modelValue:o(r).fullName,"onUpdate:modelValue":l[10]||(l[10]=s=>o(r).fullName=s),label:"Nombre completo"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:a(()=>[e(k,{modelValue:o(r).email,"onUpdate:modelValue":l[11]||(l[11]=s=>o(r).email=s),label:"Email"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:a(()=>[e(k,{modelValue:o(r).password,"onUpdate:modelValue":l[12]||(l[12]=s=>o(r).password=s),label:"Password"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:a(()=>[e(H,{modelValue:o(r).role,"onUpdate:modelValue":l[13]||(l[13]=s=>o(r).role=s),items:T,label:"Rol"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(m,{type:"submit"},{default:a(()=>[u(" Enviar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:ae},{default:a(()=>[u(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e($,{persistent:"","no-click-animation":"",width:t.$vuetify.display.smAndDown?"auto":600,"model-value":o(x),"onUpdate:modelValue":L},{default:a(()=>[e(i,{onClick:l[14]||(l[14]=s=>L(!1))}),e(G,{class:"pa-sm-14 pa-5"},{default:a(()=>[e(g,{class:"text-center"},{default:a(()=>[e(E,{class:"text-h5 mb-3 p-5"},{default:a(()=>[xe,he,n("span",null,[u("el usuario "),n("i",null,v(o(b).email),1),u(" ?")])]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(m,{color:"error",onClick:se},{default:a(()=>[u(" Aceptar ")]),_:1}),e(m,{onClick:oe},{default:a(()=>[u(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}}},Ne=ue(Ce,[["__scopeId","data-v-e1a01db5"]]);export{Ne as default};
