import{M as S,r as f,bQ as F,v as j,as as O,o as n,x as c,u as m,a as l,w as p,aQ as L,b as s,aR as M,q as u,p as V,aW as P,N as v,F as B,C as T,t as d,a3 as Q,g as U,bd as q,be as D}from"./index.88d3c7f5.js";const $=_=>(q("data-v-fc2e2b17"),_=_(),D(),_),H={key:0,class:"mt-6"},W={key:1,class:"mt-6"},z={class:"d-flex justify-space-between"},G={class:"d-flex align-center justify-space-between v-card--link"},J={class:"d-flex flex-sm-column"},K={class:"d-flex align-center justify-space-between v-card--link"},X={class:"d-flex flex-sm-column"},Y=$(()=>s("th",null,"Tel\xE9fono",-1)),Z=$(()=>s("th",null,"Respuestas",-1)),ee={class:"d-flex align-center justify-space-between v-card--link"},te={class:"d-flex flex-sm-column"},ae={key:0,role:"alert"},se={__name:"participantesCopy",setup(_){const w=f(!0),R="https://showandevents-service.vercel.app/all",g=f([]);F({type:"asc",column:"total"});const A=j(()=>{const r={};return g.value.forEach(t=>{const e=`${t.nombre}-${t.apellido}`;r[e]?(r[e].porcentajeRespuestas.push(parseFloat(t.porcentajeRespuestas)),t.data[0].trivia.forEach(a=>{a.respuesta!==""&&(r[e].respuestas[a.respuesta]=(r[e].respuestas[a.respuesta]||0)+1)})):r[e]={nombre:t.nombre,apellido:t.apellido,idTrivia:t.idTrivia,telefono:t.telefono,direccion:t.direccion,porcentajeRespuestas:[parseFloat(t.porcentajeRespuestas)],respuestas:t.data[0].trivia.reduce((a,o)=>(o.respuesta!==""&&(a[o.respuesta]=(a[o.respuesta]||0)+1),a),{})}}),Object.values(r)}),b=f(null);f(!0);const i=f({orderBy:"nombre",orderAsc:!0}),h=r=>{r===i.value.orderBy&&(i.value.orderAsc=!i.value.orderAsc),i.value.orderBy=r},I=j(()=>{const r=[...A.value],t=i.value.orderBy,e=i.value.orderAsc;return r.sort((a,o)=>{if(t==="nombre")return e?a.nombre<o.nombre?-1:a.nombre>o.nombre?1:0:o.nombre<a.nombre?-1:o.nombre>a.nombre?1:0;if(t==="apellido")return e?a.apellido<o.apellido?-1:a.apellido>o.apellido?1:0:o.apellido<a.apellido?-1:o.apellido>a.apellido?1:0;if(t==="respuestas"){const C=Object.values(a.respuestas).reduce((x,y)=>x+y,0),k=Object.values(o.respuestas).reduce((x,y)=>x+y,0);return e?C-k:k-C}else return 0})});O(async()=>{try{const t=await(await fetch(R)).json();t.resp===!0?(g.value=t.data.map(e=>({nombre:e.data[0].name,apellido:e.data[0].lastname,idTrivia:e.data[0].idTrivia,telefono:e.data[0].telefono,direccion:e.data[0].direccion,porcentajeRespuestas:`${(e.data[0].trivia.filter(a=>a.respuesta!=="").length/e.data[0].trivia.length*100).toFixed(2)}`,data:e.data})),w.value=!1):b.value="Hubo un problema al cargar los datos"}catch(r){b.value=`Error: ${r.message}`}});function E(){window.location.href="https://showandevents-service.vercel.app/export/excel?idTrivia=1"}function N(){window.location.href="https://showandevents-service.vercel.app/export/csv?idTrivia=2"}return(r,t)=>(n(),c("div",null,[m(w)?(n(),c("div",H,"Cargando datos...")):(n(),c("div",W,[l(U,{class:""},{default:p(()=>[l(L,{class:"pb-sm-0"},{default:p(()=>[s("div",z,[l(M,null,{default:p(()=>[u("Participantes")]),_:1}),s("div",null,[l(V,{class:"me-3",variant:"tonal",color:"success","prepend-icon":"tabler-download",onClick:E},{default:p(()=>[u(" Excel ")]),_:1}),l(V,{variant:"tonal",color:"primary","prepend-icon":"tabler-download",onClick:N},{default:p(()=>[u(" CSV ")]),_:1})])])]),_:1}),l(P,{class:"text-no-wrap w-100 px-4"},{default:p(()=>[s("thead",null,[s("tr",null,[s("th",{onClick:t[0]||(t[0]=e=>h("nombre"))},[s("div",G,[u(" Nombre "),s("span",J,[l(v,{color:"danger",icon:"tabler-chevron-up"}),l(v,{color:"danger",icon:"tabler-chevron-down"})])])]),s("th",{onClick:t[1]||(t[1]=e=>h("apellido"))},[s("div",K,[u(" Apellido "),s("span",X,[l(v,{color:"danger",icon:"tabler-chevron-up"}),l(v,{color:"danger",icon:"tabler-chevron-down"})])])]),Y,Z,s("th",{onClick:t[2]||(t[2]=e=>h("respuestas"))},[s("div",ee,[u(" Respuestas "),s("span",te,[l(v,{color:"danger",icon:"tabler-chevron-up"}),l(v,{color:"danger",icon:"tabler-chevron-down"})])])])])]),s("tbody",null,[(n(!0),c(B,null,T(m(I),e=>(n(),c("tr",{key:`${e.nombre}-${e.apellido}`},[s("td",null,d(e.nombre),1),s("td",null,d(e.apellido),1),s("td",null,d(e.telefono),1),s("td",null,[s("ul",null,[(n(!0),c(B,null,T(e.respuestas,(a,o)=>(n(),c("li",{key:o},d(o)+" ("+d(a)+")",1))),128))])]),s("td",null,d(Object.values(e.respuestas).reduce((a,o)=>a+o,0)),1)]))),128))])]),_:1}),m(b)?(n(),c("div",ae,d(m(b)),1)):Q("",!0)]),_:1})]))]))}},re=S(se,[["__scopeId","data-v-fc2e2b17"]]);export{re as default};
