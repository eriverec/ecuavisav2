import{M as fe,I as ge,R as he,r as u,as as ve,o as n,x as v,a as t,w as l,q as r,t as m,u as o,f as ye,g as B,h as I,p as z,i as Y,b0 as Z,e as be,b7 as xe,b8 as ee,b9 as we,ba as Ce,b as s,aR as Ve,b2 as ke,N as f,n as Me,c as y,Z as ae,$ as D,a0 as Se,a3 as b,a2 as q,aW as je,F as De,C as Le,L as Te,c7 as ze,aM as Ye,X as Re,Y as $e,ao as F,ap as W,V as Ie,bc as Ee,bd as Ue,be as Ne}from"./index.88d3c7f5.js";import{g as te}from"./config.e41fa6da.js";import{d as Pe}from"./debounce.967b9882.js";import{M as Ae}from"./index.50982b4e.js";import{V as He}from"./VSpacer.2a3e77c9.js";import{V as Oe}from"./VPagination.9412c3b8.js";const P=E=>(Ue("data-v-9d554ad4"),E=E(),Ne(),E),Be={class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},qe={class:"px-4"},Fe={class:"d-flex align-center gap-2"},We=P(()=>s("div",{class:"loading"},null,-1)),Ge=P(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col",class:"font-weight-semibold"}," Estado "),s("th",{scope:"col",class:"font-weight-semibold"}," Campa\xF1a "),s("th",{scope:"col",class:"font-weight-semibold"}," Descripci\xF3n "),s("th",{scope:"col",class:"font-weight-semibold"}," Sector "),s("th",{scope:"col",class:"font-weight-semibold"}," Num. Audiencia "),s("th",{scope:"col",class:"font-weight-semibold"}," Tipo de contenido "),s("th",{scope:"col",class:"font-weight-semibold"}," Creaci\xF3n "),s("th",{scope:"col",class:"font-weight-semibold"}," Acciones ")])],-1)),Je={class:"text-center",style:{width:"5.5rem"}},Ke=["title"],Qe={style:{"font-weight":"medium"}},Xe={key:1,class:"d-none",title:"Publicidad activa, iniciada",color:"success"},Ze={style:{"font-weight":"medium"}},ea={class:"d-flex text-xs align-center gap-3 pb-2"},aa={key:0,class:"d-flex flex-column gap-0 align-center mr-2"},ta={key:0,style:{"font-size":"10px"},class:"pt-2 text-primary"},sa={class:"active-opacity"},oa={class:"text-base font-weight-semibold text-with-custom-truncate"},la={key:0,class:"text-disabled",style:{"font-size":"12px"}},ia={class:"text-medium-emphasis active-opacity text-with-custom-truncate pl-2",style:{width:"220px","text-align":"left"}},na={class:"text-xs"},ra={class:"text-medium-emphasis"},da={key:0,class:"active-opacity"},ca={key:0,class:"text-xs text-disabled"},ua={key:1,class:"text-xs text-disabled"},ma={key:1,class:"active-opacity"},pa=P(()=>s("span",{class:"text-xs text-disabled"}," Audiencia personalizada ",-1)),_a=[pa],fa={class:"text-medium-emphasis active-opacity"},ga={class:"text-xs pl-2"},ha={class:"text-medium-emphasis active-opacity"},va={class:"text-xs text-disabled"},ya={class:"text-medium-emphasis active-opacity"},ba={class:"text-xs text-disabled"},xa={class:"text-center",style:{width:"3.5rem"}},wa=P(()=>s("tr",null,[s("td",{colspan:"8",class:"text-center text-body-1"}," No hay registros que mostrar ")],-1)),Ca=[wa],Va={__name:"index",setup(E){const se=ge(),k=he.exports.extendMoment(Ae);var G="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),oe="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),A=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],J=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;k.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(i,a){return i?/-MMM-/.test(a)?oe[i.month()]:G[i.month()]:G},monthsRegex:J,monthsShortRegex:J,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:A,longMonthsParse:A,shortMonthsParse:A,weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(this.hours()!==1?"s":"")+"] LT"},nextDay:function(){return"[ma\xF1ana a la"+(this.hours()!==1?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(this.hours()!==1?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(this.hours()!==1?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(this.hours()!==1?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",w:"una semana",ww:"%d semanas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},dayOfMonthOrdinalParse:/\d{1,2}ยบ/,ordinal:"%d\xBA",week:{dow:1,doy:4},invalidDate:"Fecha inv\xE1lida"}),k.tz.setDefault("America/Guayaquil");const M=u({show:!1,text:"",color:"success",timeout:3e3}),L=u("tab-lista"),w=u(!1);u(1);const S=u([]),R=u(1),H=u(1),K=u(1),Q=u(""),T=u(!1),g=u(!1),U=u(!1),j=u(!1);ve($);async function $(i=1,a=10,d=null){try{j.value=!0;var e=new Headers;e.append("Content-Type","application/json");var p={method:"GET",headers:e,redirect:"follow"},c=await fetch(`https://ads-service.vercel.app/campaign/get/all?page=${i}&limit=${a}`+(d?"&s="+d:""),p);const _=await c.json();for(var x in _.data)_.data[x].type_local="server";const V=pe();console.log("dataClone",V);for(var x in V)V[x].type_local="local";return i==1?S.value=V.concat(_.data):S.value=_.data,_.total=_.total*1+V.length,K.value=_.total,H.value=Math.ceil(_.total/_.limit),j.value=!1,!0}catch(_){return j.value=!1,console.error(_.message)}}const le=async()=>{if(H.value==1)return!1;T.value=!0,await $(R.value),T.value=!1},ie=async i=>{w.value=!0,Q.value=i},ne=async()=>{try{g.value=!0;var i=new Headers;i.append("Content-Type","application/json");var a={method:"DELETE",headers:i,redirect:"follow"},d=await fetch(`https://ads-service.vercel.app/campaign/delete/${Q.value}`,a);const e=await d.json();await $(R.value),g.value=!1,w.value=!1}catch(e){return console.error(e.message)}},re=async i=>{const a=S.value[i],d=a._id,e=a.statusCampaign;U.value=!0;var p={status:e},c=new Headers;c.append("Content-Type","application/json");var x={method:"POST",headers:c,body:JSON.stringify(p),redirect:"follow"},_=await fetch(`https://ads-service.vercel.app/campaign/update/status/${d}`,x);const V=await _.json();V.resp||(alert("Un error se present\xF3: "+V.error),a.statusCampaign=!a.statusCampaign),U.value=!1},C=u(!1),O="crudCampaign";var h=null;function de(i){h=i,C.value=!0}const ce=async(i,a=1,d=1e4)=>{try{var e=new Headers;e.append("Content-Type","application/json");var p={method:"GET",headers:e,redirect:"follow"},c=await fetch(`https://ads-service.vercel.app/campaign/${i}/user-ids?limit=${d}&page=${a}`,p);const x=await c.json();return x&&x.length>0?x:[]}catch{return[]}},ue=i=>i.join(",");async function me(){const i=`${O}|${h._id}`;g.value=!0,h.statusCampaign=!1,h.userId=[],h.created_at=k();let a=1,d=2e4,e=[];for(;;){const c=await ce(h._id,a,d);if(c.length===0)break;e.push(...c),a+=1,console.log(e.length)}h.userId=ue(e),h.campaignTitle=`${h.campaignTitle} ${k().format("HHmmss")}`;const p=h;localStorage.setItem(i,JSON.stringify(p)),console.log("Registro creado:",p),C.value=!1,M.value={show:!0,text:"Registro duplicado",color:"success"},se.push({name:"apps-campaigns-duplicate-id",params:{id:h._id}})}function pe(){const i=[];for(var a=0;a<localStorage.length;a++){var d=localStorage.key(a);if(d.includes(O)){d.split("|")[0];var e=localStorage.getItem(d);i.push(JSON.parse(e))}}return i.sort((p,c)=>new Date(c.created_at)-new Date(p.created_at)),i}async function _e(i){g.value=!0;const a=`${O}|${i}`;localStorage.getItem(a)&&localStorage.removeItem(a),M.value={show:!0,text:"Registro eliminado",color:"success"},await $(1),g.value=!1}const N=u(""),X=Pe(async()=>{var i;try{const a=(i=N.value)==null?void 0:i.toLowerCase();T.value=!0,await $(1,10,a),T.value=!1}catch(a){return console.error("Error en buscarUsuarios:",a),null}},500);return(i,a)=>{const d=Ee;return n(),v("section",null,[t(ye,{modelValue:o(M).show,"onUpdate:modelValue":a[0]||(a[0]=e=>o(M).show=e),color:o(M).color,timeout:o(M).timeout,location:"top end"},{default:l(()=>[r(m(o(M).text),1)]),_:1},8,["modelValue","color","timeout"]),t(Z,{modelValue:o(C),"onUpdate:modelValue":a[4]||(a[4]=e=>Y(C)?C.value=e:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[t(d,{onClick:a[1]||(a[1]=e=>C.value=!o(C)),disabled:o(g)},null,8,["disabled"]),t(B,{title:"Clonar registro"},{default:l(()=>[t(I,null,{default:l(()=>[r(" \xBFDesea clonar el registro? ")]),_:1}),t(I,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[t(z,{disabled:o(g),color:"secondary",variant:"tonal",onClick:a[2]||(a[2]=e=>C.value=!1)},{default:l(()=>[r(" No, Cerrar ")]),_:1},8,["disabled"]),t(z,{onClick:a[3]||(a[3]=e=>me()),loading:o(g),disabled:o(g)},{default:l(()=>[r(" Si, clonar registro ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Z,{modelValue:o(w),"onUpdate:modelValue":a[7]||(a[7]=e=>Y(w)?w.value=e:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[t(d,{onClick:a[5]||(a[5]=e=>w.value=!o(w))}),t(B,{title:"Eliminar registro"},{default:l(()=>[t(I,null,{default:l(()=>[r(" \xBFDesea eliminar el registro? ")]),_:1}),t(I,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[t(z,{color:"secondary",variant:"tonal",onClick:a[6]||(a[6]=e=>w.value=!1)},{default:l(()=>[r(" No, Cerrar ")]),_:1}),t(z,{onClick:ne,loading:o(g),disabled:o(g)},{default:l(()=>[r(" Si, eliminar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ie,null,{default:l(()=>[t(be,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:l(()=>[t(xe,{modelValue:o(L),"onUpdate:modelValue":a[8]||(a[8]=e=>Y(L)?L.value=e:null),class:"v-tabs-pill d-none"},{default:l(()=>[t(ee,{value:"tab-lista",class:"d-none"},{default:l(()=>[r(" Listado ")]),_:1}),t(ee,{value:"tab-agregar",class:"d-none"},{default:l(()=>[r(" Estad\xEDsticas ")]),_:1})]),_:1},8,["modelValue"]),t(B,{class:"mt-5"},{default:l(()=>[t(I,null,{default:l(()=>[t(we,{modelValue:o(L),"onUpdate:modelValue":a[11]||(a[11]=e=>Y(L)?L.value=e:null)},{default:l(()=>[t(Ce,{value:"tab-lista"},{default:l(()=>[s("div",Be,[s("div",null,[t(Ve,null,{default:l(()=>[r(" Listado de campa\xF1as ")]),_:1}),t(ke,null,{default:l(()=>[r(" Elige la campa\xF1a sobre la que necesites informaci\xF3n ")]),_:1})])]),s("div",qe,[s("div",Fe,[t(z,{color:"primary",class:"mb-4",to:{name:"apps-campaigns-create"}},{default:l(()=>[r(" Crear campa\xF1a "),t(f,{size:22,icon:"tabler-plus"})]),_:1}),t(He),t(Me,{clearable:"",disabled:o(T),class:"mb-4",modelValue:o(N),"onUpdate:modelValue":a[9]||(a[9]=e=>Y(N)?N.value=e:null),label:"Buscar por t\xEDtulo o descripci\xF3n","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":"",onInput:o(X),"onClick:clear":o(X),style:{"max-width":"300px"}},null,8,["disabled","modelValue","onInput","onClick:clear"])]),o(j)?(n(),y(ae,{key:0,lines:"two",border:""},{default:l(()=>[t(D,null,{default:l(()=>[t(Se,null,{default:l(()=>[We]),_:1})]),_:1})]),_:1})):b("",!0),o(j)?b("",!0):(n(),y(q,{key:1})),o(j)?b("",!0):(n(),y(je,{key:2,class:"text-no-wrap"},{default:l(()=>[Ge,s("tbody",null,[(n(!0),v(De,null,Le(o(S),(e,p)=>(n(),v("tr",{key:p,style:{height:"3.5rem"},class:Te(e.type_local!="server"?"text-opacity-25":"")},[s("td",Je,[s("div",{title:e.statusCampaign?"Activo":"Inactivo",class:"switch-estatus",style:{"margin-bottom":"-10px"}},[t(ze,{disabled:o(U)||e.type_local=="local",loading:o(U)?"warning":!1,color:e.statusCampaign?"success":"error",modelValue:e.statusCampaign,"onUpdate:modelValue":c=>e.statusCampaign=c,size:"x-small",class:"custom-vswitch",onChange:c=>re(p)},null,8,["disabled","loading","color","modelValue","onUpdate:modelValue","onChange"]),e.statusCampaign!=!0?(n(),y(Ye,{key:0,title:"Publicidad pausada",size:"x-small",label:"",color:"error",class:"d-none"},{default:l(()=>[s("span",Qe,m(e.statusCampaign?"Activo":"Inactivo"),1)]),_:2},1024)):b("",!0),e.statusCampaign==!0?(n(),v("small",Xe,[s("span",Ze,m(e.statusCampaign?"Activo":"Inactivo"),1)])):b("",!0)],8,Ke)]),s("td",null,[s("div",ea,[(Array.isArray(e.criterial.country)?e.criterial.country.length>0:!0)&&e.criterial.country!=null&&e.criterial.country!=-1?(n(),v("div",aa,[t(Re,{title:"Ubicaci\xF3n: "+e.criterial.country+", "+e.criterial.city,class:"",size:"24",image:"https://flagcdn.com/w320/"+o(te)(e.criterial.country)["alpha-2"].toLowerCase()+".png"},null,8,["title","image"]),s("small",null,m(o(te)(e.criterial.country)["alpha-2"]),1)])):(n(),y(f,{key:1,color:"primary",size:"25",icon:"mdi-google-analytics"})),s("div",null,[e.type_local!="server"?(n(),v("div",ta,[t(f,{size:"10",icon:"mdi-warning"}),r(" No guardado")])):b("",!0),s("div",sa,[s("h6",oa,m(e.campaignTitle),1),e.fechai!=null?(n(),v("span",la,m(o(k)(e.fechai).startOf("days").format("dddd, D MMM YY"))+" al "+m(o(k)(e.fechaf).endOf("days").format("dddd, D MMM YY")),1)):b("",!0)])])])]),s("td",ia,[s("span",na,m(e.description),1)]),s("td",ra,[e.criterial.country!=null&&e.criterial.country!=-1&&e.participantes!="personalizado"?(n(),v("div",da,[e.criterial.city!=-1?(n(),v("span",ca,[t(f,{icon:"mdi-location"}),r(" "+m(e.criterial.country)+","+m(e.criterial.city=="0"?"":", "+e.criterial.city),1)])):(n(),v("span",ua,[t(f,{icon:"mdi-location"}),r(" "+m(Array.isArray(e.criterial.country)?e.criterial.country.length>0?e.criterial.country.join(", "):"No definido":e.criterial.country)+", Todas las ciudades ",1)]))])):(n(),v("div",ma,_a))]),s("td",fa,[s("span",ga,[t(f,{icon:"mdi-account-group"}),r(": "+m(e.sizeUsersId),1)])]),s("td",ha,[s("span",va,m(e.type),1)]),s("td",ya,[s("span",ba,m(o(k)(e.created_at).format("YYYY-MM-DD, HH:mm:ss")),1)]),s("td",xa,[t(z,{icon:"",variant:"plain",color:"default",size:"x-small"},{default:l(()=>[t(f,{title:e.campaignTitle,size:22,icon:"tabler-dots-vertical"},null,8,["title"]),t($e,{activator:"parent"},{default:l(()=>[t(ae,{density:"compact"},{default:l(()=>[e.type_local=="server"?(n(),y(D,{key:0,to:{name:"apps-campaigns-edit-id",params:{id:e._id}}},{default:l(()=>[t(f,{size:"15",class:"mr-1",icon:"mdi-edit"}),r(" Editar campa\xF1a ")]),_:2},1032,["to"])):b("",!0),e.type_local=="local"?(n(),y(D,{key:1,to:{name:"apps-campaigns-duplicate-id",params:{id:e._id}}},{default:l(()=>[t(f,{size:"18",class:"mr-1",icon:"mdi-content-save-outline"}),r(" Terminar de guardar la campa\xF1a ")]),_:2},1032,["to"])):b("",!0),e.type_local=="server"?(n(),y(D,{key:2,href:"#",onClick:c=>de(e)},{default:l(()=>[t(f,{size:"15",class:"mr-1",icon:"mdi-content-copy"}),r(" Clonar campa\xF1a ")]),_:2},1032,["onClick"])):b("",!0),e.type_local=="server"?(n(),y(D,{key:3,to:{name:"apps-campaigns-view-id",params:{id:e._id}}},{default:l(()=>[t(f,{size:"18",class:"mr-1",icon:"mdi-eye-outline"}),r(" Ver campa\xF1a ")]),_:2},1032,["to"])):b("",!0),t(q),e.type_local=="server"?(n(),y(D,{key:4,href:"#",onClick:c=>ie(e._id)},{default:l(()=>[t(f,{size:"18",class:"mr-1",color:"error",icon:"mdi-trash-can-outline"}),r(" Eliminar campa\xF1a ")]),_:2},1032,["onClick"])):(n(),y(D,{key:5,href:"#",onClick:c=>_e(e._id)},{default:l(()=>[t(f,{size:"18",class:"mr-1",color:"error",icon:"mdi-trash-can-outline"}),r(" Eliminar campa\xF1a ")]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024)])],2))),128))]),F(s("tfoot",null,Ca,512),[[W,!o(S).length]])]),_:1})),F(t(q,null,null,512),[[W,o(S).length>1&&!o(j)]]),F(s("span",{class:"text-sm text-disabled mt-4 d-block"}," Total de registros "+m(o(K)),513),[[W,o(S).length]]),t(Oe,{disabled:o(T),modelValue:o(R),"onUpdate:modelValue":a[10]||(a[10]=e=>Y(R)?R.value=e:null),length:o(H),class:"mt-4",onClick:le},null,8,["disabled","modelValue","length"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})])}}},za=fe(Va,[["__scopeId","data-v-9d554ad4"]]);export{za as default};
