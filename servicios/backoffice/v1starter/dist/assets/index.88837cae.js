import{M as ye,R as xe,S as we,U as De,r as u,as as Ce,v as ke,z as Se,o as S,x as H,a as e,w as t,q as c,t as m,u as o,f as Ye,h as z,a$ as je,i as p,b0 as G,e as _,g as Q,aR as te,aQ as E,b as n,p as g,c as J,aW as Me,F as Te,C as Pe,N as se,V as W,l as Fe,m as Ue,c7 as Le,n as O,aT as Ne,$ as Ie,aU as $e,aV as ze,a1 as Ee,bc as Je,aX as Oe,bd as Re,be as Be}from"./index.88d3c7f5.js";/* empty css              */import{V as oe}from"./VCheckbox.50e352e3.js";const F=L=>(Re("data-v-b7d1bfcc"),L=L(),Be(),L),Ae={class:"d-flex flex-wrap gap-4 mt-10"},qe=F(()=>n("thead",null,[n("tr",null,[n("th",{scope:"col"},"T\xEDtulo"),n("th",{scope:"col"},"Fecha de inicio"),n("th",{scope:"col"},"Fecha de fin"),n("th",{scope:"col"},"Acciones")])],-1)),He={class:"text-medium-emphasis d-flex flex-column py-2",style:{height:"55px"}},Ge={class:"text-medium-emphasis"},Qe={class:"text-medium-emphasis"},We={class:"text-medium-emphasis"},Xe={class:"d-flex align-center justify-space-between botonescurrentPage"},Ke=F(()=>n("label",null,"Indenfica si la semana es de repechaje",-1)),Ze={class:"switch-estatus",style:{"margin-bottom":"-10px"}},ea=F(()=>n("div",{class:"mb-1"},"Seleccione el rango de fecha para la semana",-1)),aa={class:"date-picker-wrapper",style:{width:"100%"}},la=F(()=>n("span",null,"Seleccione los desaf\xEDos para la semana",-1)),ta={class:"d-flex"},sa={class:"d-flex flex-column"},oa={style:{"max-width":"300px","font-size":"13px","line-height":"1.2"},class:"py-0 my-0 mb-1"},na={class:"pb-0 mb-0",style:{"font-size":"10px"}},ia=F(()=>n("b",null,"D\xEDa:",-1)),ua={class:"pb-0 mb-0",style:{"font-size":"10px"}},da=F(()=>n("b",null,"Tarjeta:",-1)),ca={class:"pb-0 mb-0",style:{"font-size":"10px"}},ra={__name:"index",setup(L){const V=xe.exports.extendMoment(we);V.locale("es",[De]);const N=u([]),R=u(!1),r=u(!1),ne=u(!1),B=u([]),X=u(!1),y=u(!1),ie=[{title:"Lunes",value:1},{title:"Martes",value:2},{title:"Mi\xE9rcoles",value:3},{title:"Jueves",value:4},{title:"Viernes",value:5},{title:"S\xE1bado",value:6},{title:"Domingo",value:0}];async function A(){try{R.value=!0;const l=await(await fetch("https://servicio-desafios.vercel.app/semana/all/get")).json();let d=Array.from(l.data);N.value=d.map(i=>({...i,fecha_inicio:V(i.fecha_inicio).utc().format("DD/MM/YYYY"),fecha_fin:V(i.fecha_fin).utc().format("DD/MM/YYYY")})),R.value=!1}catch(s){console.error(s.message)}}async function ue(){try{ne.value=!0;const l=await(await fetch("https://servicio-desafios.vercel.app/desafios")).json();B.value=l.data.map(({tituloDesafio:d,_id:i,descripcionDesafio:$,horarios:a=null,tituloSticker:T,categoria:P=null})=>{var be=P?P.title:"",le=0;return a&&a.length>0&&(le=a[0].dia),{title:`${d} - ${be}`,value:i,descripcionDesafio:$,tituloSticker:T,dia:ie.filter(Ve=>le===Ve.value)[0].title}})}catch(s){console.error(s.message)}}Ce(async()=>{r.value=!0,await A(),await ue(),r.value=!1});const I=8,h=u(1),de=ke(()=>{const s=(h.value-1)*I,l=s+I;return N.value.slice(s,l)}),ce=()=>{h.value*I<N.value.length&&h.value++},re=()=>{h.value>1&&h.value--},x=u(!1),Y=u(""),K=u(""),w=u(""),D=u(""),C=u(""),v=u([]),j=u(""),M=u(""),k=u(""),U=u(""),f=u({message:"Datos guardados",type:"success",model:!1});function q(){w.value="",D.value="",C.value="",v.value=[],j.value="",M.value="",k.value="",U.value="",y.value=!1}function Z(){q(),x.value=!1}function me(s,l,d){s.length>1&&(j.value=V(s[0]).format("DD-MM-YYYY"),M.value=V(s[1]).format("DD-MM-YYYY"))}async function fe(){r.value=!0,q(),Y.value="add",x.value=!0,r.value=!1}const ee=u("");function ve(s,l){return s.filter(i=>l.includes(i.value)).map(i=>i.value)}async function pe(s){r.value=!0,q(),Y.value="edit";const i=(await(await fetch("https://servicio-desafios.vercel.app/semana/get/"+s)).json()).data;K.value=i.titulo,ee.value=i._id,w.value=i.titulo,D.value=i.descripcion,C.value=i.imagen_descriptiva,k.value=i.urlPremio,y.value=i.repechaje||!1,v.value=ve(B.value,i.desafios),j.value=V(i.fecha_inicio).utc().format("DD/MM/YYYY"),M.value=V(i.fecha_fin).utc().format("DD/MM/YYYY"),U.value=String(j.value+" a "+M.value),r.value=!1,x.value=!0}async function _e(){v.value.length==0&&(f.value={message:"Debe ingresar almenos 1 desaf\xEDo",type:"error",model:!0});var s=new Headers;if(s.append("Content-Type","application/json"),Y.value==="add"){let i={titulo:w.value,descripcion:D.value,imagen_descriptiva:C.value,urlPremio:k.value,desafios:v.value,repechaje:y.value,fecha_inicio:j.value,fecha_fin:M.value};var l=JSON.stringify(i),d={method:"POST",headers:s,body:l,redirect:"follow"};const a=await(await fetch("https://servicio-desafios.vercel.app/semana/create",d)).json();if(a.resp)f.value={message:"Semana de desaf\xEDos creada correctamente",type:"success",model:!0};else return f.value={message:a.mensaje,type:"error",model:!0},console.error(a.error),!1}else if(Y.value==="edit"){console.log(v.value);let i={_id:ee.value,titulo:w.value,descripcion:D.value,repechaje:y.value,imagen_descriptiva:C.value,urlPremio:k.value,desafios:v.value,fecha_inicio:j.value,fecha_fin:M.value};var l=JSON.stringify(i),d={method:"PUT",headers:s,body:l,redirect:"follow"};const P=await(await fetch("https://servicio-desafios.vercel.app/semana/update",d)).json();P.resp?f.value={message:"Semana de desaf\xEDos actualizada correctamente",type:"success",model:!0}:f.value={message:P.mensaje,type:"error",model:!0}}await A(),x.value=!1}const b=u(!1),ae=u("");function ge(s){r.value=!0,b.value=!0,ae.value=s,r.value=!1}async function he(){r.value=!0;var s={method:"DELETE",redirect:"follow"};const d=await(await fetch("https://servicio-desafios.vercel.app/semana/delete/"+ae.value,s)).json();d.resp?f.value={message:"Semana de desaf\xEDo eliminada correctamente",type:"success",model:!0}:f.value={message:d.mensaje,type:"error",model:!0},await A(),b.value=!1,r.value=!1}return(s,l)=>{const d=Je,i=Oe,$=Se("v-list-item-content");return S(),H("section",null,[e(Ye,{modelValue:o(f).model,"onUpdate:modelValue":l[0]||(l[0]=a=>o(f).model=a),location:"top end",variant:"flat",timeout:o(f).timeout||2e3,color:o(f).type},{default:t(()=>[c(m(o(f).message),1)]),_:1},8,["modelValue","timeout","color"]),e(G,{modelValue:o(r),"onUpdate:modelValue":l[1]||(l[1]=a=>p(r)?r.value=a:null),persistent:"","no-click-animation":"",width:"300"},{default:t(()=>[e(z,{class:"pt-3 text-center"},{default:t(()=>[e(je,{indeterminate:"",color:"primary"})]),_:1})]),_:1},8,["modelValue"]),e(W,null,{default:t(()=>[e(_,{cols:"12",sm:"12",lg:"12"},{default:t(()=>[e(Q,null,{default:t(()=>[e(te,{class:"pt-4 pl-6"},{default:t(()=>[c("Listado de semanas de desaf\xEDos")]),_:1}),e(E,{style:{"margin-bottom":"-2rem"}},{default:t(()=>[n("div",Ae,[e(g,{"prepend-icon":"tabler-plus",color:"success",variant:"tonal",class:"ml-auto",onClick:fe},{default:t(()=>[c(" Nueva semana ")]),_:1})])]),_:1}),o(R)?(S(),J(E,{key:0},{default:t(()=>[c(" Cargando datos... ")]),_:1})):(S(),J(E,{key:1},{default:t(()=>[e(Me,{class:"text-no-wrap tableNavegacion mb-5"},{default:t(()=>[qe,n("tbody",null,[(S(!0),H(Te,null,Pe(o(de),a=>(S(),H("tr",null,[n("td",He,[c(m(a.titulo)+" ",1),n("small",null,m(a.descripcion),1)]),n("td",Ge,m(a.fecha_inicio),1),n("td",Qe,m(a.fecha_fin),1),n("td",We,[e(g,{color:"success",variant:"text",icon:"",onClick:T=>pe(a._id)},{default:t(()=>[e(se,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(g,{icon:"",color:"error",variant:"text",onClick:T=>ge(a._id)},{default:t(()=>[e(se,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),n("div",Xe,[e(g,{icon:"tabler-arrow-big-left-lines",onClick:re,disabled:o(h)===1},null,8,["disabled"]),c(" P\xE1gina "+m(o(h))+" ",1),e(g,{icon:"tabler-arrow-big-right-lines",onClick:ce,disabled:o(h)*I>=o(N).length},null,8,["disabled"])])]),_:1}))]),_:1})]),_:1})]),_:1}),e(G,{modelValue:o(x),"onUpdate:modelValue":l[10]||(l[10]=a=>p(x)?x.value=a:null),persistent:"","no-click-animation":"","max-width":"800"},{default:t(()=>[e(d,{onClick:Z}),e(Q,{class:"pa-sm-14 pa-5"},{default:t(()=>[e(E,{class:"text-center"},{default:t(()=>[e(te,{class:"text-h5 mb-3"},{default:t(()=>[c(m(o(Y)==="add"||o(Y)==="duplicate"?"Nueva semana":"Editar "+o(K)),1)]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(Fe,{class:"mt-6",onSubmit:Ue(_e,["prevent"])},{default:t(()=>[e(W,{class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(W,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[Ke,n("div",Ze,[e(Le,{disabled:o(X),loading:o(X)?"warning":!1,color:"success",modelValue:o(y),"onUpdate:modelValue":l[2]||(l[2]=a=>p(y)?y.value=a:null),size:"x-small",class:"custom-vswitch",onChange:l[3]||(l[3]=a=>s.handleSwitchChange(s.index))},null,8,["disabled","loading","modelValue"])])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(O,{modelValue:o(w),"onUpdate:modelValue":l[4]||(l[4]=a=>p(w)?w.value=a:null),label:"T\xEDtulo",placeholder:"Nombre de la trivia"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(O,{modelValue:o(D),"onUpdate:modelValue":l[5]||(l[5]=a=>p(D)?D.value=a:null),label:"Descripci\xF3n",placeholder:"Descripci\xF3n de la trivia"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(O,{modelValue:o(C),"onUpdate:modelValue":l[6]||(l[6]=a=>p(C)?C.value=a:null),label:"Im\xE1gen descriptiva",placeholder:"Im\xE1gen descriptiva"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(O,{modelValue:o(k),"onUpdate:modelValue":l[7]||(l[7]=a=>p(k)?k.value=a:null),label:"Link del premio para la semana",placeholder:"Link del premio para la semana"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[ea,n("div",aa,[e(i,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:o(U),"onUpdate:modelValue":l[8]||(l[8]=a=>p(U)?U.value=a:null),"show-current":"true",onOnChange:me,config:{position:"auto right",mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",reactive:!0}},null,8,["modelValue"])])]),_:1}),e(_,{cols:"12"},{default:t(()=>[la,e(Ne,{clearable:"",chips:"",multiple:"",modelValue:o(v),"onUpdate:modelValue":l[9]||(l[9]=a=>p(v)?v.value=a:null),items:o(B),"menu-props":{maxHeight:"400"},"item-text":"title","item-value":"value"},{selection:t(({item:a})=>[n("div",null,m(a.title)+" - "+m(a.value),1)]),item:t(({item:a,props:T,on:P})=>[e(Ie,$e(ze(T)),{default:t(()=>[e($,null,{default:t(()=>[e(Ee,null,{default:t(()=>[n("div",ta,[o(v).includes(a.value)?(S(),J(oe,{key:0,"model-value":s.disabledCheckbox=!0,readonly:""},null,8,["model-value"])):(S(),J(oe,{key:1,"model-value":s.disabledCheckbox=!1,readonly:""},null,8,["model-value"])),n("div",sa,[n("div",oa,m(a.raw.descripcionDesafio),1),n("p",na,[ia,c(" "+m(a.raw.dia),1)]),n("p",ua,[da,c(" "+m(a.raw.tituloSticker),1)]),n("p",ca,"_id: "+m(a.value),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),e(_,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(g,{type:"submit"},{default:t(()=>[c(" Guardar ")]),_:1}),e(g,{color:"secondary",variant:"tonal",onClick:Z},{default:t(()=>[c(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(G,{modelValue:o(b),"onUpdate:modelValue":l[13]||(l[13]=a=>p(b)?b.value=a:null),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(d,{onClick:l[11]||(l[11]=a=>b.value=!o(b))}),e(Q,{title:"Eliminar registro"},{default:t(()=>[e(z,null,{default:t(()=>[c(" \xBFDesea eliminar la trivia? ")]),_:1}),e(z,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(g,{color:"secondary",variant:"tonal",onClick:l[12]||(l[12]=a=>b.value=!1)},{default:t(()=>[c(" No, Cerrar ")]),_:1}),e(g,{onClick:he},{default:t(()=>[c(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},pa=ye(ra,[["__scopeId","data-v-b7d1bfcc"]]);export{pa as default};
