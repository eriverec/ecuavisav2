import{ck as X,bZ as R,M as ee,R as ae,S as te,U as le,r as n,I as se,bH as oe,v as A,z as ie,o as _,x as p,a as e,w as l,e as w,b7 as ne,u as i,i as C,b8 as de,q as d,g as N,b9 as re,ba as E,b0 as P,h as k,p as g,bw as ue,b as s,n as O,aW as ce,F as me,C as fe,t as S,a3 as j,N as z,aM as H,a2 as ve,aQ as _e,aR as pe,l as ge,m as he,V as q,c7 as be,a4 as J,bc as xe,bd as Ve,be as ye}from"./index.88d3c7f5.js";const we=X("BannersListStore",{actions:{fetchCategorias(){return R.get("https://estadisticas.ecuavisa.com/sites/gestor/Tools/miecuavisa/index.php")},sendCategorias(V){return new Promise((T,B)=>{let r=JSON.stringify(V),f={method:"POST",maxBodyLength:1/0,url:"https://estadisticas.ecuavisa.com/sites/gestor/Tools/miecuavisa/ajax.php",headers:{"Content-Type":"application/json"},data:r};R.request(f).then(c=>T(c)).catch(c=>B(c))})}}});const Y=V=>(Ve("data-v-184b81c0"),V=V(),ye(),V),Ce={class:"pl-4"},ke=Y(()=>s("br",null,null,-1)),Se={style:{width:"30%"},class:"d-flex gap-1 px-0 position-relative"},Te=Y(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"},"ID"),s("th",{scope:"col"},"Nombre para el banner"),s("th",{scope:"col"},"IMG Escritorio"),s("th",{scope:"col",style:{display:"none"}},"IMG mobile"),s("th",{scope:"col"},"P\xE1gina a mostrar"),s("th",{scope:"col"},"Estado"),s("th",{scope:"col"},"Acciones")])],-1)),Ie={style:{height:"3.5rem"}},De={class:"d-flex align-left"},Ue={class:"d-flex flex-column"},Le={class:"text-base"},Ne={class:"d-flex align-left"},Oe={class:"d-flex flex-column"},ze={class:"text-base"},Be={class:"d-flex align-left"},Pe={class:"d-flex flex-column pt-2 pb-2"},$e=["src"],Me={style:{display:"none"}},Fe={class:"d-flex align-left"},Re={class:"d-flex flex-column"},Ae=["src"],Ee={class:"d-flex align-left"},je={class:"d-flex flex-column"},He={class:"text-base"},qe={key:0},Je=["href"],Ye={key:1},Ge=["href"],We={class:"d-flex align-left"},Ke={class:"d-flex flex-column"},Qe={class:"text-base"},Ze={key:0},Xe={key:1},ea={class:"text-center",style:{width:"5rem"}},aa={class:"px-4 py-4"},ta={class:"px-2"},la={__name:"index",setup(V){const T=ae.exports.extendMoment(te);T.locale("es",[le]);const B=we(),r=n([]);n([]);const f=n(!1);n(!1),n(!1);const c=n(1),I=n(10);var D=n(1);const u=n({});n([]),n([]),n([]);const b=n(!1),y=n("tab-lista"),h=n(!1);n(T().format("DD/MM/YYYY HH:mm:ss").toString()),n(JSON.parse(localStorage.getItem("userData")));const G=se(),U=()=>{B.fetchCategorias().then(o=>{r.value=o.data.data}).catch(o=>{console.error(o)})};(()=>{let o=localStorage.getItem("role");o!=="administrador"&&o!=="webmaster"&&G.push({path:"/pages/errors/not-authorized"})})(),oe(U),D.value=A(()=>Math.ceil(r.value.length/I.value));const W=o=>{u.value=o,f.value=!0};var $={};async function M(o,t=!1){if(!t)return h.value=!0,$=o,!1;J("editar",o),h.value=!1,o=$,f.value=!1,b.value=!0;var m=new Headers,x={method:"POST",headers:m,body:JSON.stringify({id:o.id}),redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/miecuavisa/ajax.php?action=delete",x).then(a=>a.text()).then(a=>{console.log(a),window.setTimeout(U,600),f.value=!1,b.value=!1}).catch(a=>{console.log("error",a)})}async function K(o){b.value=!0,r.value;let t=r.value.map(v=>v.id).indexOf(o),m={id:r.value[t].id,url:r.value[t].url,name:r.value[t].name,mobile:r.value[t].images.mobile,escritorio:r.value[t].images.escritorio,estado:u.value.estado};f.value=!1,console.log("sending ",m);var x=new Headers,a={method:"POST",headers:x,body:JSON.stringify(m),redirect:"follow"};await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/miecuavisa/ajax.php",a).then(v=>v.text()).then(v=>{console.log(v),b.value=!1,window.setTimeout(U,600)}).catch(v=>{alert("Ocurri\xF3 un error al guardar el registro"),console.log("error",v)}),J("editar",m)}const Q=()=>{f.value=!1},F=o=>{o===!1&&window.setTimeout(U,300),f.value=o},L=n("");var Z=A(()=>{var o=r.value.filter(a=>(console.log(a.id),a.name.toLowerCase().includes(L.value.toLowerCase())));const t=(c.value-1)*I.value,m=t+I.value;var x=o.slice(t,m);return D.value=Math.ceil(o.length/I.value),x});return(o,t)=>{const m=xe,x=ie("RouterLink");return _(),p("section",null,[e(q,null,{default:l(()=>[e(w,{class:"mt-6",cols:"12",md:"12",lg:"12"},{default:l(()=>[e(ne,{modelValue:i(y),"onUpdate:modelValue":t[0]||(t[0]=a=>C(y)?y.value=a:null),class:"v-tabs-pill"},{default:l(()=>[e(de,{value:"tab-lista"},{default:l(()=>[d(" Listado ")]),_:1})]),_:1},8,["modelValue"]),e(N,{class:"mt-5",title:"Banner personalizado"},{default:l(()=>[e(re,{modelValue:i(y),"onUpdate:modelValue":t[15]||(t[15]=a=>C(y)?y.value=a:null)},{default:l(()=>[e(E,{value:"tab-lista"},{default:l(()=>[e(P,{modelValue:i(h),"onUpdate:modelValue":t[4]||(t[4]=a=>C(h)?h.value=a:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[e(m,{onClick:t[1]||(t[1]=a=>h.value=!i(h))}),e(N,{title:"\xBFDesea eliminar el registro?"},{default:l(()=>[e(k,null,{default:l(()=>[d(" Al eliminar no se podr\xE1 recuperar ")]),_:1}),e(k,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[e(g,{color:"secondary",variant:"tonal",onClick:t[2]||(t[2]=a=>h.value=!1)},{default:l(()=>[d(" No, Cancelar ")]),_:1}),e(g,{onClick:t[3]||(t[3]=a=>M([],!0))},{default:l(()=>[d(" Si, Eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(P,{modelValue:i(b),"onUpdate:modelValue":t[5]||(t[5]=a=>C(b)?b.value=a:null),width:"300"},{default:l(()=>[e(N,{color:"primary",width:"300"},{default:l(()=>[e(k,{class:"pt-3"},{default:l(()=>[d(" Guardando informaci\xF3n "),e(ue,{indeterminate:"",color:"white",class:"mb-0"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s("div",Ce,[e(x,{to:"./add"},{default:l(()=>[e(g,{color:"primary",variant:"tonal"},{default:l(()=>[d(" A\xF1adir nuevo registro ")]),_:1})]),_:1})]),ke,e(k,{class:"py-4 gap-0 w-100"},{default:l(()=>[s("div",Se,[e(O,{modelValue:i(L),"onUpdate:modelValue":t[6]||(t[6]=a=>C(L)?L.value=a:null),pattern:"\\d*",placeholder:"Buscar por nombre...",class:"ms-0 me-1 chat-list-search"},null,8,["modelValue"])])]),_:1}),e(ce,{class:"text-no-wrap p-10"},{default:l(()=>[Te,s("tbody",null,[(_(!0),p(me,null,fe(i(Z),a=>(_(),p("tr",Ie,[s("td",null,[s("div",De,[s("div",Ue,[s("h6",Le,S(a.id),1)])])]),s("td",null,[s("div",Ne,[s("div",Oe,[s("h6",ze,S(a.name),1)])])]),s("td",null,[s("div",Be,[s("div",Pe,[a.images.escritorio!==""?(_(),p("img",{key:0,src:a.images.escritorio,width:"175",class:"img-intereses"},null,8,$e)):j("",!0)])])]),s("td",Me,[s("div",Fe,[s("div",Re,[a.images.mobile!==""?(_(),p("img",{key:0,src:a.images.mobile,width:"175",class:"img-intereses"},null,8,Ae)):j("",!0)])])]),s("td",null,[s("div",Ee,[s("div",je,[s("h6",He,[a.url=="https://www.ecuavisa.com/servicios/mi-ecuavisa/"?(_(),p("div",qe,[s("a",{href:a.url,target:"_blank"},[d("Landing mi ecuavisa "),e(z,null,{default:l(()=>[d("mdi-link-variant")]),_:1})],8,Je)])):(_(),p("div",Ye,[s("a",{href:a.url,target:"_blank"},[d("Otro landing "),e(z,null,{default:l(()=>[d("mdi-link-variant")]),_:1})],8,Ge)]))])])])]),s("td",null,[s("div",We,[s("div",Ke,[s("h6",Qe,[a.estado?(_(),p("div",Ze,[e(H,{color:"success"},{default:l(()=>[d(" Activo ")]),_:1})])):(_(),p("div",Xe,[e(H,{color:"error"},{default:l(()=>[d(" Inactivo ")]),_:1})]))])])])]),s("td",ea,[e(g,{icon:"",size:"x-small",color:"default",variant:"text",onClick:v=>W(a)},{default:l(()=>[e(z,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(g,{icon:"",size:"x-small",color:"error",variant:"text",onClick:v=>M(a)},{default:l(()=>[e(z,{size:"22",icon:"mdi-delete-forever"})]),_:2},1032,["onClick"])])]))),256))])]),_:1}),e(ve),s("div",aa,[e(g,{disabled:i(c)===1,onClick:t[7]||(t[7]=a=>c.value-=1),size:"small",color:"primary"},{default:l(()=>[d(" Anterior ")]),_:1},8,["disabled"]),s("span",ta,S(i(c))+" de "+S(i(D))+" de un total de "+S(i(r).length)+" registros",1),e(g,{disabled:i(c)===i(D),onClick:t[8]||(t[8]=a=>c.value+=1),size:"small",color:"primary"},{default:l(()=>[d(" Siguiente ")]),_:1},8,["disabled"])]),e(P,{width:o.$vuetify.display.smAndDown?"auto":700,"model-value":i(f),"onUpdate:modelValue":F},{default:l(()=>[e(m,{onClick:t[9]||(t[9]=a=>F(!1))}),e(N,{class:"pa-sm-14 pa-5"},{default:l(()=>[e(_e,{class:"text-center"},{default:l(()=>[e(pe,{class:"text-h5 mb-3"},{default:l(()=>[d(" Editar banner ")]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(ge,{class:"mt-6",onSubmit:t[14]||(t[14]=he(a=>K(i(u).id),["prevent"]))},{default:l(()=>[e(q,{class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(w,{cols:"8"},{default:l(()=>[e(O,{modelValue:i(u).name,"onUpdate:modelValue":t[10]||(t[10]=a=>i(u).name=a),label:"Nombre del banner"},null,8,["modelValue"])]),_:1}),e(w,{cols:"8"},{default:l(()=>[e(O,{modelValue:i(u).images.escritorio,"onUpdate:modelValue":t[11]||(t[11]=a=>i(u).images.escritorio=a),label:"Url para la imagen en escritorio"},null,8,["modelValue"])]),_:1}),e(w,{cols:"8",style:{display:"none"}},{default:l(()=>[e(O,{modelValue:i(u).images.mobile,"onUpdate:modelValue":t[12]||(t[12]=a=>i(u).images.mobile=a),label:"Url para la imagen en mobile"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(be,{modelValue:i(u).estado,"onUpdate:modelValue":t[13]||(t[13]=a=>i(u).estado=a),density:"compact",label:"Publicado"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(g,{type:"submit"},{default:l(()=>[d(" Enviar ")]),_:1}),e(g,{color:"secondary",variant:"tonal",onClick:Q},{default:l(()=>[d(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])]),_:1}),e(E,{value:"tab-estadistica"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}},ia=ee(la,[["__scopeId","data-v-184b81c0"]]);export{ia as default};
