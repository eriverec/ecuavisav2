import{M as K,R as Q,S as Z,U as ee,ak as te,r as n,as as ae,v as se,u as r,o as i,x as d,a as c,w as b,q as oe,aR as R,V as re,e as B,i as A,aT as le,b as s,L as I,N as q,bx as z,a3 as L,c as ne,F as ce,C as ie,t as M,aW as ue,bP as h,aX as de,bd as pe,be}from"./index.88d3c7f5.js";const N=p=>(pe("data-v-8102c678"),p=p(),be(),p),me={key:0,class:"text-center py-3"},ve={key:1},he={class:"tab-titles parentTabs"},fe={class:"tab-content"},_e={key:0,class:"tab-item"},ye={key:1,class:"tab-item"},ge={key:0,class:"text-center py-5"},Te=N(()=>s("thead",null,[s("tr",null,[s("th",null,"Raz\xF3n de cancelaci\xF3n"),s("th")])],-1)),Ye=N(()=>s("td",null,"TOTAL",-1)),we={data(){return{selectedTab:0}},methods:{selectTab(p){this.selectedTab=p}}},xe=Object.assign(we,{__name:"baja-suscriptores-motivo",setup(p){const u=Q.exports.extendMoment(Z);u.locale("es",[ee]);const E=e=>{const t=`rgba(${h(e.colors["on-surface"])},${e.variables["medium-emphasis-opacity"]})`,l=`rgba(${h(e.colors["on-surface"])},${e.variables["disabled-opacity"]})`,a=`rgba(${h(String(e.variables["border-color"]))},${e.variables["border-opacity"]})`,o=`rgba(${h(e.colors["on-surface"])},${e.variables["high-emphasis-opacity"]})`;return{themeSecondaryTextColor:t,themeDisabledTextColor:l,themeBorderColor:a,themePrimaryTextColor:o}},U=te(),f=n([]),{themeBorderColor:k,themeDisabledTextColor:V,themeSecondaryTextColor:H}=E(U.current.value),_=n([]),y=n(u().subtract(1,"days").format("DD-MM-YYYY").toString()+" a "+u().format("DD-MM-YYYY").toString()),g=n(!0),T=n({}),Y=n(u().format("YYYY-MM-DD")),w=n(u().subtract(1,"days").format("YYYY-MM-DD")),x=n(null),C=n([]),j=n(0),S=n({chart:{type:"donut"},labels:[],legend:{position:"bottom",markers:{offsetX:-3},labels:{colors:H},itemMargin:{vertical:3,horizontal:10}}}),$=n([]);async function X(){const t=await(await fetch(`https://api-configuracion.vercel.app/web/baja-suscriptores-motivo?from=${Y.value}&to=${w.value}`)).json();if(t.status==="ok"){const a=t.resultForChart.mounts,o=Object.keys(a),D=Object.values(a);S.value.labels=o,$.value=D;const P=Object.entries(a).sort((m,v)=>v[1]-m[1]).reduce((m,[v,J])=>({...m,[v]:J}),{});t.value=P,T.value=P,j.value=Object.values(a).reduce((m,v)=>m+v,0)}else console.error("Error en la respuesta de la API")}async function F(){await fetch(`https://api-configuracion.vercel.app/web/baja-suscriptores-motivo?from=${Y.value}&to=${w.value}`).then(e=>e.json()).then(e=>{const t=e.resultForChart.mounts,l=Object.entries(t).sort((a,o)=>o[1]-a[1]).reduce((a,[o,D])=>({...a,[o]:D}),{});f.value=l,T.value=l,j.value=Object.values(t).reduce((a,o)=>a+o,0),g.value=!1})}async function W(){const t=await(await fetch("https://ecuavisa-modulos.vercel.app/paquete")).json();t.resp&&t.data&&t.data.length>0?C.value=t.data.map(l=>l.nombre):console.error("Error en la respuesta de la API")}ae(async()=>{await F(),await X(),await W()});const G=async e=>{if(e.length>1){_.value=e;let t=Array.from(_.value);Y.value=u(t[0]).format("YYYY-MM-DD"),w.value=u(t[1]).format("YYYY-MM-DD"),await F()}},O=se(()=>{let e;Array.from(_.value).length>0,e=f.value;const l={name:"Total",data:[]};var a=[];return a=Object.keys(e),l.data=Object.values(e),{series:[l],options:{chart:{parentHeightOffset:0,toolbar:{show:!1}},dataLabels:{enabled:!0},plotOptions:{bar:{borderRadius:8,barHeight:"60%",horizontal:!0,distributed:!0}},grid:{borderColor:k,xaxis:{lines:{show:!1}},padding:{top:-10}},yaxis:{labels:{style:{colors:V}}},xaxis:{axisBorder:{show:!1},axisTicks:{color:k},categories:a,labels:{style:{colors:V}}}}}});return(e,t)=>{const l=de;return r(g)?(i(),d("div",me,"Cargando...")):(i(),d("div",ve,[c(R,{class:"pt-4 pl-6"},{default:b(()=>[oe("Baja de suscriptores por motivo de baja")]),_:1}),c(R,{class:"pt-4 pl-6"},{default:b(()=>[c(re,null,{default:b(()=>[c(B,{cols:"4"},{default:b(()=>[c(l,{"prepend-inner-icon":"tabler-calendar",density:"compact",modelValue:r(y),"onUpdate:modelValue":t[0]||(t[0]=a=>A(y)?y.value=a:null),"show-current":"true",onOnChange:G,config:{mode:"range",altFormat:"F j, Y",dateFormat:"d-m-Y",maxDate:new Date,position:"auto right",reactive:!0}},null,8,["modelValue","config"])]),_:1}),c(B,{cols:"8"},{default:b(()=>[c(le,{style:{width:"100%"},modelValue:r(x),"onUpdate:modelValue":t[1]||(t[1]=a=>A(x)?x.value=a:null),items:r(C),label:"Paquetes"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),s("div",he,[s("div",{class:I(["",{active:e.selectedTab===0}]),onClick:t[2]||(t[2]=a=>e.selectTab(0))},[c(q,{size:22,icon:"tabler-chart-bar"})],2),s("div",{onClick:t[3]||(t[3]=a=>e.selectTab(1)),class:I({active:e.selectedTab===1})},[c(q,{size:22,icon:"tabler-chart-pie"})],2)]),s("div",fe,[e.selectedTab===0?(i(),d("div",_e,[c(r(z),{type:"bar",height:"500",options:r(O).options,series:r(O).series},null,8,["options","series"])])):L("",!0),e.selectedTab===1?(i(),d("div",ye,[c(r(z),{type:"donut",height:"500",options:r(S),series:r($)},null,8,["options","series"])])):L("",!0)]),r(g)?(i(),d("div",ge,"Cargando...")):(i(),ne(ue,{key:1,hover:"true",class:"text-no-wrap tableNavegacion mx-5 my-5"},{default:b(()=>[Te,s("tbody",null,[(i(!0),d(ce,null,ie(r(T),(a,o)=>(i(),d("tr",{key:o},[s("td",null,M(o),1),s("td",null,M(a),1)]))),128)),s("tr",null,[Ye,s("td",null,M(r(j)),1)])])]),_:1}))]))}}}),De=K(xe,[["__scopeId","data-v-8102c678"]]);export{De as default};
