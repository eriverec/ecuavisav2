import{M as xe,R as Ce,S as ke,U as je,r as o,as as De,v as Te,o as M,x as W,a as e,w as t,q as r,t as v,u as s,f as Re,g as L,b as i,h as S,p as m,i as p,b0 as Q,e as x,b9 as Me,ba as Ee,aR as oe,b2 as Se,N as f,c as Z,Z as ie,$ as ne,a0 as de,a3 as X,F as ue,C as ze,a2 as qe,aQ as Ue,l as Ie,m as re,V as Y,n as P,bC as ce,b1 as Le,bc as Pe,bd as $e,be as Ne}from"./index.88d3c7f5.js";const z=q=>($e("data-v-13ba95f7"),q=q(),Ne(),q),Oe=["title","src"],Be={class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},Fe={class:"px-4"},Ge=z(()=>i("div",{class:"loading"},null,-1)),He={class:"nombre-desafio d-flex flex-column"},Je={class:"d-flex"},Ae=z(()=>i("small",null,"Video",-1)),Ke={class:"text-disabled"},We={class:"p-0"},Qe=z(()=>i("b",null,"_id:",-1)),Ze={class:"text-xs text-disabled"},Xe={class:"content-items d-flex"},Ye={class:"content-video"},ea=["href"],aa={class:"content-time pl-3"},ta=z(()=>i("b",null,"Duraci\xF3n: ",-1)),la={class:"content-time pl-3"},sa=z(()=>i("b",null,"Categor\xEDa: ",-1)),oa={class:"content-time pl-3"},ia={class:"content-time pl-3"},na={class:"espacio-right-2"},da={class:"d-flex align-center justify-space-between botonescurrentPage"},ua={__name:"index",setup(q){Ce.exports.extendMoment(ke).locale("es",[je]);const $=o(!1),N=o(!1),O=o(!1),B=o("tab-lista");o(1);const T=o([]),me=o(1);o(1),o(""),o(!1);const ve=o(!1);o(!1);const C=o(!1),U=o(null),k=o(!1),R=o(""),pe=o(""),h=o(""),g=o("");o(""),o(!0),o(""),o("");const _=o(""),j=o(""),D=o(null),w=o(null),E=o("https://estadisticas.ecuavisa.com/sites/gestor/Recursos/ecuavisa.com.jpg"),F=o(""),c=o({message:"Datos guardados",type:"success",model:!1}),ee=o([]),ae=o([]);De(async()=>{await G(),await H(),await J()});async function G(n=1,l=10){try{N.value=!0;var d=new Headers;d.append("Content-Type","application/json");var a={method:"GET",headers:d,redirect:"follow"},V=await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/elearning/etiqueta/listar.php",a);const u=await V.json();ee.value=u,N.value=!1}catch(u){return console.error(u.message)}}async function H(n=1,l=10){try{$.value=!0;var d=new Headers;d.append("Content-Type","application/json");var a={method:"GET",headers:d,redirect:"follow"},V=await fetch("https://estadisticas.ecuavisa.com/sites/gestor/Tools/elearning/categoria/listar.php",a);const u=await V.json();ae.value=u,$.value=!1}catch(u){return console.error(u.message)}}async function J(n=1,l=10){try{b.value=1;var d=new Headers;d.append("Content-Type","application/json");var a={method:"GET",headers:d,redirect:"follow"},V=await fetch("https://servicio-elearning.vercel.app/video/all?limit=200&page=1",a);const u=await V.json();T.value=u.data,me.value=Math.ceil(u.total/u.limit)}catch(u){return console.error(u.message)}}const I=8,b=o(1),te=Te(()=>{const n=(b.value-1)*I,l=n+I;return T.value.slice(n,l)}),fe=()=>{b.value*I<T.value.length&&b.value++},ge=()=>{b.value>1&&b.value--};function A(){F.value="",D.value="",h.value="",g.value="",w.value="",E.value="https://estadisticas.ecuavisa.com/sites/gestor/Recursos/ecuavisa.com.jpg",g.value="",j.value="",_.value=""}function le(){A(),k.value=!1}async function _e(){A(),R.value="add",k.value=!0}async function be(n){A(),R.value="edit";const a=(await(await fetch("https://servicio-elearning.vercel.app/video/get/"+n)).json()).data;F.value=a._id,D.value=a.titulo,h.value=a.idRudo,g.value=a.duracion,w.value=a.descripcion,E.value="https://estadisticas.ecuavisa.com/sites/gestor/Recursos/ecuavisa.com.jpg",j.value=a.etiquetas,_.value=a.categoria,k.value=!0}async function Ve(){if(!_.value||!h.value||!w.value||!E.value||!g.value)return c.value={message:"Llenar todos los campos para crear el registro",type:"error",model:!0},!1;var n=new Headers;if(n.append("Content-Type","application/json"),R.value==="add"){let a={titulo:D.value,descripcion:w.value,idRudo:h.value,thumbnail:E.value,duracion:g.value,categoria:_.value,etiquetas:j.value};var l=JSON.stringify(a),d={method:"POST",headers:n,body:l,redirect:"follow"};const u=await(await fetch("https://servicio-elearning.vercel.app/video/create",d)).json();if(u.resp)c.value={message:"Registro creado correctamente",type:"success",model:!0};else return c.value={message:u.mensaje,type:"error",model:!0},console.error(u.error),!1}else if(R.value==="edit"){let a={titulo:D.value,descripcion:w.value,idRudo:h.value,thumbnail:E.value,duracion:g.value,categoria:_.value,etiquetas:j.value};var l=JSON.stringify(a),d={method:"POST",headers:n,body:l,redirect:"follow"};const K=await(await fetch("https://servicio-elearning.vercel.app/video/update/"+F.value,d)).json();if(K.resp)c.value={message:"Registro actualizado correctamente",type:"success",model:!0};else return c.value={message:K.mensaje,type:"error",model:!0},console.error(K.error),!1}await J(),await G(),await H(),k.value=!1}const y=o(!1),se=o("");function he(n){y.value=!0,se.value=n}function we(n){U.value={_id:n._id,idRudoModel:n.idRudo,urlContent:n.url},C.value=!0}async function ye(){O.value=!0;var n={method:"DELETE",redirect:"follow"};const d=await(await fetch("https://servicio-elearning.vercel.app/video/delete/"+se.value,n)).json();d.resp?c.value={message:"Desaf\xEDo eliminado correctamente",type:"success",model:!0}:c.value={message:d.mensaje,type:"error",model:!0},await J(),y.value=!1,O.value=!1}return(n,l)=>{const d=Pe;return M(),W("section",null,[e(Re,{modelValue:s(c).model,"onUpdate:modelValue":l[0]||(l[0]=a=>s(c).model=a),location:"top end",variant:"flat",timeout:s(c).timeout||2e3,color:s(c).type},{default:t(()=>[r(v(s(c).message),1)]),_:1},8,["modelValue","timeout","color"]),e(Q,{modelValue:s(C),"onUpdate:modelValue":l[3]||(l[3]=a=>p(C)?C.value=a:null),width:"500"},{activator:t(({props:a})=>[]),default:t(()=>[e(d,{onClick:l[1]||(l[1]=a=>C.value=!s(C))}),e(L,{title:s(U).idRudoModel},{default:t(()=>[i("iframe",{class:"mt-3",title:"Video "+s(U).idRudoModel,width:"100%",height:"300",src:s(U).urlContent},null,8,Oe),e(S,{class:"d-flex justify-end"},{default:t(()=>[e(m,{onClick:l[2]||(l[2]=a=>C.value=!1)},{default:t(()=>[r(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),e(Q,{modelValue:s(y),"onUpdate:modelValue":l[6]||(l[6]=a=>p(y)?y.value=a:null),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(d,{onClick:l[4]||(l[4]=a=>y.value=!s(y))}),e(L,{title:"Eliminar registro"},{default:t(()=>[e(S,null,{default:t(()=>[r(" \xBFDesea eliminar el registro? ")]),_:1}),e(S,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(m,{color:"secondary",variant:"tonal",onClick:l[5]||(l[5]=a=>y.value=!1)},{default:t(()=>[r(" No, cerrar ")]),_:1}),e(m,{disabled:s(O),onClick:ye},{default:t(()=>[r(" Si, eliminar ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,null,{default:t(()=>[e(x,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:t(()=>[e(L,{class:"mt-5"},{default:t(()=>[e(S,null,{default:t(()=>[e(Me,{modelValue:s(B),"onUpdate:modelValue":l[14]||(l[14]=a=>p(B)?B.value=a:null)},{default:t(()=>[e(Ee,{value:"tab-lista"},{default:t(()=>[i("div",Be,[i("div",null,[e(oe,null,{default:t(()=>[r(" Listado de videos educativos ")]),_:1}),e(Se,null,{default:t(()=>[r(" Mantenimiento de videos que se enlazan con Desaf\xEDos ")]),_:1})])]),i("div",Fe,[e(m,{color:"primary",class:"mb-4",onClick:_e},{default:t(()=>[r(" Crear registro "),e(f,{size:22,icon:"tabler-plus"})]),_:1}),s(T).length<1?(M(),Z(ie,{key:0,lines:"two",border:""},{default:t(()=>[e(ne,null,{default:t(()=>[e(de,null,{default:t(()=>[Ge]),_:1})]),_:1})]),_:1})):X("",!0),s(T).length>0?(M(),Z(ie,{key:1,lines:"two",border:""},{default:t(()=>[(M(!0),W(ue,null,ze(s(te),(a,V)=>(M(),W(ue,{key:V},[e(ne,{disabled:s(ve)},{append:t(()=>[i("div",na,[e(m,{title:"Ver vista previa del video",icon:"",size:"x-small",color:"warning",variant:"text",onClick:u=>we(a)},{default:t(()=>[e(f,{size:"22",icon:"tabler-movie"})]),_:2},1032,["onClick"]),e(m,{title:"Editar registro",color:"success",variant:"text",icon:"",onClick:u=>be(a._id)},{default:t(()=>[e(f,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(m,{title:"Eliminar el registro",icon:"",size:"x-small",color:"error",variant:"text",onClick:u=>he(a._id)},{default:t(()=>[e(f,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-elearning-gestion-videos-view-id",params:{id:a._id}}},{default:t(()=>[e(f,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])])]),default:t(()=>[e(de,null,{default:t(()=>[i("div",He,[i("div",Je,[Ae,i("small",Ke,[i("code",We,[Qe,r(v(a._id),1)])])]),i("label",null,v(a.titulo),1),i("span",Ze,v(a.descripcion),1),i("div",Xe,[i("div",Ye,[e(f,{size:"20",icon:"tabler-video"}),i("a",{class:"pl-2",target:"_blank",href:a.url},v(a.idRudo),9,ea)]),i("div",aa,[e(f,{size:"20",icon:"tabler-clock"}),ta,r(" "+v(a.duracion)+" min ",1)]),i("div",la,[e(f,{size:"20",icon:"mdi-animation"}),sa,r(" "+v(a.categoria),1)]),i("div",oa,[e(f,{size:"20",icon:"mdi-thumb-up-outline"}),r(" "+v(a.likes),1)]),i("div",ia,[e(f,{size:"20",icon:"mdi-thumb-down-outline"}),r(" "+v(a.dislikes),1)])])])]),_:2},1024)]),_:2},1032,["disabled"]),V!==s(te).length-1?(M(),Z(qe,{key:0})):X("",!0)],64))),128))]),_:1})):X("",!0),i("div",da,[e(m,{icon:"tabler-arrow-big-left-lines",onClick:ge,disabled:s(b)===1},null,8,["disabled"]),r(" P\xE1gina "+v(s(b))+" ",1),e(m,{icon:"tabler-arrow-big-right-lines",onClick:fe,disabled:s(b)*I>=s(T).length},null,8,["disabled"])])]),e(Q,{modelValue:s(k),"onUpdate:modelValue":l[13]||(l[13]=a=>p(k)?k.value=a:null),persistent:"","no-click-animation":"","max-width":"800"},{default:t(()=>[e(d,{onClick:le}),e(L,{class:"pa-sm-14 pa-5"},{default:t(()=>[e(Ue,{class:"text-center"},{default:t(()=>[e(oe,{class:"text-h5 mb-3"},{default:t(()=>[r(v(s(R)==="add"||s(R)==="duplicate"?"Crear registro":"Editar "+s(pe)),1)]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(Ie,{class:"mt-6",onSubmit:re(Ve,["prevent"])},{default:t(()=>[e(Y,{class:""},{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{cols:"6"},{default:t(()=>[e(P,{modelValue:s(D),"onUpdate:modelValue":l[7]||(l[7]=a=>p(D)?D.value=a:null),label:"T\xEDtulo del video"},null,8,["modelValue"])]),_:1}),e(x,{cols:"6"},{default:t(()=>[e(P,{modelValue:s(w),"onUpdate:modelValue":l[8]||(l[8]=a=>p(w)?w.value=a:null),label:"Descripci\xF3n"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(P,{modelValue:s(h),"onUpdate:modelValue":l[9]||(l[9]=a=>p(h)?h.value=a:null),label:"Id video de RUDO"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(P,{modelValue:s(g),"onUpdate:modelValue":l[10]||(l[10]=a=>p(g)?g.value=a:null),label:"Tiempo en minutos del video",suffix:"minutos","append-inner-icon":"tabler-clock",type:"number"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(ce,{modelValue:s(_),"onUpdate:modelValue":l[11]||(l[11]=a=>p(_)?_.value=a:null),items:s(ae),chips:"",label:"Seleccione la categor\xEDa del video","menu-props":{maxHeight:"300"},onKeydown:Le(re(s(_),["prevent"]),["enter"]),disabled:s($),"append-icon":"mdi-refresh","onClick:append":H},null,8,["modelValue","items","onKeydown","disabled"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(ce,{"item-text":"title","item-value":"value",modelValue:s(j),"onUpdate:modelValue":l[12]||(l[12]=a=>p(j)?j.value=a:null),items:s(ee),chips:"",multiple:"",label:"Etiquetas","menu-props":{maxHeight:"300"},disabled:s(N),"append-icon":"mdi-refresh","onClick:append":G},null,8,["modelValue","items","disabled"])]),_:1})]),_:1}),e(x,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(m,{type:"submit"},{default:t(()=>[r(" Guardar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:le},{default:t(()=>[r(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})])}}},va=xe(ua,[["__scopeId","data-v-13ba95f7"]]);export{va as default};
