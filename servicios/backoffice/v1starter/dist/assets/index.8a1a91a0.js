import{M as _e,R as Ve,S as ge,U as be,r as s,as as ye,v as he,z as we,o as g,x as z,a as e,w as t,q as c,t as p,u as o,f as xe,g as $,b as n,h as I,p as m,i as x,b0 as q,e as T,b9 as Ce,ba as ke,aR as Z,b2 as De,N as j,c as N,Z as K,$ as G,a0 as X,a3 as R,F as ee,C as Se,a2 as je,aQ as Ee,l as Te,m as ze,V as H,aT as te,aU as Ie,aV as Pe,a1 as Ue,n as ae,bc as Le,bd as $e,be as Ne}from"./index.88d3c7f5.js";const J=P=>($e("data-v-0266f79b"),P=P(),Ne(),P),Re=["title","src"],Oe={class:"d-flex flex-wrap py-4 gap-4 align-items-center",style:{"justify-content":"space-between"}},Me={class:"px-4"},Be=J(()=>n("div",{class:"loading"},null,-1)),Fe={class:"nombre-desafio d-flex flex-column"},qe=J(()=>n("small",null,"Desaf\xEDo",-1)),Ge={class:"content-items d-flex"},He={class:"content-video"},Je=["href"],Ae={class:"content-time pl-3"},We={key:0},Qe=J(()=>n("b",null,"Permanencia: ",-1)),Ye={key:1},Ze={class:"espacio-right-2"},Ke={class:"d-flex align-center justify-space-between botonescurrentPage"},Xe={style:{"max-width":"300px","font-size":"13px","line-height":"1.2"},class:"py-0 my-0 mb-1"},et={class:"pb-0 mb-0",style:{"font-size":"10px"}},tt={__name:"index",setup(P){Ve.exports.extendMoment(ge).locale("es",[be]);const O=s("tab-lista");s(1);const C=s([]),le=s(1);s(1),s(""),s(!1);const oe=s(!1);s(!1);const k=s(!1),U=s(null),D=s(!1),E=s(""),se=s(""),b=s(""),S=s("");s(""),s(!0),s(""),s("");const y=s(""),h=s(""),M=s(""),A=s([]),v=s({message:"Datos guardados",type:"success",model:!1}),ie=[{title:"Definir un tiempo",value:"time"},{title:"Ver todo el video",value:"full"}];ye(async()=>{await B(),await W()});async function B(i=1,l=10){try{V.value=1;var r=new Headers;r.append("Content-Type","application/json");var u={method:"GET",headers:r,redirect:"follow"},a=await fetch("https://servicio-niveles-puntuacion.vercel.app/desafio-video-historico/all?limit=20000&page=1",u);const d=await a.json();C.value=d.data.reduce((_,f)=>(f.desafio.length>0||(f.desafio=[{tituloDesafio:"",tituloSticker:"",URLSticker:""}]),_.push(f),_),[]),le.value=Math.ceil(d.total/d.limit)}catch(d){return console.error(d.message)}}async function W(i=1,l=10){try{var r=new Headers;r.append("Content-Type","application/json");var u={method:"GET",headers:r,redirect:"follow"},a=await fetch("https://servicio-desafios.vercel.app/desafios",u);const d=await a.json();A.value=d.data.reduce((_,f)=>(_.push({title:`${f.tituloDesafio}`,value:f._id,descripcionDesafio:f.descripcionDesafio}),_),[])}catch(d){return console.error(d.message)}}const L=8,V=s(1),ne=he(()=>{const i=(V.value-1)*L,l=i+L;return C.value.slice(i,l)}),de=()=>{V.value*L<C.value.length&&V.value++},re=()=>{V.value>1&&V.value--};function F(){M.value="",b.value="",S.value="",y.value="",h.value="time"}function Q(){F(),D.value=!1}async function ue(){F(),E.value="add",D.value=!0}async function ce(i){F(),E.value="edit";const u=(await(await fetch("https://servicio-niveles-puntuacion.vercel.app/desafio-video-historico/get/"+i)).json()).data[0];M.value=u._id,b.value=u.idVideo,S.value=u.timeVal,y.value=u.idDesafio,h.value=u.tipoEval,D.value=!0}async function ve(){if(!y.value||!b.value)return v.value={message:"Llenar todos los campos para crear el desaf\xEDo",type:"error",model:!0},!1;var i=new Headers;if(i.append("Content-Type","application/json"),E.value==="add"){let u={idVideo:b.value,timeVal:S.value,idDesafio:y.value,tipoEval:h.value};var l=JSON.stringify(u),r={method:"POST",headers:i,body:l,redirect:"follow"};const d=await(await fetch("https://servicio-niveles-puntuacion.vercel.app/desafio-video-historico/create",r)).json();if(d.resp)v.value={message:"Video desaf\xEDo creada correctamente",type:"success",model:!0};else return v.value={message:d.mensaje,type:"error",model:!0},console.error(d.error),!1}else if(E.value==="edit"){let u={idVideo:b.value,timeVal:S.value,idDesafio:y.value,tipoEval:h.value};var l=JSON.stringify(u),r={method:"POST",headers:i,body:l,redirect:"follow"};const f=await(await fetch("https://servicio-niveles-puntuacion.vercel.app/desafio-video-historico/update/"+M.value,r)).json();if(f.resp)v.value={message:"Video desaf\xEDo actualizado correctamente",type:"success",model:!0};else return v.value={message:f.mensaje,type:"error",model:!0},console.error(f.error),!1}await B(),D.value=!1}const w=s(!1),Y=s("");function fe(i){w.value=!0,Y.value=i}function me(i){U.value={_id:i._id,idVideo:i.idVideo,urlContent:i.urlContent},k.value=!0}async function pe(){var i={method:"DELETE",redirect:"follow"};const r=await(await fetch("https://servicio-niveles-puntuacion.vercel.app/desafio-video-historico/delete/"+Y.value,i)).json();r.resp?v.value={message:"Desaf\xEDo eliminado correctamente",type:"success",model:!0}:v.value={message:r.mensaje,type:"error",model:!0},await B(),w.value=!1}return(i,l)=>{const r=Le,u=we("v-list-item-content");return g(),z("section",null,[e(xe,{modelValue:o(v).model,"onUpdate:modelValue":l[0]||(l[0]=a=>o(v).model=a),location:"top end",variant:"flat",timeout:o(v).timeout||2e3,color:o(v).type},{default:t(()=>[c(p(o(v).message),1)]),_:1},8,["modelValue","timeout","color"]),e(q,{modelValue:o(k),"onUpdate:modelValue":l[3]||(l[3]=a=>x(k)?k.value=a:null),width:"500"},{activator:t(({props:a})=>[]),default:t(()=>[e(r,{onClick:l[1]||(l[1]=a=>k.value=!o(k))}),e($,{title:o(U).idVideo},{default:t(()=>[n("iframe",{class:"mt-3",title:"Video "+o(U).idVideo,width:"100%",height:"300",src:o(U).urlContent},null,8,Re),e(I,{class:"d-flex justify-end"},{default:t(()=>[e(m,{onClick:l[2]||(l[2]=a=>k.value=!1)},{default:t(()=>[c(" Aceptar ")]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),e(q,{modelValue:o(w),"onUpdate:modelValue":l[6]||(l[6]=a=>x(w)?w.value=a:null),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(r,{onClick:l[4]||(l[4]=a=>w.value=!o(w))}),e($,{title:"Eliminar registro"},{default:t(()=>[e(I,null,{default:t(()=>[c(" \xBFDesea eliminar el registro? ")]),_:1}),e(I,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(m,{color:"secondary",variant:"tonal",onClick:l[5]||(l[5]=a=>w.value=!1)},{default:t(()=>[c(" No, cerrar ")]),_:1}),e(m,{onClick:pe},{default:t(()=>[c(" Si, eliminar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,null,{default:t(()=>[e(T,{class:"mt-0",cols:"12",md:"12",lg:"12"},{default:t(()=>[e($,{class:"mt-5"},{default:t(()=>[e(I,null,{default:t(()=>[e(Ce,{modelValue:o(O),"onUpdate:modelValue":l[12]||(l[12]=a=>x(O)?O.value=a:null)},{default:t(()=>[e(ke,{value:"tab-lista"},{default:t(()=>[n("div",Oe,[n("div",null,[e(Z,null,{default:t(()=>[c(" Listado de desaf\xEDos de videos ")]),_:1}),e(De,null,{default:t(()=>[c(" Mantenimiento de videos que se enlazan con Desaf\xEDos ")]),_:1})])]),n("div",Me,[e(m,{color:"primary",class:"mb-4",onClick:ue},{default:t(()=>[c(" Crear registro "),e(j,{size:22,icon:"tabler-plus"})]),_:1}),o(C).length<1?(g(),N(K,{key:0,lines:"two",border:""},{default:t(()=>[e(G,null,{default:t(()=>[e(X,null,{default:t(()=>[Be]),_:1})]),_:1})]),_:1})):R("",!0),o(C).length>0?(g(),N(K,{key:1,lines:"two",border:""},{default:t(()=>[(g(!0),z(ee,null,Se(o(ne),(a,d)=>(g(),z(ee,{key:d},[e(G,{disabled:o(oe)},{append:t(()=>[n("div",Ze,[e(m,{title:"Ver vista previa del video",icon:"",size:"x-small",color:"warning",variant:"text",onClick:_=>me(a)},{default:t(()=>[e(j,{size:"22",icon:"tabler-movie"})]),_:2},1032,["onClick"]),e(m,{title:"Editar registro",color:"success",variant:"text",icon:"",onClick:_=>ce(a._id)},{default:t(()=>[e(j,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(m,{title:"Eliminar el registro",icon:"",size:"x-small",color:"error",variant:"text",onClick:_=>fe(a._id)},{default:t(()=>[e(j,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(m,{icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-reglasYDesafios-GestionVideosHistoricos-view-id",params:{id:a._id}}},{default:t(()=>[e(j,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])])]),default:t(()=>[e(X,null,{default:t(()=>[n("div",Fe,[qe,n("label",null,p(a.desafio[0].tituloDesafio),1),n("small",null,p(a.desafio[0].tituloSticker),1),n("div",Ge,[n("div",He,[e(j,{size:"20",icon:"tabler-video"}),n("a",{class:"pl-2",target:"_blank",href:a.urlContent},p(a.idVideo),9,Je)]),n("div",Ae,[e(j,{size:"20",icon:"tabler-clock"}),a.tipoEval!="full"?(g(),z("label",We,[Qe,c(" "+p(a.timeVal)+" min ",1)])):(g(),z("label",Ye," Ver todo el video "))])])])]),_:2},1024)]),_:2},1032,["disabled"]),d!==o(C).length-1?(g(),N(je,{key:0})):R("",!0)],64))),128))]),_:1})):R("",!0),n("div",Ke,[e(m,{icon:"tabler-arrow-big-left-lines",onClick:re,disabled:o(V)===1},null,8,["disabled"]),c(" P\xE1gina "+p(o(V))+" ",1),e(m,{icon:"tabler-arrow-big-right-lines",onClick:de,disabled:o(V)*L>=o(C).length},null,8,["disabled"])])]),e(q,{modelValue:o(D),"onUpdate:modelValue":l[11]||(l[11]=a=>x(D)?D.value=a:null),persistent:"","no-click-animation":"","max-width":"800"},{default:t(()=>[e(r,{onClick:Q}),e($,{class:"pa-sm-14 pa-5"},{default:t(()=>[e(Ee,{class:"text-center"},{default:t(()=>[e(Z,{class:"text-h5 mb-3"},{default:t(()=>[c(p(o(E)==="add"||o(E)==="duplicate"?"Crear registro":"Editar "+o(se)),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(Te,{class:"mt-6",onSubmit:ze(ve,["prevent"])},{default:t(()=>[e(H,{class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(H,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(te,{"no-data-text":"No existen desaf\xEDos que mostrar","append-icon":"mdi-refresh","onClick:append":W,"item-text":"title","item-value":"value",modelValue:o(y),"onUpdate:modelValue":l[7]||(l[7]=a=>x(y)?y.value=a:null),items:o(A),"menu-props":{maxHeight:"400"},label:"Seleccione el desaf\xEDo vinculado"},{selection:t(({item:a})=>[n("div",null,p(a.title)+" - "+p(a.value),1)]),item:t(({item:a,props:d})=>[e(G,Ie(Pe(d)),{default:t(()=>[e(u,{class:"border-1"},{default:t(()=>[e(Ue,{class:"d-flex flex-column"},{default:t(()=>[n("div",Xe,p(a.raw.descripcionDesafio),1),n("p",et,"_id: "+p(a.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),e(T,{cols:"12"},{default:t(()=>[e(ae,{modelValue:o(b),"onUpdate:modelValue":l[8]||(l[8]=a=>x(b)?b.value=a:null),label:"Id del video de RUDO"},null,8,["modelValue"])]),_:1}),e(T,{cols:"12"},{default:t(()=>[e(te,{"item-text":"title","item-value":"value",modelValue:o(h),"onUpdate:modelValue":l[9]||(l[9]=a=>x(h)?h.value=a:null),items:ie,label:"Tipo de evaluaci\xF3n"},null,8,["modelValue"])]),_:1}),o(h)!="full"?(g(),N(T,{key:0,cols:"12"},{default:t(()=>[e(ae,{modelValue:o(S),"onUpdate:modelValue":l[10]||(l[10]=a=>x(S)?S.value=a:null),label:"Tiempo en minutos de vista para el video",type:"number"},null,8,["modelValue"])]),_:1})):R("",!0)]),_:1}),e(T,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:t(()=>[e(m,{type:"submit"},{default:t(()=>[c(" Guardar ")]),_:1}),e(m,{color:"secondary",variant:"tonal",onClick:Q},{default:t(()=>[c(" Cancelar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})])}}},ot=_e(tt,[["__scopeId","data-v-0266f79b"]]);export{ot as default};
